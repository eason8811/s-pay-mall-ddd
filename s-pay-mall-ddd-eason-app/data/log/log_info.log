25-03-14.15:04:14.835 [main            ] INFO  OrderServiceTest       - Starting OrderServiceTest using Java 17.0.13 with PID 168172 (started by Eason in D:\Code\codes\s-pay-mall-ddd-eason\s-pay-mall-ddd-eason-app)
25-03-14.15:04:14.837 [main            ] INFO  OrderServiceTest       - The following 1 profile is active: "dev"
25-03-14.15:04:16.577 [main            ] INFO  OptionalValidatorFactoryBean - Failed to set up a Bean Validation provider: jakarta.validation.NoProviderFoundException: Unable to create a Configuration, because no Jakarta Bean Validation provider could be found. Add a provider like Hibernate Validator (RI) to your classpath.
25-03-14.15:04:16.925 [main            ] INFO  CachingConnectionFactory - Attempting to connect to: [192.168.226.128:5672]
25-03-14.15:04:17.005 [main            ] INFO  CachingConnectionFactory - Created new connection: rabbitConnectionFactory#551be9f6:0/SimpleConnection@5d5574c7 [delegate=amqp://s-pay-mall@192.168.226.128:5672//s-pay-mall, localPort=58504]
25-03-14.15:04:17.092 [main            ] INFO  OrderServiceTest       - Started OrderServiceTest in 2.621 seconds (process running for 3.588)
25-03-14.15:04:17.767 [main            ] INFO  HikariDataSource       - HikariPool-1 - Starting...
25-03-14.15:04:17.933 [main            ] INFO  HikariPool             - HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@4902c584
25-03-14.15:04:17.935 [main            ] INFO  HikariDataSource       - HikariPool-1 - Start completed.
25-03-14.15:04:18.119 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-03-14.15:04:19.087 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-03-14.15:04:19.107 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-1 - Shutdown initiated...
25-03-14.15:04:19.120 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-1 - Shutdown completed.
25-03-14.15:07:08.751 [main            ] INFO  OrderServiceTest       - Starting OrderServiceTest using Java 17.0.13 with PID 165412 (started by Eason in D:\Code\codes\s-pay-mall-ddd-eason\s-pay-mall-ddd-eason-app)
25-03-14.15:07:08.752 [main            ] INFO  OrderServiceTest       - The following 1 profile is active: "dev"
25-03-14.15:07:10.779 [main            ] INFO  OptionalValidatorFactoryBean - Failed to set up a Bean Validation provider: jakarta.validation.NoProviderFoundException: Unable to create a Configuration, because no Jakarta Bean Validation provider could be found. Add a provider like Hibernate Validator (RI) to your classpath.
25-03-14.15:07:11.213 [main            ] INFO  CachingConnectionFactory - Attempting to connect to: [192.168.226.128:5672]
25-03-14.15:07:11.281 [main            ] INFO  CachingConnectionFactory - Created new connection: rabbitConnectionFactory#6b867ee7:0/SimpleConnection@57b711b6 [delegate=amqp://s-pay-mall@192.168.226.128:5672//s-pay-mall, localPort=62171]
25-03-14.15:07:11.358 [main            ] INFO  OrderServiceTest       - Started OrderServiceTest in 3.002 seconds (process running for 3.927)
25-03-14.15:07:11.365 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-03-14.15:07:12.216 [main            ] INFO  HikariDataSource       - HikariPool-1 - Starting...
25-03-14.15:07:12.352 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-03-14.15:07:17.598 [main            ] INFO  OrderServiceTest       - Starting OrderServiceTest using Java 17.0.13 with PID 128688 (started by Eason in D:\Code\codes\s-pay-mall-ddd-eason\s-pay-mall-ddd-eason-app)
25-03-14.15:07:17.599 [main            ] INFO  OrderServiceTest       - The following 1 profile is active: "dev"
25-03-14.15:07:19.454 [main            ] INFO  OptionalValidatorFactoryBean - Failed to set up a Bean Validation provider: jakarta.validation.NoProviderFoundException: Unable to create a Configuration, because no Jakarta Bean Validation provider could be found. Add a provider like Hibernate Validator (RI) to your classpath.
25-03-14.15:07:19.820 [main            ] INFO  CachingConnectionFactory - Attempting to connect to: [192.168.226.128:5672]
25-03-14.15:07:19.887 [main            ] INFO  CachingConnectionFactory - Created new connection: rabbitConnectionFactory#6b867ee7:0/SimpleConnection@57b711b6 [delegate=amqp://s-pay-mall@192.168.226.128:5672//s-pay-mall, localPort=62186]
25-03-14.15:07:19.963 [main            ] INFO  OrderServiceTest       - Started OrderServiceTest in 2.729 seconds (process running for 3.707)
25-03-14.15:07:20.663 [main            ] INFO  HikariDataSource       - HikariPool-1 - Starting...
25-03-14.15:07:20.846 [main            ] INFO  HikariPool             - HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@23ee92df
25-03-14.15:07:20.848 [main            ] INFO  HikariDataSource       - HikariPool-1 - Start completed.
25-03-14.15:42:35.042 [HikariPool-1 housekeeper] WARN  HikariPool             - HikariPool-1 - Thread starvation or clock leap detected (housekeeper delta=35m44s193ms522µs900ns).
25-03-14.15:42:35.046 [AMQP Connection 192.168.226.128:5672] WARN  ForgivingExceptionHandler - An unexpected connection driver error occurred (Exception message: Connection reset)
25-03-14.15:42:35.095 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-03-14.15:42:35.095 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-03-14.15:42:35.099 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-1 - Shutdown initiated...
25-03-14.15:42:35.116 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-1 - Shutdown completed.
25-03-14.15:44:01.815 [main            ] INFO  OrderServiceTest       - Starting OrderServiceTest using Java 17.0.13 with PID 166096 (started by Eason in D:\Code\codes\s-pay-mall-ddd-eason\s-pay-mall-ddd-eason-app)
25-03-14.15:44:01.816 [main            ] INFO  OrderServiceTest       - The following 1 profile is active: "dev"
25-03-14.15:44:03.819 [main            ] INFO  OptionalValidatorFactoryBean - Failed to set up a Bean Validation provider: jakarta.validation.NoProviderFoundException: Unable to create a Configuration, because no Jakarta Bean Validation provider could be found. Add a provider like Hibernate Validator (RI) to your classpath.
25-03-14.15:44:04.255 [main            ] INFO  CachingConnectionFactory - Attempting to connect to: [192.168.226.128:5672]
25-03-14.15:44:04.330 [main            ] INFO  CachingConnectionFactory - Created new connection: rabbitConnectionFactory#310d57b1:0/SimpleConnection@4b61e97 [delegate=amqp://s-pay-mall@192.168.226.128:5672//s-pay-mall, localPort=63307]
25-03-14.15:44:04.414 [main            ] INFO  OrderServiceTest       - Started OrderServiceTest in 3.005 seconds (process running for 4.013)
25-03-14.15:44:05.299 [main            ] INFO  HikariDataSource       - HikariPool-1 - Starting...
25-03-14.15:44:05.511 [main            ] INFO  HikariPool             - HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@6b03c35c
25-03-14.15:44:05.513 [main            ] INFO  HikariDataSource       - HikariPool-1 - Start completed.
25-03-14.15:47:21.820 [HikariPool-1 housekeeper] WARN  HikariPool             - HikariPool-1 - Thread starvation or clock leap detected (housekeeper delta=3m46s308ms132µs400ns).
25-03-14.15:47:21.823 [AMQP Connection 192.168.226.128:5672] WARN  ForgivingExceptionHandler - An unexpected connection driver error occurred (Exception message: Connection reset)
25-03-14.15:47:22.078 [main            ] INFO  PayPort                - 拼团订单锁定, userId: Eason4, request: LockMarketPayOrderRequestDTO(userId=Eason4, teamId=null, activityId=100123, goodsId=9890001, source=s01, channel=c01, outerOrderId=2373620263601668, notifyUrl=http://127.0.0.1:8081/api/v1/alipay/group_buy_notify), response: null
25-03-14.15:47:22.250 [main            ] INFO  OrderService           - 创建支付订单成功, payOrder: PayOrderEntity{userId='null', orderId='2373620263601668', payUrl='<form name="punchout_form" method="post" action="https://openapi-sandbox.dl.alipaydev.com/gateway.do?charset=utf-8&method=alipay.trade.page.pay&sign=E9XDM37Sbwu8goecQ4FRAZ271iVNfASvAkv%2FeEZ7y6m7jWwtrQvofhFGuUsBn5Z%2BolB%2FAlwhYY6YqBH3KSb1jD22%2FFfzuLgRMI29MZ7pwxChvGHD%2FjWrFNAIYh44CsoP%2FGzm4fasl%2FJyJ5Q7gPJnMjhAezLz%2BVcWhpw%2FBCeDVDJ9kIQTKbcP%2BuuDUqmpyxsGUEGDOiL4ToQ5vWzPcUs93GX4NgFbPaxlQthsxSjoAEr3jz4i4F2ePl9lVGqQ00lIojlRBUSr7HElzUTb%2BWeIcjA0zoRXG98SAf%2FOKBulnHFgdkuKXvd0KmvTAg9dBYTi1UvgrMfpWdwXmbq0rE%2FeWA%3D%3D&return_url=https%3A%2F%2Fgaga.plus&notify_url=http%3A%2F%2Feason.nat300.top%2Fapi%2Fv1%2Falipay%2Falipay_notify_url&version=1.0&app_id=9021000143682740&sign_type=RSA2&timestamp=2025-03-14+15%3A47%3A22&alipay_sdk=alipay-sdk-java-4.38.157.ALL&format=json">
<input type="hidden" name="biz_content" value="{&quot;out_trade_no&quot;:&quot;2373620263601668&quot;,&quot;total_amount&quot;:&quot;100.00&quot;,&quot;subject&quot;:&quot;《手写MyBatis：渐进式源码实践》&quot;,&quot;product_code&quot;:&quot;FAST_INSTANT_TRADE_PAY&quot;}">
<input type="submit" value="立即支付" style="display:none" >
</form>
<script>document.forms[0].submit();</script>', orderStatus=PAY_WAITE}
25-03-14.15:47:22.283 [main            ] INFO  OrderService           - 支付 URL: 
<form name="punchout_form" method="post" action="https://openapi-sandbox.dl.alipaydev.com/gateway.do?charset=utf-8&method=alipay.trade.page.pay&sign=E9XDM37Sbwu8goecQ4FRAZ271iVNfASvAkv%2FeEZ7y6m7jWwtrQvofhFGuUsBn5Z%2BolB%2FAlwhYY6YqBH3KSb1jD22%2FFfzuLgRMI29MZ7pwxChvGHD%2FjWrFNAIYh44CsoP%2FGzm4fasl%2FJyJ5Q7gPJnMjhAezLz%2BVcWhpw%2FBCeDVDJ9kIQTKbcP%2BuuDUqmpyxsGUEGDOiL4ToQ5vWzPcUs93GX4NgFbPaxlQthsxSjoAEr3jz4i4F2ePl9lVGqQ00lIojlRBUSr7HElzUTb%2BWeIcjA0zoRXG98SAf%2FOKBulnHFgdkuKXvd0KmvTAg9dBYTi1UvgrMfpWdwXmbq0rE%2FeWA%3D%3D&return_url=https%3A%2F%2Fgaga.plus&notify_url=http%3A%2F%2Feason.nat300.top%2Fapi%2Fv1%2Falipay%2Falipay_notify_url&version=1.0&app_id=9021000143682740&sign_type=RSA2&timestamp=2025-03-14+15%3A47%3A22&alipay_sdk=alipay-sdk-java-4.38.157.ALL&format=json">
<input type="hidden" name="biz_content" value="{&quot;out_trade_no&quot;:&quot;2373620263601668&quot;,&quot;total_amount&quot;:&quot;100.00&quot;,&quot;subject&quot;:&quot;《手写MyBatis：渐进式源码实践》&quot;,&quot;product_code&quot;:&quot;FAST_INSTANT_TRADE_PAY&quot;}">
<input type="submit" value="立即支付" style="display:none" >
</form>
<script>document.forms[0].submit();</script>
25-03-14.15:47:22.283 [main            ] INFO  AbstractOrderService   - 创建订单-完成，生成支付单。userId: Eason4 orderId: 2373620263601668 payUrl: <form name="punchout_form" method="post" action="https://openapi-sandbox.dl.alipaydev.com/gateway.do?charset=utf-8&method=alipay.trade.page.pay&sign=E9XDM37Sbwu8goecQ4FRAZ271iVNfASvAkv%2FeEZ7y6m7jWwtrQvofhFGuUsBn5Z%2BolB%2FAlwhYY6YqBH3KSb1jD22%2FFfzuLgRMI29MZ7pwxChvGHD%2FjWrFNAIYh44CsoP%2FGzm4fasl%2FJyJ5Q7gPJnMjhAezLz%2BVcWhpw%2FBCeDVDJ9kIQTKbcP%2BuuDUqmpyxsGUEGDOiL4ToQ5vWzPcUs93GX4NgFbPaxlQthsxSjoAEr3jz4i4F2ePl9lVGqQ00lIojlRBUSr7HElzUTb%2BWeIcjA0zoRXG98SAf%2FOKBulnHFgdkuKXvd0KmvTAg9dBYTi1UvgrMfpWdwXmbq0rE%2FeWA%3D%3D&return_url=https%3A%2F%2Fgaga.plus&notify_url=http%3A%2F%2Feason.nat300.top%2Fapi%2Fv1%2Falipay%2Falipay_notify_url&version=1.0&app_id=9021000143682740&sign_type=RSA2&timestamp=2025-03-14+15%3A47%3A22&alipay_sdk=alipay-sdk-java-4.38.157.ALL&format=json">
<input type="hidden" name="biz_content" value="{&quot;out_trade_no&quot;:&quot;2373620263601668&quot;,&quot;total_amount&quot;:&quot;100.00&quot;,&quot;subject&quot;:&quot;《手写MyBatis：渐进式源码实践》&quot;,&quot;product_code&quot;:&quot;FAST_INSTANT_TRADE_PAY&quot;}">
<input type="submit" value="立即支付" style="display:none" >
</form>
<script>document.forms[0].submit();</script> discount: null
25-03-14.15:47:22.300 [main            ] INFO  OrderServiceTest       - 请求参数:{"activityId":100123,"marketType":"拼团营销","productId":"9890001","userId":"Eason4"}
25-03-14.15:47:22.303 [main            ] INFO  OrderServiceTest       - 测试结果:{"deductionAmount":0,"marketType":"无营销","orderId":"2373620263601668","orderStatus":"等待支付－订单创建完成后，创建支付单","payAmount":100.00,"payUrl":"<form name=\"punchout_form\" method=\"post\" action=\"https://openapi-sandbox.dl.alipaydev.com/gateway.do?charset=utf-8&method=alipay.trade.page.pay&sign=E9XDM37Sbwu8goecQ4FRAZ271iVNfASvAkv%2FeEZ7y6m7jWwtrQvofhFGuUsBn5Z%2BolB%2FAlwhYY6YqBH3KSb1jD22%2FFfzuLgRMI29MZ7pwxChvGHD%2FjWrFNAIYh44CsoP%2FGzm4fasl%2FJyJ5Q7gPJnMjhAezLz%2BVcWhpw%2FBCeDVDJ9kIQTKbcP%2BuuDUqmpyxsGUEGDOiL4ToQ5vWzPcUs93GX4NgFbPaxlQthsxSjoAEr3jz4i4F2ePl9lVGqQ00lIojlRBUSr7HElzUTb%2BWeIcjA0zoRXG98SAf%2FOKBulnHFgdkuKXvd0KmvTAg9dBYTi1UvgrMfpWdwXmbq0rE%2FeWA%3D%3D&return_url=https%3A%2F%2Fgaga.plus&notify_url=http%3A%2F%2Feason.nat300.top%2Fapi%2Fv1%2Falipay%2Falipay_notify_url&version=1.0&app_id=9021000143682740&sign_type=RSA2&timestamp=2025-03-14+15%3A47%3A22&alipay_sdk=alipay-sdk-java-4.38.157.ALL&format=json\">\n<input type=\"hidden\" name=\"biz_content\" value=\"{&quot;out_trade_no&quot;:&quot;2373620263601668&quot;,&quot;total_amount&quot;:&quot;100.00&quot;,&quot;subject&quot;:&quot;《手写MyBatis：渐进式源码实践》&quot;,&quot;product_code&quot;:&quot;FAST_INSTANT_TRADE_PAY&quot;}\">\n<input type=\"submit\" value=\"立即支付\" style=\"display:none\" >\n</form>\n<script>document.forms[0].submit();</script>","userId":"Eason4"}
25-03-14.15:47:22.325 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-03-14.15:47:22.325 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-03-14.15:47:22.328 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-1 - Shutdown initiated...
25-03-14.15:47:22.393 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-1 - Shutdown completed.
25-03-14.15:49:45.152 [main            ] INFO  OrderServiceTest       - Starting OrderServiceTest using Java 17.0.13 with PID 162892 (started by Eason in D:\Code\codes\s-pay-mall-ddd-eason\s-pay-mall-ddd-eason-app)
25-03-14.15:49:45.154 [main            ] INFO  OrderServiceTest       - The following 1 profile is active: "dev"
25-03-14.15:49:46.995 [main            ] INFO  OptionalValidatorFactoryBean - Failed to set up a Bean Validation provider: jakarta.validation.NoProviderFoundException: Unable to create a Configuration, because no Jakarta Bean Validation provider could be found. Add a provider like Hibernate Validator (RI) to your classpath.
25-03-14.15:49:47.439 [main            ] INFO  CachingConnectionFactory - Attempting to connect to: [192.168.226.128:5672]
25-03-14.15:49:47.494 [main            ] INFO  CachingConnectionFactory - Created new connection: rabbitConnectionFactory#7fe07361:0/SimpleConnection@4a122e68 [delegate=amqp://s-pay-mall@192.168.226.128:5672//s-pay-mall, localPort=52098]
25-03-14.15:49:47.574 [main            ] INFO  OrderServiceTest       - Started OrderServiceTest in 2.849 seconds (process running for 3.672)
25-03-14.15:49:48.331 [main            ] INFO  HikariDataSource       - HikariPool-1 - Starting...
25-03-14.15:49:48.553 [main            ] INFO  HikariPool             - HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@6f36e806
25-03-14.15:49:48.556 [main            ] INFO  HikariDataSource       - HikariPool-1 - Start completed.
25-03-14.15:49:48.594 [main            ] INFO  AbstractOrderService   - 创建订单-存在，已存在未支付订单。userId:Eason4 productId:9890001 orderId:2373620263601668
25-03-14.15:49:48.697 [main            ] INFO  OrderServiceTest       - 请求参数:{"activityId":100123,"marketType":"拼团营销","productId":"9890001","userId":"Eason4"}
25-03-14.15:49:48.700 [main            ] INFO  OrderServiceTest       - 测试结果:{"orderId":"2373620263601668","orderStatus":"等待支付－订单创建完成后，创建支付单","payUrl":"<form name=\"punchout_form\" method=\"post\" action=\"https://openapi-sandbox.dl.alipaydev.com/gateway.do?charset=utf-8&method=alipay.trade.page.pay&sign=E9XDM37Sbwu8goecQ4FRAZ271iVNfASvAkv%2FeEZ7y6m7jWwtrQvofhFGuUsBn5Z%2BolB%2FAlwhYY6YqBH3KSb1jD22%2FFfzuLgRMI29MZ7pwxChvGHD%2FjWrFNAIYh44CsoP%2FGzm4fasl%2FJyJ5Q7gPJnMjhAezLz%2BVcWhpw%2FBCeDVDJ9kIQTKbcP%2BuuDUqmpyxsGUEGDOiL4ToQ5vWzPcUs93GX4NgFbPaxlQthsxSjoAEr3jz4i4F2ePl9lVGqQ00lIojlRBUSr7HElzUTb%2BWeIcjA0zoRXG98SAf%2FOKBulnHFgdkuKXvd0KmvTAg9dBYTi1UvgrMfpWdwXmbq0rE%2FeWA%3D%3D&return_url=https%3A%2F%2Fgaga.plus&notify_url=http%3A%2F%2Feason.nat300.top%2Fapi%2Fv1%2Falipay%2Falipay_notify_url&version=1.0&app_id=9021000143682740&sign_type=RSA2&timestamp=2025-03-14+15%3A47%3A22&alipay_sdk=alipay-sdk-java-4.38.157.ALL&format=json\">\n<input type=\"hidden\" name=\"biz_content\" value=\"{&quot;out_trade_no&quot;:&quot;2373620263601668&quot;,&quot;total_amount&quot;:&quot;100.00&quot;,&quot;subject&quot;:&quot;《手写MyBatis：渐进式源码实践》&quot;,&quot;product_code&quot;:&quot;FAST_INSTANT_TRADE_PAY&quot;}\">\n<input type=\"submit\" value=\"立即支付\" style=\"display:none\" >\n</form>\n<script>document.forms[0].submit();</script>","userId":"Eason4"}
25-03-14.15:49:48.714 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-03-14.15:49:49.580 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-03-14.15:49:49.586 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-1 - Shutdown initiated...
25-03-14.15:49:49.602 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-1 - Shutdown completed.
25-03-14.15:50:18.208 [main            ] INFO  OrderServiceTest       - Starting OrderServiceTest using Java 17.0.13 with PID 115748 (started by Eason in D:\Code\codes\s-pay-mall-ddd-eason\s-pay-mall-ddd-eason-app)
25-03-14.15:50:18.210 [main            ] INFO  OrderServiceTest       - The following 1 profile is active: "dev"
25-03-14.15:50:21.174 [main            ] INFO  OptionalValidatorFactoryBean - Failed to set up a Bean Validation provider: jakarta.validation.NoProviderFoundException: Unable to create a Configuration, because no Jakarta Bean Validation provider could be found. Add a provider like Hibernate Validator (RI) to your classpath.
25-03-14.15:50:21.851 [main            ] INFO  CachingConnectionFactory - Attempting to connect to: [192.168.226.128:5672]
25-03-14.15:50:21.944 [main            ] INFO  CachingConnectionFactory - Created new connection: rabbitConnectionFactory#30c19bff:0/SimpleConnection@5a82bc58 [delegate=amqp://s-pay-mall@192.168.226.128:5672//s-pay-mall, localPort=52123]
25-03-14.15:50:22.043 [main            ] INFO  OrderServiceTest       - Started OrderServiceTest in 4.866 seconds (process running for 6.381)
25-03-14.15:50:38.208 [main            ] INFO  HikariDataSource       - HikariPool-1 - Starting...
25-03-14.15:50:38.894 [main            ] INFO  HikariPool             - HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@19540247
25-03-14.15:50:38.901 [main            ] INFO  HikariDataSource       - HikariPool-1 - Start completed.
25-03-14.15:51:04.564 [main            ] INFO  AbstractOrderService   - 创建订单-存在，已存在未支付订单。userId:Eason4 productId:9890001 orderId:2373620263601668
25-03-14.15:51:04.611 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-03-14.15:51:05.067 [main            ] INFO  OrderServiceTest       - 请求参数:{"activityId":100123,"marketType":"拼团营销","productId":"9890001","userId":"Eason4"}
25-03-14.15:51:05.075 [main            ] INFO  OrderServiceTest       - 测试结果:{"orderId":"2373620263601668","orderStatus":"等待支付－订单创建完成后，创建支付单","payUrl":"<form name=\"punchout_form\" method=\"post\" action=\"https://openapi-sandbox.dl.alipaydev.com/gateway.do?charset=utf-8&method=alipay.trade.page.pay&sign=E9XDM37Sbwu8goecQ4FRAZ271iVNfASvAkv%2FeEZ7y6m7jWwtrQvofhFGuUsBn5Z%2BolB%2FAlwhYY6YqBH3KSb1jD22%2FFfzuLgRMI29MZ7pwxChvGHD%2FjWrFNAIYh44CsoP%2FGzm4fasl%2FJyJ5Q7gPJnMjhAezLz%2BVcWhpw%2FBCeDVDJ9kIQTKbcP%2BuuDUqmpyxsGUEGDOiL4ToQ5vWzPcUs93GX4NgFbPaxlQthsxSjoAEr3jz4i4F2ePl9lVGqQ00lIojlRBUSr7HElzUTb%2BWeIcjA0zoRXG98SAf%2FOKBulnHFgdkuKXvd0KmvTAg9dBYTi1UvgrMfpWdwXmbq0rE%2FeWA%3D%3D&return_url=https%3A%2F%2Fgaga.plus&notify_url=http%3A%2F%2Feason.nat300.top%2Fapi%2Fv1%2Falipay%2Falipay_notify_url&version=1.0&app_id=9021000143682740&sign_type=RSA2&timestamp=2025-03-14+15%3A47%3A22&alipay_sdk=alipay-sdk-java-4.38.157.ALL&format=json\">\n<input type=\"hidden\" name=\"biz_content\" value=\"{&quot;out_trade_no&quot;:&quot;2373620263601668&quot;,&quot;total_amount&quot;:&quot;100.00&quot;,&quot;subject&quot;:&quot;《手写MyBatis：渐进式源码实践》&quot;,&quot;product_code&quot;:&quot;FAST_INSTANT_TRADE_PAY&quot;}\">\n<input type=\"submit\" value=\"立即支付\" style=\"display:none\" >\n</form>\n<script>document.forms[0].submit();</script>","userId":"Eason4"}
25-03-14.15:51:05.567 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-03-14.15:51:05.576 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-1 - Shutdown initiated...
25-03-14.15:51:05.586 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-1 - Shutdown completed.
25-03-14.15:51:08.036 [main            ] INFO  OrderServiceTest       - Starting OrderServiceTest using Java 17.0.13 with PID 156932 (started by Eason in D:\Code\codes\s-pay-mall-ddd-eason\s-pay-mall-ddd-eason-app)
25-03-14.15:51:08.037 [main            ] INFO  OrderServiceTest       - The following 1 profile is active: "dev"
25-03-14.15:51:09.904 [main            ] INFO  OptionalValidatorFactoryBean - Failed to set up a Bean Validation provider: jakarta.validation.NoProviderFoundException: Unable to create a Configuration, because no Jakarta Bean Validation provider could be found. Add a provider like Hibernate Validator (RI) to your classpath.
25-03-14.15:51:10.427 [main            ] INFO  CachingConnectionFactory - Attempting to connect to: [192.168.226.128:5672]
25-03-14.15:51:10.536 [main            ] INFO  CachingConnectionFactory - Created new connection: rabbitConnectionFactory#7fe07361:0/SimpleConnection@4a122e68 [delegate=amqp://s-pay-mall@192.168.226.128:5672//s-pay-mall, localPort=52174]
25-03-14.15:51:10.648 [main            ] INFO  OrderServiceTest       - Started OrderServiceTest in 3.041 seconds (process running for 3.833)
25-03-14.15:51:30.711 [main            ] INFO  HikariDataSource       - HikariPool-1 - Starting...
25-03-14.15:51:31.368 [main            ] INFO  HikariPool             - HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@6bfdaed7
25-03-14.15:51:31.375 [main            ] INFO  HikariDataSource       - HikariPool-1 - Start completed.
25-03-14.15:54:01.386 [HikariPool-1 housekeeper] WARN  HikariPool             - HikariPool-1 - Thread starvation or clock leap detected (housekeeper delta=1m45s189ms459µs).
25-03-14.15:54:01.442 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-03-14.15:56:12.679 [main            ] INFO  OrderServiceTest       - Starting OrderServiceTest using Java 17.0.13 with PID 95796 (started by Eason in D:\Code\codes\s-pay-mall-ddd-eason\s-pay-mall-ddd-eason-app)
25-03-14.15:56:12.681 [main            ] INFO  OrderServiceTest       - The following 1 profile is active: "dev"
25-03-14.15:56:14.523 [main            ] INFO  OptionalValidatorFactoryBean - Failed to set up a Bean Validation provider: jakarta.validation.NoProviderFoundException: Unable to create a Configuration, because no Jakarta Bean Validation provider could be found. Add a provider like Hibernate Validator (RI) to your classpath.
25-03-14.15:56:14.979 [main            ] INFO  CachingConnectionFactory - Attempting to connect to: [192.168.226.128:5672]
25-03-14.15:56:15.058 [main            ] INFO  CachingConnectionFactory - Created new connection: rabbitConnectionFactory#59845579:0/SimpleConnection@28fa541 [delegate=amqp://s-pay-mall@192.168.226.128:5672//s-pay-mall, localPort=51619]
25-03-14.15:56:15.145 [main            ] INFO  OrderServiceTest       - Started OrderServiceTest in 2.908 seconds (process running for 3.825)
25-03-14.15:56:28.023 [main            ] INFO  HikariDataSource       - HikariPool-1 - Starting...
25-03-14.15:56:28.234 [main            ] INFO  HikariPool             - HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@28b68067
25-03-14.15:56:28.236 [main            ] INFO  HikariDataSource       - HikariPool-1 - Start completed.
25-03-14.15:59:30.377 [HikariPool-1 housekeeper] WARN  HikariPool             - HikariPool-1 - Thread starvation or clock leap detected (housekeeper delta=2m55s405ms332µs700ns).
25-03-14.15:59:30.378 [AMQP Connection 192.168.226.128:5672] WARN  ForgivingExceptionHandler - An unexpected connection driver error occurred (Exception message: Connection reset)
25-03-14.15:59:55.035 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-1] INFO  SimpleMessageListenerContainer - Restarting Consumer@213012a0: tags=[[amq.ctag-t58MAran3U_ce6Pb9we64g]], channel=Cached Rabbit Channel: PublisherCallbackChannelImpl: AMQChannel(amqp://s-pay-mall@192.168.226.128:5672//s-pay-mall,1), conn: Proxy@11ad095c Shared Rabbit Connection: SimpleConnection@28fa541 [delegate=amqp://s-pay-mall@192.168.226.128:5672//s-pay-mall, localPort=51619], acknowledgeMode=AUTO local queue size=0
25-03-14.15:59:55.040 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  CachingConnectionFactory - Attempting to connect to: [192.168.226.128:5672]
25-03-14.15:59:55.052 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  CachingConnectionFactory - Created new connection: rabbitConnectionFactory#59845579:1/SimpleConnection@78000147 [delegate=amqp://s-pay-mall@192.168.226.128:5672//s-pay-mall, localPort=54091]
25-03-14.15:59:55.655 [main            ] INFO  PayPort                - 拼团订单锁定, userId: Eason4, request: LockMarketPayOrderRequestDTO(userId=Eason4, teamId=null, activityId=100123, goodsId=9890001, source=s01, channel=c01, outerOrderId=8089561721887511, notifyUrl=http://127.0.0.1:8081/api/v1/alipay/group_buy_notify), response: null
25-03-14.16:00:29.222 [HikariPool-1 housekeeper] WARN  HikariPool             - HikariPool-1 - Thread starvation or clock leap detected (housekeeper delta=58s844ms839µs700ns).
25-03-14.16:00:52.188 [main            ] INFO  PayPort                - 拼团订单锁定, userId: Eason4, request: LockMarketPayOrderRequestDTO(userId=Eason4, teamId=null, activityId=100123, goodsId=9890001, source=s01, channel=c01, outerOrderId=8089561721887511, notifyUrl=http://127.0.0.1:8081/api/v1/alipay/group_buy_notify), response: null
25-03-14.16:00:57.900 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-3] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-03-14.16:00:58.471 [main            ] INFO  OrderService           - 创建支付订单成功, payOrder: PayOrderEntity{userId='null', orderId='8089561721887511', payUrl='<form name="punchout_form" method="post" action="https://openapi-sandbox.dl.alipaydev.com/gateway.do?charset=utf-8&method=alipay.trade.page.pay&sign=DY5OEu9jT2a1fVqE5DFl73%2BgxaPPyOgRq9MWc5V6yWY8oJ44fGbxbNgQknrnxMOJc6WYSAqTXPbH%2B6j0qSZgpeLZuNa9lDyrAqRvnfOtZ1b871k7zd%2Fy6AIc%2B3LXHoedcKtzC3rAwOE72YPv18XIK%2Bvn%2Bd%2BztdsmrxhabTOLD6HJQkJ8CiA4yrC4Tv65Q3ZQJN6c6OxurD%2B8ai8f7LZ9J5vFY0xsseud2gvnau7FCJpqRtCYkzJI749ulEo2H7LpfXx%2B3fC%2B4AVFVteAbXbz050SZoFMy57a5re2SIwbDlogXixUfx350SqxczAhvcIB6HuSu3eXvJGKYhbjQKlG%2BA%3D%3D&return_url=https%3A%2F%2Fgaga.plus&notify_url=http%3A%2F%2Feason.nat300.top%2Fapi%2Fv1%2Falipay%2Falipay_notify_url&version=1.0&app_id=9021000143682740&sign_type=RSA2&timestamp=2025-03-14+16%3A00%3A58&alipay_sdk=alipay-sdk-java-4.38.157.ALL&format=json">
<input type="hidden" name="biz_content" value="{&quot;out_trade_no&quot;:&quot;8089561721887511&quot;,&quot;total_amount&quot;:&quot;100.00&quot;,&quot;subject&quot;:&quot;《手写MyBatis：渐进式源码实践》&quot;,&quot;product_code&quot;:&quot;FAST_INSTANT_TRADE_PAY&quot;}">
<input type="submit" value="立即支付" style="display:none" >
</form>
<script>document.forms[0].submit();</script>', orderStatus=PAY_WAITE}
25-03-14.16:00:58.520 [main            ] INFO  OrderService           - 支付 URL: 
<form name="punchout_form" method="post" action="https://openapi-sandbox.dl.alipaydev.com/gateway.do?charset=utf-8&method=alipay.trade.page.pay&sign=DY5OEu9jT2a1fVqE5DFl73%2BgxaPPyOgRq9MWc5V6yWY8oJ44fGbxbNgQknrnxMOJc6WYSAqTXPbH%2B6j0qSZgpeLZuNa9lDyrAqRvnfOtZ1b871k7zd%2Fy6AIc%2B3LXHoedcKtzC3rAwOE72YPv18XIK%2Bvn%2Bd%2BztdsmrxhabTOLD6HJQkJ8CiA4yrC4Tv65Q3ZQJN6c6OxurD%2B8ai8f7LZ9J5vFY0xsseud2gvnau7FCJpqRtCYkzJI749ulEo2H7LpfXx%2B3fC%2B4AVFVteAbXbz050SZoFMy57a5re2SIwbDlogXixUfx350SqxczAhvcIB6HuSu3eXvJGKYhbjQKlG%2BA%3D%3D&return_url=https%3A%2F%2Fgaga.plus&notify_url=http%3A%2F%2Feason.nat300.top%2Fapi%2Fv1%2Falipay%2Falipay_notify_url&version=1.0&app_id=9021000143682740&sign_type=RSA2&timestamp=2025-03-14+16%3A00%3A58&alipay_sdk=alipay-sdk-java-4.38.157.ALL&format=json">
<input type="hidden" name="biz_content" value="{&quot;out_trade_no&quot;:&quot;8089561721887511&quot;,&quot;total_amount&quot;:&quot;100.00&quot;,&quot;subject&quot;:&quot;《手写MyBatis：渐进式源码实践》&quot;,&quot;product_code&quot;:&quot;FAST_INSTANT_TRADE_PAY&quot;}">
<input type="submit" value="立即支付" style="display:none" >
</form>
<script>document.forms[0].submit();</script>
25-03-14.16:00:58.520 [main            ] INFO  AbstractOrderService   - 创建订单-完成，生成支付单。userId: Eason4 orderId: 8089561721887511 payUrl: <form name="punchout_form" method="post" action="https://openapi-sandbox.dl.alipaydev.com/gateway.do?charset=utf-8&method=alipay.trade.page.pay&sign=DY5OEu9jT2a1fVqE5DFl73%2BgxaPPyOgRq9MWc5V6yWY8oJ44fGbxbNgQknrnxMOJc6WYSAqTXPbH%2B6j0qSZgpeLZuNa9lDyrAqRvnfOtZ1b871k7zd%2Fy6AIc%2B3LXHoedcKtzC3rAwOE72YPv18XIK%2Bvn%2Bd%2BztdsmrxhabTOLD6HJQkJ8CiA4yrC4Tv65Q3ZQJN6c6OxurD%2B8ai8f7LZ9J5vFY0xsseud2gvnau7FCJpqRtCYkzJI749ulEo2H7LpfXx%2B3fC%2B4AVFVteAbXbz050SZoFMy57a5re2SIwbDlogXixUfx350SqxczAhvcIB6HuSu3eXvJGKYhbjQKlG%2BA%3D%3D&return_url=https%3A%2F%2Fgaga.plus&notify_url=http%3A%2F%2Feason.nat300.top%2Fapi%2Fv1%2Falipay%2Falipay_notify_url&version=1.0&app_id=9021000143682740&sign_type=RSA2&timestamp=2025-03-14+16%3A00%3A58&alipay_sdk=alipay-sdk-java-4.38.157.ALL&format=json">
<input type="hidden" name="biz_content" value="{&quot;out_trade_no&quot;:&quot;8089561721887511&quot;,&quot;total_amount&quot;:&quot;100.00&quot;,&quot;subject&quot;:&quot;《手写MyBatis：渐进式源码实践》&quot;,&quot;product_code&quot;:&quot;FAST_INSTANT_TRADE_PAY&quot;}">
<input type="submit" value="立即支付" style="display:none" >
</form>
<script>document.forms[0].submit();</script> discount: null
25-03-14.16:00:58.533 [main            ] INFO  OrderServiceTest       - 请求参数:{"activityId":100123,"marketType":"拼团营销","productId":"9890001","userId":"Eason4"}
25-03-14.16:00:58.536 [main            ] INFO  OrderServiceTest       - 测试结果:{"deductionAmount":0,"marketType":"无营销","orderId":"8089561721887511","orderStatus":"等待支付－订单创建完成后，创建支付单","payAmount":100.00,"payUrl":"<form name=\"punchout_form\" method=\"post\" action=\"https://openapi-sandbox.dl.alipaydev.com/gateway.do?charset=utf-8&method=alipay.trade.page.pay&sign=DY5OEu9jT2a1fVqE5DFl73%2BgxaPPyOgRq9MWc5V6yWY8oJ44fGbxbNgQknrnxMOJc6WYSAqTXPbH%2B6j0qSZgpeLZuNa9lDyrAqRvnfOtZ1b871k7zd%2Fy6AIc%2B3LXHoedcKtzC3rAwOE72YPv18XIK%2Bvn%2Bd%2BztdsmrxhabTOLD6HJQkJ8CiA4yrC4Tv65Q3ZQJN6c6OxurD%2B8ai8f7LZ9J5vFY0xsseud2gvnau7FCJpqRtCYkzJI749ulEo2H7LpfXx%2B3fC%2B4AVFVteAbXbz050SZoFMy57a5re2SIwbDlogXixUfx350SqxczAhvcIB6HuSu3eXvJGKYhbjQKlG%2BA%3D%3D&return_url=https%3A%2F%2Fgaga.plus&notify_url=http%3A%2F%2Feason.nat300.top%2Fapi%2Fv1%2Falipay%2Falipay_notify_url&version=1.0&app_id=9021000143682740&sign_type=RSA2&timestamp=2025-03-14+16%3A00%3A58&alipay_sdk=alipay-sdk-java-4.38.157.ALL&format=json\">\n<input type=\"hidden\" name=\"biz_content\" value=\"{&quot;out_trade_no&quot;:&quot;8089561721887511&quot;,&quot;total_amount&quot;:&quot;100.00&quot;,&quot;subject&quot;:&quot;《手写MyBatis：渐进式源码实践》&quot;,&quot;product_code&quot;:&quot;FAST_INSTANT_TRADE_PAY&quot;}\">\n<input type=\"submit\" value=\"立即支付\" style=\"display:none\" >\n</form>\n<script>document.forms[0].submit();</script>","userId":"Eason4"}
25-03-14.16:00:58.848 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-3] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-03-14.16:00:58.853 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-1 - Shutdown initiated...
25-03-14.16:00:58.862 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-1 - Shutdown completed.
25-03-14.16:01:01.215 [main            ] INFO  OrderServiceTest       - Starting OrderServiceTest using Java 17.0.13 with PID 128700 (started by Eason in D:\Code\codes\s-pay-mall-ddd-eason\s-pay-mall-ddd-eason-app)
25-03-14.16:01:01.216 [main            ] INFO  OrderServiceTest       - The following 1 profile is active: "dev"
25-03-14.16:01:03.186 [main            ] INFO  OptionalValidatorFactoryBean - Failed to set up a Bean Validation provider: jakarta.validation.NoProviderFoundException: Unable to create a Configuration, because no Jakarta Bean Validation provider could be found. Add a provider like Hibernate Validator (RI) to your classpath.
25-03-14.16:01:03.604 [main            ] INFO  CachingConnectionFactory - Attempting to connect to: [192.168.226.128:5672]
25-03-14.16:01:03.676 [main            ] INFO  CachingConnectionFactory - Created new connection: rabbitConnectionFactory#741ac284:0/SimpleConnection@41be8db9 [delegate=amqp://s-pay-mall@192.168.226.128:5672//s-pay-mall, localPort=54142]
25-03-14.16:01:03.751 [main            ] INFO  OrderServiceTest       - Started OrderServiceTest in 3.003 seconds (process running for 3.795)
25-03-14.16:01:28.170 [main            ] INFO  HikariDataSource       - HikariPool-1 - Starting...
25-03-14.16:01:28.364 [main            ] INFO  HikariPool             - HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@272c5abd
25-03-14.16:01:28.365 [main            ] INFO  HikariDataSource       - HikariPool-1 - Start completed.
25-03-14.16:02:22.184 [main            ] INFO  PayPort                - 拼团订单锁定, userId: Eason4, request: LockMarketPayOrderRequestDTO(userId=Eason4, teamId=null, activityId=100123, goodsId=9890001, source=s01, channel=c01, outerOrderId=3564000822432723, notifyUrl=http://127.0.0.1:8081/api/v1/alipay/group_buy_notify), response: null
25-03-14.16:02:22.230 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-03-14.16:05:16.091 [main            ] INFO  OrderServiceTest       - Starting OrderServiceTest using Java 17.0.13 with PID 164824 (started by Eason in D:\Code\codes\s-pay-mall-ddd-eason\s-pay-mall-ddd-eason-app)
25-03-14.16:05:16.092 [main            ] INFO  OrderServiceTest       - The following 1 profile is active: "dev"
25-03-14.16:05:18.408 [main            ] INFO  OptionalValidatorFactoryBean - Failed to set up a Bean Validation provider: jakarta.validation.NoProviderFoundException: Unable to create a Configuration, because no Jakarta Bean Validation provider could be found. Add a provider like Hibernate Validator (RI) to your classpath.
25-03-14.16:05:19.018 [main            ] INFO  CachingConnectionFactory - Attempting to connect to: [192.168.226.128:5672]
25-03-14.16:05:19.118 [main            ] INFO  CachingConnectionFactory - Created new connection: rabbitConnectionFactory#7fe07361:0/SimpleConnection@46524ebe [delegate=amqp://s-pay-mall@192.168.226.128:5672//s-pay-mall, localPort=51892]
25-03-14.16:05:19.244 [main            ] INFO  OrderServiceTest       - Started OrderServiceTest in 3.626 seconds (process running for 4.55)
25-03-14.16:05:20.229 [main            ] INFO  HikariDataSource       - HikariPool-1 - Starting...
25-03-14.16:05:20.470 [main            ] INFO  HikariPool             - HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@3e18e693
25-03-14.16:05:20.472 [main            ] INFO  HikariDataSource       - HikariPool-1 - Start completed.
25-03-14.16:05:26.147 [main            ] INFO  PayPort                - 拼团订单锁定, userId: Eason4, request: LockMarketPayOrderRequestDTO(userId=Eason4, teamId=null, activityId=100123, goodsId=9890001, source=s01, channel=c01, outerOrderId=8063041315453187, notifyUrl=http://127.0.0.1:8081/api/v1/alipay/group_buy_notify), response: Result(msg=
### Error updating database.  Cause: com.mysql.cj.jdbc.exceptions.MysqlDataTruncation: Data truncation: Data too long for column 'out_trade_no' at row 1
### The error may exist in xin/eason/infrastructure/dao/IGroupBuyOrderList.java (best guess)
### The error may involve xin.eason.infrastructure.dao.IGroupBuyOrderList.insert-Inline
### The error occurred while setting parameters
### SQL: INSERT INTO group_buy_order_list  ( user_id, team_id, order_id, activity_id, start_time, end_time, goods_id, source, channel, original_price, deduction_price,  status,  out_trade_no, biz_id )  VALUES (  ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?,  ?,  ?, ?  )
### Cause: com.mysql.cj.jdbc.exceptions.MysqlDataTruncation: Data truncation: Data too long for column 'out_trade_no' at row 1
; Data truncation: Data too long for column 'out_trade_no' at row 1, code=0, data=null)
25-03-14.16:05:31.794 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-03-14.16:05:32.786 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-03-14.16:05:32.793 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-1 - Shutdown initiated...
25-03-14.16:05:32.805 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-1 - Shutdown completed.
25-03-14.16:07:25.118 [main            ] INFO  OrderServiceTest       - Starting OrderServiceTest using Java 17.0.13 with PID 45160 (started by Eason in D:\Code\codes\s-pay-mall-ddd-eason\s-pay-mall-ddd-eason-app)
25-03-14.16:07:25.121 [main            ] INFO  OrderServiceTest       - The following 1 profile is active: "dev"
25-03-14.16:07:27.090 [main            ] INFO  OptionalValidatorFactoryBean - Failed to set up a Bean Validation provider: jakarta.validation.NoProviderFoundException: Unable to create a Configuration, because no Jakarta Bean Validation provider could be found. Add a provider like Hibernate Validator (RI) to your classpath.
25-03-14.16:07:27.527 [main            ] INFO  CachingConnectionFactory - Attempting to connect to: [192.168.226.128:5672]
25-03-14.16:07:27.586 [main            ] INFO  CachingConnectionFactory - Created new connection: rabbitConnectionFactory#7fe07361:0/SimpleConnection@46524ebe [delegate=amqp://s-pay-mall@192.168.226.128:5672//s-pay-mall, localPort=65481]
25-03-14.16:07:27.653 [main            ] INFO  OrderServiceTest       - Started OrderServiceTest in 3.003 seconds (process running for 3.828)
25-03-14.16:07:28.435 [main            ] INFO  HikariDataSource       - HikariPool-1 - Starting...
25-03-14.16:07:28.630 [main            ] INFO  HikariPool             - HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@3e18e693
25-03-14.16:07:28.632 [main            ] INFO  HikariDataSource       - HikariPool-1 - Start completed.
25-03-14.16:07:39.791 [main            ] INFO  PayPort                - 拼团订单锁定, userId: Eason4, request: LockMarketPayOrderRequestDTO(userId=Eason4, teamId=null, activityId=100123, goodsId=9890001, source=s01, channel=c01, outerOrderId=135388033029, notifyUrl=http://127.0.0.1:8081/api/v1/alipay/group_buy_notify), response: Result(msg=
### Error updating database.  Cause: java.sql.SQLException: Field 'pay_price' doesn't have a default value
### The error may exist in xin/eason/infrastructure/dao/IGroupBuyOrderList.java (best guess)
### The error may involve xin.eason.infrastructure.dao.IGroupBuyOrderList.insert-Inline
### The error occurred while setting parameters
### SQL: INSERT INTO group_buy_order_list  ( user_id, team_id, order_id, activity_id, start_time, end_time, goods_id, source, channel, original_price, deduction_price,  status,  out_trade_no, biz_id )  VALUES (  ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?,  ?,  ?, ?  )
### Cause: java.sql.SQLException: Field 'pay_price' doesn't have a default value
; Field 'pay_price' doesn't have a default value, code=0, data=null)
25-03-14.16:07:41.830 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-03-14.16:07:42.818 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-03-14.16:07:42.825 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-1 - Shutdown initiated...
25-03-14.16:07:42.836 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-1 - Shutdown completed.
25-03-14.16:10:44.673 [main            ] INFO  OrderServiceTest       - Starting OrderServiceTest using Java 17.0.13 with PID 164856 (started by Eason in D:\Code\codes\s-pay-mall-ddd-eason\s-pay-mall-ddd-eason-app)
25-03-14.16:10:44.674 [main            ] INFO  OrderServiceTest       - The following 1 profile is active: "dev"
25-03-14.16:10:46.600 [main            ] INFO  OptionalValidatorFactoryBean - Failed to set up a Bean Validation provider: jakarta.validation.NoProviderFoundException: Unable to create a Configuration, because no Jakarta Bean Validation provider could be found. Add a provider like Hibernate Validator (RI) to your classpath.
25-03-14.16:10:47.069 [main            ] INFO  CachingConnectionFactory - Attempting to connect to: [192.168.226.128:5672]
25-03-14.16:10:47.145 [main            ] INFO  CachingConnectionFactory - Created new connection: rabbitConnectionFactory#7fe07361:0/SimpleConnection@46524ebe [delegate=amqp://s-pay-mall@192.168.226.128:5672//s-pay-mall, localPort=49306]
25-03-14.16:10:47.225 [main            ] INFO  OrderServiceTest       - Started OrderServiceTest in 2.987 seconds (process running for 3.833)
25-03-14.16:10:48.133 [main            ] INFO  HikariDataSource       - HikariPool-1 - Starting...
25-03-14.16:10:48.329 [main            ] INFO  HikariPool             - HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@3e18e693
25-03-14.16:10:48.331 [main            ] INFO  HikariDataSource       - HikariPool-1 - Start completed.
25-03-14.16:11:01.574 [main            ] ERROR PayPort                - 营销锁单失败 userId: Eason4, orderItemId: 823662795615
java.net.SocketTimeoutException: timeout
	at okio.Okio$4.newTimeoutException(Okio.java:232)
	at okio.AsyncTimeout.exit(AsyncTimeout.java:286)
	at okio.AsyncTimeout$2.read(AsyncTimeout.java:241)
	at okio.RealBufferedSource.indexOf(RealBufferedSource.java:358)
	at okio.RealBufferedSource.readUtf8LineStrict(RealBufferedSource.java:230)
	at okhttp3.internal.http1.Http1ExchangeCodec.readHeaderLine(Http1ExchangeCodec.java:242)
	at okhttp3.internal.http1.Http1ExchangeCodec.readResponseHeaders(Http1ExchangeCodec.java:213)
	at okhttp3.internal.connection.Exchange.readResponseHeaders(Exchange.java:115)
	at okhttp3.internal.http.CallServerInterceptor.intercept(CallServerInterceptor.java:94)
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.java:142)
	at okhttp3.internal.connection.ConnectInterceptor.intercept(ConnectInterceptor.java:43)
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.java:142)
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.java:117)
	at okhttp3.internal.cache.CacheInterceptor.intercept(CacheInterceptor.java:94)
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.java:142)
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.java:117)
	at okhttp3.internal.http.BridgeInterceptor.intercept(BridgeInterceptor.java:93)
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.java:142)
	at okhttp3.internal.http.RetryAndFollowUpInterceptor.intercept(RetryAndFollowUpInterceptor.java:88)
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.java:142)
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.java:117)
	at okhttp3.RealCall.getResponseWithInterceptorChain(RealCall.java:229)
	at okhttp3.RealCall.execute(RealCall.java:81)
	at retrofit2.OkHttpCall.execute(OkHttpCall.java:204)
	at xin.eason.infrastructure.adapter.port.PayPort.lockMarketOrder(PayPort.java:118)
	at xin.eason.domain.order.service.OrderService.lockMarketOrder(OrderService.java:69)
	at xin.eason.domain.order.service.AbstractOrderService.createOrder(AbstractOrderService.java:87)
	at xin.eason.test.OrderServiceTest.test_createOrder(OrderServiceTest.java:32)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.springframework.test.context.junit4.statements.RunBeforeTestExecutionCallbacks.evaluate(RunBeforeTestExecutionCallbacks.java:76)
	at org.springframework.test.context.junit4.statements.RunAfterTestExecutionCallbacks.evaluate(RunAfterTestExecutionCallbacks.java:84)
	at org.springframework.test.context.junit4.statements.RunBeforeTestMethodCallbacks.evaluate(RunBeforeTestMethodCallbacks.java:75)
	at org.springframework.test.context.junit4.statements.RunAfterTestMethodCallbacks.evaluate(RunAfterTestMethodCallbacks.java:86)
	at org.springframework.test.context.junit4.statements.SpringRepeat.evaluate(SpringRepeat.java:84)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:252)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:97)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.springframework.test.context.junit4.statements.RunBeforeTestClassCallbacks.evaluate(RunBeforeTestClassCallbacks.java:61)
	at org.springframework.test.context.junit4.statements.RunAfterTestClassCallbacks.evaluate(RunAfterTestClassCallbacks.java:70)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.run(SpringJUnit4ClassRunner.java:191)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at com.intellij.junit4.JUnit4IdeaTestRunner.startRunnerWithArgs(JUnit4IdeaTestRunner.java:69)
	at com.intellij.rt.junit.IdeaTestRunner$Repeater$1.execute(IdeaTestRunner.java:38)
	at com.intellij.rt.execution.junit.TestsRepeater.repeat(TestsRepeater.java:11)
	at com.intellij.rt.junit.IdeaTestRunner$Repeater.startRunnerWithArgs(IdeaTestRunner.java:35)
	at com.intellij.rt.junit.JUnitStarter.prepareStreamsAndStart(JUnitStarter.java:232)
	at com.intellij.rt.junit.JUnitStarter.main(JUnitStarter.java:55)
Caused by: java.net.SocketException: Socket closed
	at java.base/sun.nio.ch.NioSocketImpl.endRead(NioSocketImpl.java:253)
	at java.base/sun.nio.ch.NioSocketImpl.implRead(NioSocketImpl.java:332)
	at java.base/sun.nio.ch.NioSocketImpl.read(NioSocketImpl.java:355)
	at java.base/sun.nio.ch.NioSocketImpl$1.read(NioSocketImpl.java:808)
	at java.base/java.net.Socket$SocketInputStream.read(Socket.java:966)
	at okio.Okio$2.read(Okio.java:140)
	at okio.AsyncTimeout$2.read(AsyncTimeout.java:237)
	... 58 common frames omitted
25-03-14.16:15:31.430 [HikariPool-1 housekeeper] WARN  HikariPool             - HikariPool-1 - Thread starvation or clock leap detected (housekeeper delta=4m40s255ms261µs200ns).
25-03-14.16:15:31.432 [AMQP Connection 192.168.226.128:5672] WARN  ForgivingExceptionHandler - An unexpected connection driver error occurred (Exception message: Connection reset)
25-03-14.16:15:31.476 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-03-14.16:15:31.477 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-03-14.16:15:31.479 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-1 - Shutdown initiated...
25-03-14.16:15:31.491 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-1 - Shutdown completed.
25-03-14.16:15:38.124 [main            ] INFO  OrderServiceTest       - Starting OrderServiceTest using Java 17.0.13 with PID 150424 (started by Eason in D:\Code\codes\s-pay-mall-ddd-eason\s-pay-mall-ddd-eason-app)
25-03-14.16:15:38.125 [main            ] INFO  OrderServiceTest       - The following 1 profile is active: "dev"
25-03-14.16:15:40.007 [main            ] INFO  OptionalValidatorFactoryBean - Failed to set up a Bean Validation provider: jakarta.validation.NoProviderFoundException: Unable to create a Configuration, because no Jakarta Bean Validation provider could be found. Add a provider like Hibernate Validator (RI) to your classpath.
25-03-14.16:15:40.413 [main            ] INFO  CachingConnectionFactory - Attempting to connect to: [192.168.226.128:5672]
25-03-14.16:15:40.479 [main            ] INFO  CachingConnectionFactory - Created new connection: rabbitConnectionFactory#59845579:0/SimpleConnection@6210666c [delegate=amqp://s-pay-mall@192.168.226.128:5672//s-pay-mall, localPort=50213]
25-03-14.16:15:40.545 [main            ] INFO  OrderServiceTest       - Started OrderServiceTest in 2.85 seconds (process running for 3.637)
25-03-14.16:15:41.271 [main            ] INFO  HikariDataSource       - HikariPool-1 - Starting...
25-03-14.16:15:41.446 [main            ] INFO  HikariPool             - HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@44a98a23
25-03-14.16:15:41.447 [main            ] INFO  HikariDataSource       - HikariPool-1 - Start completed.
25-03-14.16:15:44.186 [main            ] INFO  PayPort                - 拼团订单锁定, userId: Eason4, request: LockMarketPayOrderRequestDTO(userId=Eason4, teamId=null, activityId=100123, goodsId=9890001, source=s01, channel=c01, outerOrderId=143398926403, notifyUrl=http://127.0.0.1:8081/api/v1/alipay/group_buy_notify), response: Result(msg=success, code=1, data=LockMarketPayOrderResponseDTO(orderId=819413992482, teamId=74045834, originalPrice=null, discountPrice=10.00, payPrice=90.00, tradeOrderStatus=0))
25-03-14.16:38:56.320 [HikariPool-1 housekeeper] WARN  HikariPool             - HikariPool-1 - Thread starvation or clock leap detected (housekeeper delta=22m32s973ms981µs300ns).
25-03-14.16:38:56.322 [AMQP Connection 192.168.226.128:5672] WARN  ForgivingExceptionHandler - An unexpected connection driver error occurred (Exception message: Connection reset)
25-03-14.16:38:57.746 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-1] INFO  SimpleMessageListenerContainer - Restarting Consumer@336e3be2: tags=[[amq.ctag-ZBn1ccLEf9zlz9ZXLjrDig]], channel=Cached Rabbit Channel: PublisherCallbackChannelImpl: AMQChannel(amqp://s-pay-mall@192.168.226.128:5672//s-pay-mall,1), conn: Proxy@604c7e9b Shared Rabbit Connection: SimpleConnection@6210666c [delegate=amqp://s-pay-mall@192.168.226.128:5672//s-pay-mall, localPort=50213], acknowledgeMode=AUTO local queue size=0
25-03-14.16:38:57.749 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  CachingConnectionFactory - Attempting to connect to: [192.168.226.128:5672]
25-03-14.16:38:57.758 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  CachingConnectionFactory - Created new connection: rabbitConnectionFactory#59845579:1/SimpleConnection@44d317c6 [delegate=amqp://s-pay-mall@192.168.226.128:5672//s-pay-mall, localPort=60550]
25-03-14.16:42:00.759 [AMQP Connection 192.168.226.128:5672] WARN  ForgivingExceptionHandler - An unexpected connection driver error occurred (Exception message: Connection reset)
25-03-14.16:42:00.759 [HikariPool-1 housekeeper] WARN  HikariPool             - HikariPool-1 - Thread starvation or clock leap detected (housekeeper delta=3m4s438ms910µs300ns).
25-03-14.16:42:00.760 [main            ] INFO  OrderService           - 创建支付订单成功, payOrder: PayOrderEntity{userId='null', orderId='143398926403', payUrl='<form name="punchout_form" method="post" action="https://openapi-sandbox.dl.alipaydev.com/gateway.do?charset=utf-8&method=alipay.trade.page.pay&sign=F5zZcKWuFisuqB4UfGZEJmICLio%2FrH%2Fpc%2BM1jowjsUJtCFtgmZgmk2Lwk%2BrvEQ1yk0nQve7wRdUlS%2BkjFl3FnhgeWyubWrarkVwpw55juFxpfCmdFal9McGtLbdVuEiA6OqzPJbm1ahwAmQuO1eu8nsb5OPk%2FvFMGiJlBire2OEkWaszZ3wAIDqlGPXrjfyi%2BKJKeKRORx59G2AesBTucDv0Eev2khCTV4639lRNbSlBCfuBu0o9ycmYUhmcbgeJWjtZ0sQ1mJcbjtn4bMWqjG4%2BBdhbgyrPM8KWEjZlFrqTz07EGVAy7J%2BxUwhAk1%2BCFT5YbcUpazzWWzpJTHLMXA%3D%3D&return_url=https%3A%2F%2Fgaga.plus&notify_url=http%3A%2F%2Feason.nat300.top%2Fapi%2Fv1%2Falipay%2Falipay_notify_url&version=1.0&app_id=9021000143682740&sign_type=RSA2&timestamp=2025-03-14+16%3A39%3A00&alipay_sdk=alipay-sdk-java-4.38.157.ALL&format=json">
<input type="hidden" name="biz_content" value="{&quot;out_trade_no&quot;:&quot;143398926403&quot;,&quot;total_amount&quot;:&quot;100.00&quot;,&quot;subject&quot;:&quot;《手写MyBatis：渐进式源码实践》&quot;,&quot;product_code&quot;:&quot;FAST_INSTANT_TRADE_PAY&quot;}">
<input type="submit" value="立即支付" style="display:none" >
</form>
<script>document.forms[0].submit();</script>', orderStatus=PAY_WAITE}
25-03-14.16:42:00.806 [main            ] INFO  OrderService           - 支付 URL: 
<form name="punchout_form" method="post" action="https://openapi-sandbox.dl.alipaydev.com/gateway.do?charset=utf-8&method=alipay.trade.page.pay&sign=F5zZcKWuFisuqB4UfGZEJmICLio%2FrH%2Fpc%2BM1jowjsUJtCFtgmZgmk2Lwk%2BrvEQ1yk0nQve7wRdUlS%2BkjFl3FnhgeWyubWrarkVwpw55juFxpfCmdFal9McGtLbdVuEiA6OqzPJbm1ahwAmQuO1eu8nsb5OPk%2FvFMGiJlBire2OEkWaszZ3wAIDqlGPXrjfyi%2BKJKeKRORx59G2AesBTucDv0Eev2khCTV4639lRNbSlBCfuBu0o9ycmYUhmcbgeJWjtZ0sQ1mJcbjtn4bMWqjG4%2BBdhbgyrPM8KWEjZlFrqTz07EGVAy7J%2BxUwhAk1%2BCFT5YbcUpazzWWzpJTHLMXA%3D%3D&return_url=https%3A%2F%2Fgaga.plus&notify_url=http%3A%2F%2Feason.nat300.top%2Fapi%2Fv1%2Falipay%2Falipay_notify_url&version=1.0&app_id=9021000143682740&sign_type=RSA2&timestamp=2025-03-14+16%3A39%3A00&alipay_sdk=alipay-sdk-java-4.38.157.ALL&format=json">
<input type="hidden" name="biz_content" value="{&quot;out_trade_no&quot;:&quot;143398926403&quot;,&quot;total_amount&quot;:&quot;100.00&quot;,&quot;subject&quot;:&quot;《手写MyBatis：渐进式源码实践》&quot;,&quot;product_code&quot;:&quot;FAST_INSTANT_TRADE_PAY&quot;}">
<input type="submit" value="立即支付" style="display:none" >
</form>
<script>document.forms[0].submit();</script>
25-03-14.16:42:00.806 [main            ] INFO  AbstractOrderService   - 创建订单-完成，生成支付单。userId: Eason4 orderId: 143398926403 payUrl: <form name="punchout_form" method="post" action="https://openapi-sandbox.dl.alipaydev.com/gateway.do?charset=utf-8&method=alipay.trade.page.pay&sign=F5zZcKWuFisuqB4UfGZEJmICLio%2FrH%2Fpc%2BM1jowjsUJtCFtgmZgmk2Lwk%2BrvEQ1yk0nQve7wRdUlS%2BkjFl3FnhgeWyubWrarkVwpw55juFxpfCmdFal9McGtLbdVuEiA6OqzPJbm1ahwAmQuO1eu8nsb5OPk%2FvFMGiJlBire2OEkWaszZ3wAIDqlGPXrjfyi%2BKJKeKRORx59G2AesBTucDv0Eev2khCTV4639lRNbSlBCfuBu0o9ycmYUhmcbgeJWjtZ0sQ1mJcbjtn4bMWqjG4%2BBdhbgyrPM8KWEjZlFrqTz07EGVAy7J%2BxUwhAk1%2BCFT5YbcUpazzWWzpJTHLMXA%3D%3D&return_url=https%3A%2F%2Fgaga.plus&notify_url=http%3A%2F%2Feason.nat300.top%2Fapi%2Fv1%2Falipay%2Falipay_notify_url&version=1.0&app_id=9021000143682740&sign_type=RSA2&timestamp=2025-03-14+16%3A39%3A00&alipay_sdk=alipay-sdk-java-4.38.157.ALL&format=json">
<input type="hidden" name="biz_content" value="{&quot;out_trade_no&quot;:&quot;143398926403&quot;,&quot;total_amount&quot;:&quot;100.00&quot;,&quot;subject&quot;:&quot;《手写MyBatis：渐进式源码实践》&quot;,&quot;product_code&quot;:&quot;FAST_INSTANT_TRADE_PAY&quot;}">
<input type="submit" value="立即支付" style="display:none" >
</form>
<script>document.forms[0].submit();</script> discount: MarketPayDiscountEntity(originalAmount=null, deductionAmount=10.00, payAmount=90.00)
25-03-14.16:42:00.814 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-3] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-03-14.16:42:00.814 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-3] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-03-14.16:42:00.815 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-1 - Shutdown initiated...
25-03-14.16:42:00.820 [main            ] INFO  OrderServiceTest       - 请求参数:{"activityId":100123,"marketType":"拼团营销","productId":"9890001","userId":"Eason4"}
25-03-14.16:42:00.825 [main            ] INFO  OrderServiceTest       - 测试结果:{"deductionAmount":10.00,"marketType":"拼团营销","orderId":"143398926403","orderStatus":"等待支付－订单创建完成后，创建支付单","payUrl":"<form name=\"punchout_form\" method=\"post\" action=\"https://openapi-sandbox.dl.alipaydev.com/gateway.do?charset=utf-8&method=alipay.trade.page.pay&sign=F5zZcKWuFisuqB4UfGZEJmICLio%2FrH%2Fpc%2BM1jowjsUJtCFtgmZgmk2Lwk%2BrvEQ1yk0nQve7wRdUlS%2BkjFl3FnhgeWyubWrarkVwpw55juFxpfCmdFal9McGtLbdVuEiA6OqzPJbm1ahwAmQuO1eu8nsb5OPk%2FvFMGiJlBire2OEkWaszZ3wAIDqlGPXrjfyi%2BKJKeKRORx59G2AesBTucDv0Eev2khCTV4639lRNbSlBCfuBu0o9ycmYUhmcbgeJWjtZ0sQ1mJcbjtn4bMWqjG4%2BBdhbgyrPM8KWEjZlFrqTz07EGVAy7J%2BxUwhAk1%2BCFT5YbcUpazzWWzpJTHLMXA%3D%3D&return_url=https%3A%2F%2Fgaga.plus&notify_url=http%3A%2F%2Feason.nat300.top%2Fapi%2Fv1%2Falipay%2Falipay_notify_url&version=1.0&app_id=9021000143682740&sign_type=RSA2&timestamp=2025-03-14+16%3A39%3A00&alipay_sdk=alipay-sdk-java-4.38.157.ALL&format=json\">\n<input type=\"hidden\" name=\"biz_content\" value=\"{&quot;out_trade_no&quot;:&quot;143398926403&quot;,&quot;total_amount&quot;:&quot;100.00&quot;,&quot;subject&quot;:&quot;《手写MyBatis：渐进式源码实践》&quot;,&quot;product_code&quot;:&quot;FAST_INSTANT_TRADE_PAY&quot;}\">\n<input type=\"submit\" value=\"立即支付\" style=\"display:none\" >\n</form>\n<script>document.forms[0].submit();</script>","userId":"Eason4"}
25-03-14.16:42:00.833 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-1 - Shutdown completed.
25-03-14.16:42:05.426 [main            ] INFO  OrderServiceTest       - Starting OrderServiceTest using Java 17.0.13 with PID 166644 (started by Eason in D:\Code\codes\s-pay-mall-ddd-eason\s-pay-mall-ddd-eason-app)
25-03-14.16:42:05.428 [main            ] INFO  OrderServiceTest       - The following 1 profile is active: "dev"
25-03-14.16:42:07.420 [main            ] INFO  OptionalValidatorFactoryBean - Failed to set up a Bean Validation provider: jakarta.validation.NoProviderFoundException: Unable to create a Configuration, because no Jakarta Bean Validation provider could be found. Add a provider like Hibernate Validator (RI) to your classpath.
25-03-14.16:42:07.872 [main            ] INFO  CachingConnectionFactory - Attempting to connect to: [192.168.226.128:5672]
25-03-14.16:42:07.940 [main            ] INFO  CachingConnectionFactory - Created new connection: rabbitConnectionFactory#59845579:0/SimpleConnection@6210666c [delegate=amqp://s-pay-mall@192.168.226.128:5672//s-pay-mall, localPort=60892]
25-03-14.16:42:08.008 [main            ] INFO  OrderServiceTest       - Started OrderServiceTest in 3.013 seconds (process running for 3.837)
25-03-14.16:42:08.733 [main            ] INFO  HikariDataSource       - HikariPool-1 - Starting...
25-03-14.16:42:08.901 [main            ] INFO  HikariPool             - HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@44a98a23
25-03-14.16:42:08.903 [main            ] INFO  HikariDataSource       - HikariPool-1 - Start completed.
25-03-14.16:42:15.679 [main            ] INFO  PayPort                - 拼团订单锁定, userId: Eason4, request: LockMarketPayOrderRequestDTO(userId=Eason4, teamId=null, activityId=100123, goodsId=9890001, source=s01, channel=c01, outerOrderId=548834363753, notifyUrl=http://127.0.0.1:8081/api/v1/alipay/group_buy_notify), response: Result(msg=success, code=1, data=LockMarketPayOrderResponseDTO(orderId=549765418743, teamId=82491914, originalPrice=null, discountPrice=10.00, payPrice=90.00, tradeOrderStatus=0))
25-03-14.16:43:28.983 [HikariPool-1 housekeeper] WARN  HikariPool             - HikariPool-1 - Thread starvation or clock leap detected (housekeeper delta=1m13s598ms420µs300ns).
25-03-14.16:43:28.985 [main            ] INFO  OrderService           - 创建支付订单成功, payOrder: PayOrderEntity{userId='null', orderId='548834363753', payUrl='<form name="punchout_form" method="post" action="https://openapi-sandbox.dl.alipaydev.com/gateway.do?charset=utf-8&method=alipay.trade.page.pay&sign=Q5kzbNfi5X7Rl3HqygcopNAaeqsOYGVi0Uy95VQu4kvPVbo6RYe%2FNEzm86aWduGsCfRq%2FQfxs3egs3aA6hEtUcTZ9kj8g3you%2BV1YTuccFvcls%2FFcCdZYagK%2ByjBz1LjSeZXxiBmgmEGK8f0epO0NKUH73HR7gCrVd8x0iMSaKRuUEdAAXWr5OkKQOdXaxASUloQv7JE65pKDaXX72ux5IGrqFZFo982b%2BT9zJj2c3iiKy1rDncEXXvwVetxM1ZBvXH7ZUErbkdUarJy7kS61U756%2Fxy60HP1ky3JAsXq2M8LaZycIUCZfRoznM5Lo4RCzZJFUFFKDrm5PUH4JP2Aw%3D%3D&return_url=https%3A%2F%2Fgaga.plus&notify_url=http%3A%2F%2Feason.nat300.top%2Fapi%2Fv1%2Falipay%2Falipay_notify_url&version=1.0&app_id=9021000143682740&sign_type=RSA2&timestamp=2025-03-14+16%3A42%3A15&alipay_sdk=alipay-sdk-java-4.38.157.ALL&format=json">
<input type="hidden" name="biz_content" value="{&quot;out_trade_no&quot;:&quot;548834363753&quot;,&quot;total_amount&quot;:&quot;100.00&quot;,&quot;subject&quot;:&quot;《手写MyBatis：渐进式源码实践》&quot;,&quot;product_code&quot;:&quot;FAST_INSTANT_TRADE_PAY&quot;}">
<input type="submit" value="立即支付" style="display:none" >
</form>
<script>document.forms[0].submit();</script>', orderStatus=PAY_WAITE}
25-03-14.16:43:30.278 [main            ] INFO  OrderService           - 支付 URL: 
<form name="punchout_form" method="post" action="https://openapi-sandbox.dl.alipaydev.com/gateway.do?charset=utf-8&method=alipay.trade.page.pay&sign=Q5kzbNfi5X7Rl3HqygcopNAaeqsOYGVi0Uy95VQu4kvPVbo6RYe%2FNEzm86aWduGsCfRq%2FQfxs3egs3aA6hEtUcTZ9kj8g3you%2BV1YTuccFvcls%2FFcCdZYagK%2ByjBz1LjSeZXxiBmgmEGK8f0epO0NKUH73HR7gCrVd8x0iMSaKRuUEdAAXWr5OkKQOdXaxASUloQv7JE65pKDaXX72ux5IGrqFZFo982b%2BT9zJj2c3iiKy1rDncEXXvwVetxM1ZBvXH7ZUErbkdUarJy7kS61U756%2Fxy60HP1ky3JAsXq2M8LaZycIUCZfRoznM5Lo4RCzZJFUFFKDrm5PUH4JP2Aw%3D%3D&return_url=https%3A%2F%2Fgaga.plus&notify_url=http%3A%2F%2Feason.nat300.top%2Fapi%2Fv1%2Falipay%2Falipay_notify_url&version=1.0&app_id=9021000143682740&sign_type=RSA2&timestamp=2025-03-14+16%3A42%3A15&alipay_sdk=alipay-sdk-java-4.38.157.ALL&format=json">
<input type="hidden" name="biz_content" value="{&quot;out_trade_no&quot;:&quot;548834363753&quot;,&quot;total_amount&quot;:&quot;100.00&quot;,&quot;subject&quot;:&quot;《手写MyBatis：渐进式源码实践》&quot;,&quot;product_code&quot;:&quot;FAST_INSTANT_TRADE_PAY&quot;}">
<input type="submit" value="立即支付" style="display:none" >
</form>
<script>document.forms[0].submit();</script>
25-03-14.16:43:49.087 [main            ] INFO  AbstractOrderService   - 创建订单-完成，生成支付单。userId: Eason4 orderId: 548834363753 payUrl: <form name="punchout_form" method="post" action="https://openapi-sandbox.dl.alipaydev.com/gateway.do?charset=utf-8&method=alipay.trade.page.pay&sign=Q5kzbNfi5X7Rl3HqygcopNAaeqsOYGVi0Uy95VQu4kvPVbo6RYe%2FNEzm86aWduGsCfRq%2FQfxs3egs3aA6hEtUcTZ9kj8g3you%2BV1YTuccFvcls%2FFcCdZYagK%2ByjBz1LjSeZXxiBmgmEGK8f0epO0NKUH73HR7gCrVd8x0iMSaKRuUEdAAXWr5OkKQOdXaxASUloQv7JE65pKDaXX72ux5IGrqFZFo982b%2BT9zJj2c3iiKy1rDncEXXvwVetxM1ZBvXH7ZUErbkdUarJy7kS61U756%2Fxy60HP1ky3JAsXq2M8LaZycIUCZfRoznM5Lo4RCzZJFUFFKDrm5PUH4JP2Aw%3D%3D&return_url=https%3A%2F%2Fgaga.plus&notify_url=http%3A%2F%2Feason.nat300.top%2Fapi%2Fv1%2Falipay%2Falipay_notify_url&version=1.0&app_id=9021000143682740&sign_type=RSA2&timestamp=2025-03-14+16%3A42%3A15&alipay_sdk=alipay-sdk-java-4.38.157.ALL&format=json">
<input type="hidden" name="biz_content" value="{&quot;out_trade_no&quot;:&quot;548834363753&quot;,&quot;total_amount&quot;:&quot;100.00&quot;,&quot;subject&quot;:&quot;《手写MyBatis：渐进式源码实践》&quot;,&quot;product_code&quot;:&quot;FAST_INSTANT_TRADE_PAY&quot;}">
<input type="submit" value="立即支付" style="display:none" >
</form>
<script>document.forms[0].submit();</script> discount: MarketPayDiscountEntity(originalAmount=null, deductionAmount=10.00, payAmount=90.00)
25-03-14.16:43:58.103 [main            ] INFO  OrderServiceTest       - 请求参数:{"activityId":100123,"marketType":"拼团营销","productId":"9890001","userId":"Eason4"}
25-03-14.16:43:59.047 [main            ] INFO  OrderServiceTest       - 测试结果:{"deductionAmount":10.00,"marketType":"拼团营销","orderId":"548834363753","orderStatus":"等待支付－订单创建完成后，创建支付单","payAmount":90.00,"payUrl":"<form name=\"punchout_form\" method=\"post\" action=\"https://openapi-sandbox.dl.alipaydev.com/gateway.do?charset=utf-8&method=alipay.trade.page.pay&sign=Q5kzbNfi5X7Rl3HqygcopNAaeqsOYGVi0Uy95VQu4kvPVbo6RYe%2FNEzm86aWduGsCfRq%2FQfxs3egs3aA6hEtUcTZ9kj8g3you%2BV1YTuccFvcls%2FFcCdZYagK%2ByjBz1LjSeZXxiBmgmEGK8f0epO0NKUH73HR7gCrVd8x0iMSaKRuUEdAAXWr5OkKQOdXaxASUloQv7JE65pKDaXX72ux5IGrqFZFo982b%2BT9zJj2c3iiKy1rDncEXXvwVetxM1ZBvXH7ZUErbkdUarJy7kS61U756%2Fxy60HP1ky3JAsXq2M8LaZycIUCZfRoznM5Lo4RCzZJFUFFKDrm5PUH4JP2Aw%3D%3D&return_url=https%3A%2F%2Fgaga.plus&notify_url=http%3A%2F%2Feason.nat300.top%2Fapi%2Fv1%2Falipay%2Falipay_notify_url&version=1.0&app_id=9021000143682740&sign_type=RSA2&timestamp=2025-03-14+16%3A42%3A15&alipay_sdk=alipay-sdk-java-4.38.157.ALL&format=json\">\n<input type=\"hidden\" name=\"biz_content\" value=\"{&quot;out_trade_no&quot;:&quot;548834363753&quot;,&quot;total_amount&quot;:&quot;100.00&quot;,&quot;subject&quot;:&quot;《手写MyBatis：渐进式源码实践》&quot;,&quot;product_code&quot;:&quot;FAST_INSTANT_TRADE_PAY&quot;}\">\n<input type=\"submit\" value=\"立即支付\" style=\"display:none\" >\n</form>\n<script>document.forms[0].submit();</script>","userId":"Eason4"}
25-03-14.16:43:59.057 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-03-14.16:44:00.044 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-03-14.16:44:00.049 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-1 - Shutdown initiated...
25-03-14.16:44:00.056 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-1 - Shutdown completed.
25-03-14.16:44:23.538 [main            ] INFO  OrderServiceTest       - Starting OrderServiceTest using Java 17.0.13 with PID 122332 (started by Eason in D:\Code\codes\s-pay-mall-ddd-eason\s-pay-mall-ddd-eason-app)
25-03-14.16:44:23.540 [main            ] INFO  OrderServiceTest       - The following 1 profile is active: "dev"
25-03-14.16:44:25.327 [main            ] INFO  OptionalValidatorFactoryBean - Failed to set up a Bean Validation provider: jakarta.validation.NoProviderFoundException: Unable to create a Configuration, because no Jakarta Bean Validation provider could be found. Add a provider like Hibernate Validator (RI) to your classpath.
25-03-14.16:44:25.696 [main            ] INFO  CachingConnectionFactory - Attempting to connect to: [192.168.226.128:5672]
25-03-14.16:44:25.759 [main            ] INFO  CachingConnectionFactory - Created new connection: rabbitConnectionFactory#74b86971:0/SimpleConnection@2bfa17b0 [delegate=amqp://s-pay-mall@192.168.226.128:5672//s-pay-mall, localPort=50100]
25-03-14.16:44:25.828 [main            ] INFO  OrderServiceTest       - Started OrderServiceTest in 2.68 seconds (process running for 3.416)
25-03-14.16:44:26.540 [main            ] INFO  HikariDataSource       - HikariPool-1 - Starting...
25-03-14.16:44:26.699 [main            ] INFO  HikariPool             - HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@52bc6fcf
25-03-14.16:44:26.701 [main            ] INFO  HikariDataSource       - HikariPool-1 - Start completed.
25-03-14.16:44:26.731 [main            ] INFO  AbstractOrderService   - 创建订单-存在，已存在未支付订单。userId:Eason4 productId:9890001 orderId:548834363753
25-03-14.16:44:26.819 [main            ] INFO  OrderServiceTest       - 请求参数:{"activityId":100123,"marketType":"拼团营销","productId":"9890001","userId":"Eason4"}
25-03-14.16:44:26.822 [main            ] INFO  OrderServiceTest       - 测试结果:{"orderId":"548834363753","orderStatus":"等待支付－订单创建完成后，创建支付单","payUrl":"<form name=\"punchout_form\" method=\"post\" action=\"https://openapi-sandbox.dl.alipaydev.com/gateway.do?charset=utf-8&method=alipay.trade.page.pay&sign=Q5kzbNfi5X7Rl3HqygcopNAaeqsOYGVi0Uy95VQu4kvPVbo6RYe%2FNEzm86aWduGsCfRq%2FQfxs3egs3aA6hEtUcTZ9kj8g3you%2BV1YTuccFvcls%2FFcCdZYagK%2ByjBz1LjSeZXxiBmgmEGK8f0epO0NKUH73HR7gCrVd8x0iMSaKRuUEdAAXWr5OkKQOdXaxASUloQv7JE65pKDaXX72ux5IGrqFZFo982b%2BT9zJj2c3iiKy1rDncEXXvwVetxM1ZBvXH7ZUErbkdUarJy7kS61U756%2Fxy60HP1ky3JAsXq2M8LaZycIUCZfRoznM5Lo4RCzZJFUFFKDrm5PUH4JP2Aw%3D%3D&return_url=https%3A%2F%2Fgaga.plus&notify_url=http%3A%2F%2Feason.nat300.top%2Fapi%2Fv1%2Falipay%2Falipay_notify_url&version=1.0&app_id=9021000143682740&sign_type=RSA2&timestamp=2025-03-14+16%3A42%3A15&alipay_sdk=alipay-sdk-java-4.38.157.ALL&format=json\">\n<input type=\"hidden\" name=\"biz_content\" value=\"{&quot;out_trade_no&quot;:&quot;548834363753&quot;,&quot;total_amount&quot;:&quot;100.00&quot;,&quot;subject&quot;:&quot;《手写MyBatis：渐进式源码实践》&quot;,&quot;product_code&quot;:&quot;FAST_INSTANT_TRADE_PAY&quot;}\">\n<input type=\"submit\" value=\"立即支付\" style=\"display:none\" >\n</form>\n<script>document.forms[0].submit();</script>","userId":"Eason4"}
25-03-14.16:44:26.834 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-03-14.16:44:27.836 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-03-14.16:44:27.844 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-1 - Shutdown initiated...
25-03-14.16:44:27.854 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-1 - Shutdown completed.
25-03-14.19:39:34.158 [main            ] INFO  OrderServiceTest       - Starting OrderServiceTest using Java 17.0.13 with PID 167044 (started by Eason in D:\Code\codes\s-pay-mall-ddd-eason\s-pay-mall-ddd-eason-app)
25-03-14.19:39:34.160 [main            ] INFO  OrderServiceTest       - The following 1 profile is active: "dev"
25-03-14.19:39:35.948 [main            ] INFO  OptionalValidatorFactoryBean - Failed to set up a Bean Validation provider: jakarta.validation.NoProviderFoundException: Unable to create a Configuration, because no Jakarta Bean Validation provider could be found. Add a provider like Hibernate Validator (RI) to your classpath.
25-03-14.19:39:36.349 [main            ] INFO  CachingConnectionFactory - Attempting to connect to: [192.168.226.128:5672]
25-03-14.19:39:36.506 [main            ] INFO  CachingConnectionFactory - Created new connection: rabbitConnectionFactory#1ca3d25b:0/SimpleConnection@79d4ff58 [delegate=amqp://s-pay-mall@192.168.226.128:5672//s-pay-mall, localPort=63267]
25-03-14.19:39:36.614 [main            ] INFO  OrderServiceTest       - Started OrderServiceTest in 2.862 seconds (process running for 3.645)
25-03-14.19:39:37.356 [main            ] INFO  HikariDataSource       - HikariPool-1 - Starting...
25-03-14.19:39:37.516 [main            ] INFO  HikariPool             - HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@42fa5cb
25-03-14.19:39:37.518 [main            ] INFO  HikariDataSource       - HikariPool-1 - Start completed.
25-03-14.19:39:37.967 [main            ] INFO  PayPort                - 拼团订单锁定, userId: Eason4, request: LockMarketPayOrderRequestDTO(userId=Eason4, teamId=null, activityId=100123, goodsId=9890001, source=s01, channel=c01, outerOrderId=531016004898, notifyUrl=http://127.0.0.1:8081/api/v1/alipay/group_buy_notify), response: Result(msg=success, code=1, data=LockMarketPayOrderResponseDTO(orderId=310635521797, teamId=07055049, originalPrice=null, discountPrice=10.00, payPrice=90.00, tradeOrderStatus=0))
25-03-14.19:39:38.098 [main            ] INFO  OrderService           - 创建支付订单成功, payOrder: PayOrderEntity{userId='null', orderId='531016004898', payUrl='<form name="punchout_form" method="post" action="https://openapi-sandbox.dl.alipaydev.com/gateway.do?charset=utf-8&method=alipay.trade.page.pay&sign=h3woYfDYMfrYu93gtJXVBnQCa%2FLK3EjoCmGt4tR5Z%2Bhxi7%2FLJtvAN0W8%2BLahbWz1xaO3Tw%2B57O%2FcFXZFZEZOA%2FKGCRApj%2BUvpH7lBTKc5GT2FpOd%2Fiw8BQ4FQsmj2DmOEtYlmq%2FUcxaQyymThcE30h1nPDq0XfeCznX%2BhcW3DpQt5vBR6X3wVS85GmZ0N%2BESgbGUIt048vzNJyf3IQ1nehOEUMwpa6O8gYv4O7EYPpuM97SSuvv2UQJJQqJFwWrVvKQ37sxtE7MYhSbhN3IqpOhdr0xowtKVmU1Dt5o93xeANLwMdTKU1sQ1YkrBDv5ywcxBBF3H%2BeLtrnZ5Nvtkvg%3D%3D&return_url=https%3A%2F%2Fgaga.plus&notify_url=http%3A%2F%2Feason.nat300.top%2Fapi%2Fv1%2Falipay%2Falipay_notify_url&version=1.0&app_id=9021000143682740&sign_type=RSA2&timestamp=2025-03-14+19%3A39%3A38&alipay_sdk=alipay-sdk-java-4.38.157.ALL&format=json">
<input type="hidden" name="biz_content" value="{&quot;out_trade_no&quot;:&quot;531016004898&quot;,&quot;total_amount&quot;:&quot;100.00&quot;,&quot;subject&quot;:&quot;《手写MyBatis：渐进式源码实践》&quot;,&quot;product_code&quot;:&quot;FAST_INSTANT_TRADE_PAY&quot;}">
<input type="submit" value="立即支付" style="display:none" >
</form>
<script>document.forms[0].submit();</script>', orderStatus=PAY_WAITE}
25-03-14.19:39:38.121 [main            ] INFO  OrderService           - 支付 URL: 
<form name="punchout_form" method="post" action="https://openapi-sandbox.dl.alipaydev.com/gateway.do?charset=utf-8&method=alipay.trade.page.pay&sign=h3woYfDYMfrYu93gtJXVBnQCa%2FLK3EjoCmGt4tR5Z%2Bhxi7%2FLJtvAN0W8%2BLahbWz1xaO3Tw%2B57O%2FcFXZFZEZOA%2FKGCRApj%2BUvpH7lBTKc5GT2FpOd%2Fiw8BQ4FQsmj2DmOEtYlmq%2FUcxaQyymThcE30h1nPDq0XfeCznX%2BhcW3DpQt5vBR6X3wVS85GmZ0N%2BESgbGUIt048vzNJyf3IQ1nehOEUMwpa6O8gYv4O7EYPpuM97SSuvv2UQJJQqJFwWrVvKQ37sxtE7MYhSbhN3IqpOhdr0xowtKVmU1Dt5o93xeANLwMdTKU1sQ1YkrBDv5ywcxBBF3H%2BeLtrnZ5Nvtkvg%3D%3D&return_url=https%3A%2F%2Fgaga.plus&notify_url=http%3A%2F%2Feason.nat300.top%2Fapi%2Fv1%2Falipay%2Falipay_notify_url&version=1.0&app_id=9021000143682740&sign_type=RSA2&timestamp=2025-03-14+19%3A39%3A38&alipay_sdk=alipay-sdk-java-4.38.157.ALL&format=json">
<input type="hidden" name="biz_content" value="{&quot;out_trade_no&quot;:&quot;531016004898&quot;,&quot;total_amount&quot;:&quot;100.00&quot;,&quot;subject&quot;:&quot;《手写MyBatis：渐进式源码实践》&quot;,&quot;product_code&quot;:&quot;FAST_INSTANT_TRADE_PAY&quot;}">
<input type="submit" value="立即支付" style="display:none" >
</form>
<script>document.forms[0].submit();</script>
25-03-14.19:39:38.121 [main            ] INFO  AbstractOrderService   - 创建订单-完成，生成支付单。userId: Eason4 orderId: 531016004898 payUrl: <form name="punchout_form" method="post" action="https://openapi-sandbox.dl.alipaydev.com/gateway.do?charset=utf-8&method=alipay.trade.page.pay&sign=h3woYfDYMfrYu93gtJXVBnQCa%2FLK3EjoCmGt4tR5Z%2Bhxi7%2FLJtvAN0W8%2BLahbWz1xaO3Tw%2B57O%2FcFXZFZEZOA%2FKGCRApj%2BUvpH7lBTKc5GT2FpOd%2Fiw8BQ4FQsmj2DmOEtYlmq%2FUcxaQyymThcE30h1nPDq0XfeCznX%2BhcW3DpQt5vBR6X3wVS85GmZ0N%2BESgbGUIt048vzNJyf3IQ1nehOEUMwpa6O8gYv4O7EYPpuM97SSuvv2UQJJQqJFwWrVvKQ37sxtE7MYhSbhN3IqpOhdr0xowtKVmU1Dt5o93xeANLwMdTKU1sQ1YkrBDv5ywcxBBF3H%2BeLtrnZ5Nvtkvg%3D%3D&return_url=https%3A%2F%2Fgaga.plus&notify_url=http%3A%2F%2Feason.nat300.top%2Fapi%2Fv1%2Falipay%2Falipay_notify_url&version=1.0&app_id=9021000143682740&sign_type=RSA2&timestamp=2025-03-14+19%3A39%3A38&alipay_sdk=alipay-sdk-java-4.38.157.ALL&format=json">
<input type="hidden" name="biz_content" value="{&quot;out_trade_no&quot;:&quot;531016004898&quot;,&quot;total_amount&quot;:&quot;100.00&quot;,&quot;subject&quot;:&quot;《手写MyBatis：渐进式源码实践》&quot;,&quot;product_code&quot;:&quot;FAST_INSTANT_TRADE_PAY&quot;}">
<input type="submit" value="立即支付" style="display:none" >
</form>
<script>document.forms[0].submit();</script> discount: MarketPayDiscountEntity(originalAmount=null, deductionAmount=10.00, payAmount=90.00)
25-03-14.19:39:38.134 [main            ] INFO  OrderServiceTest       - 请求参数:{"activityId":100123,"marketType":"拼团营销","productId":"9890001","userId":"Eason4"}
25-03-14.19:39:38.138 [main            ] INFO  OrderServiceTest       - 测试结果:{"deductionAmount":10.00,"marketType":"拼团营销","orderId":"531016004898","orderStatus":"等待支付－订单创建完成后，创建支付单","payAmount":90.00,"payUrl":"<form name=\"punchout_form\" method=\"post\" action=\"https://openapi-sandbox.dl.alipaydev.com/gateway.do?charset=utf-8&method=alipay.trade.page.pay&sign=h3woYfDYMfrYu93gtJXVBnQCa%2FLK3EjoCmGt4tR5Z%2Bhxi7%2FLJtvAN0W8%2BLahbWz1xaO3Tw%2B57O%2FcFXZFZEZOA%2FKGCRApj%2BUvpH7lBTKc5GT2FpOd%2Fiw8BQ4FQsmj2DmOEtYlmq%2FUcxaQyymThcE30h1nPDq0XfeCznX%2BhcW3DpQt5vBR6X3wVS85GmZ0N%2BESgbGUIt048vzNJyf3IQ1nehOEUMwpa6O8gYv4O7EYPpuM97SSuvv2UQJJQqJFwWrVvKQ37sxtE7MYhSbhN3IqpOhdr0xowtKVmU1Dt5o93xeANLwMdTKU1sQ1YkrBDv5ywcxBBF3H%2BeLtrnZ5Nvtkvg%3D%3D&return_url=https%3A%2F%2Fgaga.plus&notify_url=http%3A%2F%2Feason.nat300.top%2Fapi%2Fv1%2Falipay%2Falipay_notify_url&version=1.0&app_id=9021000143682740&sign_type=RSA2&timestamp=2025-03-14+19%3A39%3A38&alipay_sdk=alipay-sdk-java-4.38.157.ALL&format=json\">\n<input type=\"hidden\" name=\"biz_content\" value=\"{&quot;out_trade_no&quot;:&quot;531016004898&quot;,&quot;total_amount&quot;:&quot;100.00&quot;,&quot;subject&quot;:&quot;《手写MyBatis：渐进式源码实践》&quot;,&quot;product_code&quot;:&quot;FAST_INSTANT_TRADE_PAY&quot;}\">\n<input type=\"submit\" value=\"立即支付\" style=\"display:none\" >\n</form>\n<script>document.forms[0].submit();</script>","userId":"Eason4"}
25-03-14.19:39:38.156 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-03-14.19:39:38.611 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-03-14.19:39:38.628 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-1 - Shutdown initiated...
25-03-14.19:39:38.636 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-1 - Shutdown completed.
25-03-14.19:50:02.482 [main            ] INFO  OrderServiceTest       - Starting OrderServiceTest using Java 17.0.13 with PID 162960 (started by Eason in D:\Code\codes\s-pay-mall-ddd-eason\s-pay-mall-ddd-eason-app)
25-03-14.19:50:02.483 [main            ] INFO  OrderServiceTest       - The following 1 profile is active: "dev"
25-03-14.19:50:04.229 [main            ] INFO  OptionalValidatorFactoryBean - Failed to set up a Bean Validation provider: jakarta.validation.NoProviderFoundException: Unable to create a Configuration, because no Jakarta Bean Validation provider could be found. Add a provider like Hibernate Validator (RI) to your classpath.
25-03-14.19:50:04.602 [main            ] INFO  CachingConnectionFactory - Attempting to connect to: [192.168.226.128:5672]
25-03-14.19:50:04.665 [main            ] INFO  CachingConnectionFactory - Created new connection: rabbitConnectionFactory#4c3de38e:0/SimpleConnection@2bfa17b0 [delegate=amqp://s-pay-mall@192.168.226.128:5672//s-pay-mall, localPort=64721]
25-03-14.19:50:04.736 [main            ] INFO  OrderServiceTest       - Started OrderServiceTest in 2.646 seconds (process running for 3.385)
25-03-14.19:50:05.461 [main            ] INFO  HikariDataSource       - HikariPool-1 - Starting...
25-03-14.19:50:05.617 [main            ] INFO  HikariPool             - HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@52bc6fcf
25-03-14.19:50:05.619 [main            ] INFO  HikariDataSource       - HikariPool-1 - Start completed.
25-03-14.19:50:15.748 [main            ] ERROR PayPort                - 营销锁单失败 userId: Eason4, orderItemId: 656698827739
java.net.SocketTimeoutException: timeout
	at okio.Okio$4.newTimeoutException(Okio.java:232)
	at okio.AsyncTimeout.exit(AsyncTimeout.java:286)
	at okio.AsyncTimeout$2.read(AsyncTimeout.java:241)
	at okio.RealBufferedSource.indexOf(RealBufferedSource.java:358)
	at okio.RealBufferedSource.readUtf8LineStrict(RealBufferedSource.java:230)
	at okhttp3.internal.http1.Http1ExchangeCodec.readHeaderLine(Http1ExchangeCodec.java:242)
	at okhttp3.internal.http1.Http1ExchangeCodec.readResponseHeaders(Http1ExchangeCodec.java:213)
	at okhttp3.internal.connection.Exchange.readResponseHeaders(Exchange.java:115)
	at okhttp3.internal.http.CallServerInterceptor.intercept(CallServerInterceptor.java:94)
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.java:142)
	at okhttp3.internal.connection.ConnectInterceptor.intercept(ConnectInterceptor.java:43)
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.java:142)
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.java:117)
	at okhttp3.internal.cache.CacheInterceptor.intercept(CacheInterceptor.java:94)
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.java:142)
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.java:117)
	at okhttp3.internal.http.BridgeInterceptor.intercept(BridgeInterceptor.java:93)
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.java:142)
	at okhttp3.internal.http.RetryAndFollowUpInterceptor.intercept(RetryAndFollowUpInterceptor.java:88)
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.java:142)
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.java:117)
	at okhttp3.RealCall.getResponseWithInterceptorChain(RealCall.java:229)
	at okhttp3.RealCall.execute(RealCall.java:81)
	at retrofit2.OkHttpCall.execute(OkHttpCall.java:204)
	at xin.eason.infrastructure.adapter.port.PayPort.lockMarketOrder(PayPort.java:118)
	at xin.eason.domain.order.service.OrderService.lockMarketOrder(OrderService.java:70)
	at xin.eason.domain.order.service.AbstractOrderService.createOrder(AbstractOrderService.java:89)
	at xin.eason.test.OrderServiceTest.test_createOrder(OrderServiceTest.java:32)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.springframework.test.context.junit4.statements.RunBeforeTestExecutionCallbacks.evaluate(RunBeforeTestExecutionCallbacks.java:76)
	at org.springframework.test.context.junit4.statements.RunAfterTestExecutionCallbacks.evaluate(RunAfterTestExecutionCallbacks.java:84)
	at org.springframework.test.context.junit4.statements.RunBeforeTestMethodCallbacks.evaluate(RunBeforeTestMethodCallbacks.java:75)
	at org.springframework.test.context.junit4.statements.RunAfterTestMethodCallbacks.evaluate(RunAfterTestMethodCallbacks.java:86)
	at org.springframework.test.context.junit4.statements.SpringRepeat.evaluate(SpringRepeat.java:84)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:252)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:97)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.springframework.test.context.junit4.statements.RunBeforeTestClassCallbacks.evaluate(RunBeforeTestClassCallbacks.java:61)
	at org.springframework.test.context.junit4.statements.RunAfterTestClassCallbacks.evaluate(RunAfterTestClassCallbacks.java:70)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.run(SpringJUnit4ClassRunner.java:191)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at com.intellij.junit4.JUnit4IdeaTestRunner.startRunnerWithArgs(JUnit4IdeaTestRunner.java:69)
	at com.intellij.rt.junit.IdeaTestRunner$Repeater$1.execute(IdeaTestRunner.java:38)
	at com.intellij.rt.execution.junit.TestsRepeater.repeat(TestsRepeater.java:11)
	at com.intellij.rt.junit.IdeaTestRunner$Repeater.startRunnerWithArgs(IdeaTestRunner.java:35)
	at com.intellij.rt.junit.JUnitStarter.prepareStreamsAndStart(JUnitStarter.java:232)
	at com.intellij.rt.junit.JUnitStarter.main(JUnitStarter.java:55)
Caused by: java.net.SocketException: Socket closed
	at java.base/sun.nio.ch.NioSocketImpl.endRead(NioSocketImpl.java:253)
	at java.base/sun.nio.ch.NioSocketImpl.implRead(NioSocketImpl.java:332)
	at java.base/sun.nio.ch.NioSocketImpl.read(NioSocketImpl.java:355)
	at java.base/sun.nio.ch.NioSocketImpl$1.read(NioSocketImpl.java:808)
	at java.base/java.net.Socket$SocketInputStream.read(Socket.java:966)
	at okio.Okio$2.read(Okio.java:140)
	at okio.AsyncTimeout$2.read(AsyncTimeout.java:237)
	... 58 common frames omitted
25-03-14.19:50:15.847 [main            ] INFO  OrderService           - 创建支付订单成功, payOrder: PayOrderEntity{userId='null', orderId='656698827739', payUrl='<form name="punchout_form" method="post" action="https://openapi-sandbox.dl.alipaydev.com/gateway.do?charset=utf-8&method=alipay.trade.page.pay&sign=FDy0jCocaTD7mpOsFiQeq5cftK6SqHsBksWKfPjchgcG6eV9n%2FocCMsf12vwp45QcwLGYLs%2B3ZWwgjbfmsIK3DRLocPbM0id7s5ess0p4ro263hMSg4l4BdFPN8efgCxnG7Zfa9KYNyTAydlhFpQrF8oXflsQRwNB6CSC02Ic08lBZYaj5MRrzhZdOZngoJ93q%2BQapRkt8%2Bs7zS%2BW%2B8%2BP08rbGuYm%2Bm8W419gJkgMI2XZeEhKm4KrNQaoLI%2FQ5Y6RKWWDZO3SwhLMZLD5LblBZ4Oi2axcQaQAqOsng1%2B1DaRY03oO0LoyJHZ7Hcugz%2B3dEp5hAGAzl6c7Kzd0UQ5QQ%3D%3D&return_url=https%3A%2F%2Fgaga.plus&notify_url=http%3A%2F%2Feason.nat300.top%2Fapi%2Fv1%2Falipay%2Falipay_notify_url&version=1.0&app_id=9021000143682740&sign_type=RSA2&timestamp=2025-03-14+19%3A50%3A15&alipay_sdk=alipay-sdk-java-4.38.157.ALL&format=json">
<input type="hidden" name="biz_content" value="{&quot;out_trade_no&quot;:&quot;656698827739&quot;,&quot;total_amount&quot;:&quot;100.00&quot;,&quot;subject&quot;:&quot;《手写MyBatis：渐进式源码实践》&quot;,&quot;product_code&quot;:&quot;FAST_INSTANT_TRADE_PAY&quot;}">
<input type="submit" value="立即支付" style="display:none" >
</form>
<script>document.forms[0].submit();</script>', orderStatus=PAY_WAITE}
25-03-14.19:50:15.865 [main            ] INFO  OrderService           - 支付 URL: 
<form name="punchout_form" method="post" action="https://openapi-sandbox.dl.alipaydev.com/gateway.do?charset=utf-8&method=alipay.trade.page.pay&sign=FDy0jCocaTD7mpOsFiQeq5cftK6SqHsBksWKfPjchgcG6eV9n%2FocCMsf12vwp45QcwLGYLs%2B3ZWwgjbfmsIK3DRLocPbM0id7s5ess0p4ro263hMSg4l4BdFPN8efgCxnG7Zfa9KYNyTAydlhFpQrF8oXflsQRwNB6CSC02Ic08lBZYaj5MRrzhZdOZngoJ93q%2BQapRkt8%2Bs7zS%2BW%2B8%2BP08rbGuYm%2Bm8W419gJkgMI2XZeEhKm4KrNQaoLI%2FQ5Y6RKWWDZO3SwhLMZLD5LblBZ4Oi2axcQaQAqOsng1%2B1DaRY03oO0LoyJHZ7Hcugz%2B3dEp5hAGAzl6c7Kzd0UQ5QQ%3D%3D&return_url=https%3A%2F%2Fgaga.plus&notify_url=http%3A%2F%2Feason.nat300.top%2Fapi%2Fv1%2Falipay%2Falipay_notify_url&version=1.0&app_id=9021000143682740&sign_type=RSA2&timestamp=2025-03-14+19%3A50%3A15&alipay_sdk=alipay-sdk-java-4.38.157.ALL&format=json">
<input type="hidden" name="biz_content" value="{&quot;out_trade_no&quot;:&quot;656698827739&quot;,&quot;total_amount&quot;:&quot;100.00&quot;,&quot;subject&quot;:&quot;《手写MyBatis：渐进式源码实践》&quot;,&quot;product_code&quot;:&quot;FAST_INSTANT_TRADE_PAY&quot;}">
<input type="submit" value="立即支付" style="display:none" >
</form>
<script>document.forms[0].submit();</script>
25-03-14.19:50:15.866 [main            ] INFO  AbstractOrderService   - 创建订单-完成，生成支付单。userId: Eason4 orderId: 656698827739 payUrl: <form name="punchout_form" method="post" action="https://openapi-sandbox.dl.alipaydev.com/gateway.do?charset=utf-8&method=alipay.trade.page.pay&sign=FDy0jCocaTD7mpOsFiQeq5cftK6SqHsBksWKfPjchgcG6eV9n%2FocCMsf12vwp45QcwLGYLs%2B3ZWwgjbfmsIK3DRLocPbM0id7s5ess0p4ro263hMSg4l4BdFPN8efgCxnG7Zfa9KYNyTAydlhFpQrF8oXflsQRwNB6CSC02Ic08lBZYaj5MRrzhZdOZngoJ93q%2BQapRkt8%2Bs7zS%2BW%2B8%2BP08rbGuYm%2Bm8W419gJkgMI2XZeEhKm4KrNQaoLI%2FQ5Y6RKWWDZO3SwhLMZLD5LblBZ4Oi2axcQaQAqOsng1%2B1DaRY03oO0LoyJHZ7Hcugz%2B3dEp5hAGAzl6c7Kzd0UQ5QQ%3D%3D&return_url=https%3A%2F%2Fgaga.plus&notify_url=http%3A%2F%2Feason.nat300.top%2Fapi%2Fv1%2Falipay%2Falipay_notify_url&version=1.0&app_id=9021000143682740&sign_type=RSA2&timestamp=2025-03-14+19%3A50%3A15&alipay_sdk=alipay-sdk-java-4.38.157.ALL&format=json">
<input type="hidden" name="biz_content" value="{&quot;out_trade_no&quot;:&quot;656698827739&quot;,&quot;total_amount&quot;:&quot;100.00&quot;,&quot;subject&quot;:&quot;《手写MyBatis：渐进式源码实践》&quot;,&quot;product_code&quot;:&quot;FAST_INSTANT_TRADE_PAY&quot;}">
<input type="submit" value="立即支付" style="display:none" >
</form>
<script>document.forms[0].submit();</script> discount: null
25-03-14.19:50:15.881 [main            ] INFO  OrderServiceTest       - 请求参数:{"activityId":100123,"marketType":"拼团营销","productId":"9890001","userId":"Eason4"}
25-03-14.19:50:15.885 [main            ] INFO  OrderServiceTest       - 测试结果:{"deductionAmount":0,"marketType":"无营销","orderId":"656698827739","orderStatus":"等待支付－订单创建完成后，创建支付单","payAmount":100.00,"payUrl":"<form name=\"punchout_form\" method=\"post\" action=\"https://openapi-sandbox.dl.alipaydev.com/gateway.do?charset=utf-8&method=alipay.trade.page.pay&sign=FDy0jCocaTD7mpOsFiQeq5cftK6SqHsBksWKfPjchgcG6eV9n%2FocCMsf12vwp45QcwLGYLs%2B3ZWwgjbfmsIK3DRLocPbM0id7s5ess0p4ro263hMSg4l4BdFPN8efgCxnG7Zfa9KYNyTAydlhFpQrF8oXflsQRwNB6CSC02Ic08lBZYaj5MRrzhZdOZngoJ93q%2BQapRkt8%2Bs7zS%2BW%2B8%2BP08rbGuYm%2Bm8W419gJkgMI2XZeEhKm4KrNQaoLI%2FQ5Y6RKWWDZO3SwhLMZLD5LblBZ4Oi2axcQaQAqOsng1%2B1DaRY03oO0LoyJHZ7Hcugz%2B3dEp5hAGAzl6c7Kzd0UQ5QQ%3D%3D&return_url=https%3A%2F%2Fgaga.plus&notify_url=http%3A%2F%2Feason.nat300.top%2Fapi%2Fv1%2Falipay%2Falipay_notify_url&version=1.0&app_id=9021000143682740&sign_type=RSA2&timestamp=2025-03-14+19%3A50%3A15&alipay_sdk=alipay-sdk-java-4.38.157.ALL&format=json\">\n<input type=\"hidden\" name=\"biz_content\" value=\"{&quot;out_trade_no&quot;:&quot;656698827739&quot;,&quot;total_amount&quot;:&quot;100.00&quot;,&quot;subject&quot;:&quot;《手写MyBatis：渐进式源码实践》&quot;,&quot;product_code&quot;:&quot;FAST_INSTANT_TRADE_PAY&quot;}\">\n<input type=\"submit\" value=\"立即支付\" style=\"display:none\" >\n</form>\n<script>document.forms[0].submit();</script>","userId":"Eason4"}
25-03-14.19:50:15.897 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-03-14.19:50:16.810 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-03-14.19:50:16.819 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-1 - Shutdown initiated...
25-03-14.19:50:16.824 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-1 - Shutdown completed.
25-03-14.19:51:42.678 [main            ] INFO  OrderServiceTest       - Starting OrderServiceTest using Java 17.0.13 with PID 107924 (started by Eason in D:\Code\codes\s-pay-mall-ddd-eason\s-pay-mall-ddd-eason-app)
25-03-14.19:51:42.679 [main            ] INFO  OrderServiceTest       - The following 1 profile is active: "dev"
25-03-14.19:51:44.431 [main            ] INFO  OptionalValidatorFactoryBean - Failed to set up a Bean Validation provider: jakarta.validation.NoProviderFoundException: Unable to create a Configuration, because no Jakarta Bean Validation provider could be found. Add a provider like Hibernate Validator (RI) to your classpath.
25-03-14.19:51:44.810 [main            ] INFO  CachingConnectionFactory - Attempting to connect to: [192.168.226.128:5672]
25-03-14.19:51:44.877 [main            ] INFO  CachingConnectionFactory - Created new connection: rabbitConnectionFactory#60cb1ed6:0/SimpleConnection@2c9cafa5 [delegate=amqp://s-pay-mall@192.168.226.128:5672//s-pay-mall, localPort=64956]
25-03-14.19:51:44.963 [main            ] INFO  OrderServiceTest       - Started OrderServiceTest in 2.688 seconds (process running for 3.417)
25-03-14.19:51:45.708 [main            ] INFO  HikariDataSource       - HikariPool-1 - Starting...
25-03-14.19:51:45.880 [main            ] INFO  HikariPool             - HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@5e9cb95
25-03-14.19:51:45.881 [main            ] INFO  HikariDataSource       - HikariPool-1 - Start completed.
25-03-14.19:51:46.280 [main            ] INFO  PayPort                - 拼团订单锁定, userId: Eason4, request: LockMarketPayOrderRequestDTO(userId=Eason4, teamId=null, activityId=100123, goodsId=9890001, source=s01, channel=c01, outerOrderId=807691592906, notifyUrl=http://127.0.0.1:8081/api/v1/alipay/group_buy_notify), response: Result(msg=success, code=1, data=LockMarketPayOrderResponseDTO(orderId=660510906807, teamId=65482552, originalPrice=null, discountPrice=10.00, payPrice=90.00, tradeOrderStatus=0))
25-03-14.19:51:46.408 [main            ] INFO  OrderService           - 创建支付订单成功, payOrder: PayOrderEntity{userId='null', orderId='807691592906', payUrl='<form name="punchout_form" method="post" action="https://openapi-sandbox.dl.alipaydev.com/gateway.do?charset=utf-8&method=alipay.trade.page.pay&sign=B5vYH5DiLae9jbEDcok3Tgy7yUG7zpM4F%2BxOmdzqneTvy3bjmrG0vrUaoUl7rYNtFtI71ESSVh5LpCTiWb53MOKOYgdYrrZYaGTqt4cRkH2UViWD%2FQA8SgEy6Osdb2dU%2F1hQnkOYjAAXdOt6Wyrhh2j8ZzCpGetlznlRUqoCKWFgfl8kg1wgGLJpYFeVbre%2BWev6OwcbgkzowhqQbYPOBEuuVXLRVpCP8xGk7onNgdzEs%2FizXjPiQeWOIY20PCM65n6J6XE%2B36abL5PlzJQUtWygc3Rhkxy%2Fvno0455fAWDLiJV57erZRANJ5sAX2sAKmkg%2F4Bs6T0Xkv249C8PMGg%3D%3D&return_url=https%3A%2F%2Fgaga.plus&notify_url=http%3A%2F%2Feason.nat300.top%2Fapi%2Fv1%2Falipay%2Falipay_notify_url&version=1.0&app_id=9021000143682740&sign_type=RSA2&timestamp=2025-03-14+19%3A51%3A46&alipay_sdk=alipay-sdk-java-4.38.157.ALL&format=json">
<input type="hidden" name="biz_content" value="{&quot;out_trade_no&quot;:&quot;807691592906&quot;,&quot;total_amount&quot;:&quot;100.00&quot;,&quot;subject&quot;:&quot;《手写MyBatis：渐进式源码实践》&quot;,&quot;product_code&quot;:&quot;FAST_INSTANT_TRADE_PAY&quot;}">
<input type="submit" value="立即支付" style="display:none" >
</form>
<script>document.forms[0].submit();</script>', orderStatus=PAY_WAITE}
25-03-14.19:51:46.428 [main            ] INFO  OrderService           - 支付 URL: 
<form name="punchout_form" method="post" action="https://openapi-sandbox.dl.alipaydev.com/gateway.do?charset=utf-8&method=alipay.trade.page.pay&sign=B5vYH5DiLae9jbEDcok3Tgy7yUG7zpM4F%2BxOmdzqneTvy3bjmrG0vrUaoUl7rYNtFtI71ESSVh5LpCTiWb53MOKOYgdYrrZYaGTqt4cRkH2UViWD%2FQA8SgEy6Osdb2dU%2F1hQnkOYjAAXdOt6Wyrhh2j8ZzCpGetlznlRUqoCKWFgfl8kg1wgGLJpYFeVbre%2BWev6OwcbgkzowhqQbYPOBEuuVXLRVpCP8xGk7onNgdzEs%2FizXjPiQeWOIY20PCM65n6J6XE%2B36abL5PlzJQUtWygc3Rhkxy%2Fvno0455fAWDLiJV57erZRANJ5sAX2sAKmkg%2F4Bs6T0Xkv249C8PMGg%3D%3D&return_url=https%3A%2F%2Fgaga.plus&notify_url=http%3A%2F%2Feason.nat300.top%2Fapi%2Fv1%2Falipay%2Falipay_notify_url&version=1.0&app_id=9021000143682740&sign_type=RSA2&timestamp=2025-03-14+19%3A51%3A46&alipay_sdk=alipay-sdk-java-4.38.157.ALL&format=json">
<input type="hidden" name="biz_content" value="{&quot;out_trade_no&quot;:&quot;807691592906&quot;,&quot;total_amount&quot;:&quot;100.00&quot;,&quot;subject&quot;:&quot;《手写MyBatis：渐进式源码实践》&quot;,&quot;product_code&quot;:&quot;FAST_INSTANT_TRADE_PAY&quot;}">
<input type="submit" value="立即支付" style="display:none" >
</form>
<script>document.forms[0].submit();</script>
25-03-14.19:51:46.428 [main            ] INFO  AbstractOrderService   - 创建订单-完成，生成支付单。userId: Eason4 orderId: 807691592906 payUrl: <form name="punchout_form" method="post" action="https://openapi-sandbox.dl.alipaydev.com/gateway.do?charset=utf-8&method=alipay.trade.page.pay&sign=B5vYH5DiLae9jbEDcok3Tgy7yUG7zpM4F%2BxOmdzqneTvy3bjmrG0vrUaoUl7rYNtFtI71ESSVh5LpCTiWb53MOKOYgdYrrZYaGTqt4cRkH2UViWD%2FQA8SgEy6Osdb2dU%2F1hQnkOYjAAXdOt6Wyrhh2j8ZzCpGetlznlRUqoCKWFgfl8kg1wgGLJpYFeVbre%2BWev6OwcbgkzowhqQbYPOBEuuVXLRVpCP8xGk7onNgdzEs%2FizXjPiQeWOIY20PCM65n6J6XE%2B36abL5PlzJQUtWygc3Rhkxy%2Fvno0455fAWDLiJV57erZRANJ5sAX2sAKmkg%2F4Bs6T0Xkv249C8PMGg%3D%3D&return_url=https%3A%2F%2Fgaga.plus&notify_url=http%3A%2F%2Feason.nat300.top%2Fapi%2Fv1%2Falipay%2Falipay_notify_url&version=1.0&app_id=9021000143682740&sign_type=RSA2&timestamp=2025-03-14+19%3A51%3A46&alipay_sdk=alipay-sdk-java-4.38.157.ALL&format=json">
<input type="hidden" name="biz_content" value="{&quot;out_trade_no&quot;:&quot;807691592906&quot;,&quot;total_amount&quot;:&quot;100.00&quot;,&quot;subject&quot;:&quot;《手写MyBatis：渐进式源码实践》&quot;,&quot;product_code&quot;:&quot;FAST_INSTANT_TRADE_PAY&quot;}">
<input type="submit" value="立即支付" style="display:none" >
</form>
<script>document.forms[0].submit();</script> discount: MarketPayDiscountEntity(originalAmount=null, deductionAmount=10.00, payAmount=90.00)
25-03-14.19:51:46.442 [main            ] INFO  OrderServiceTest       - 请求参数:{"activityId":100123,"marketType":"拼团营销","productId":"9890001","userId":"Eason4"}
25-03-14.19:51:46.445 [main            ] INFO  OrderServiceTest       - 测试结果:{"deductionAmount":10.00,"marketType":"拼团营销","orderId":"807691592906","orderStatus":"等待支付－订单创建完成后，创建支付单","payAmount":90.00,"payUrl":"<form name=\"punchout_form\" method=\"post\" action=\"https://openapi-sandbox.dl.alipaydev.com/gateway.do?charset=utf-8&method=alipay.trade.page.pay&sign=B5vYH5DiLae9jbEDcok3Tgy7yUG7zpM4F%2BxOmdzqneTvy3bjmrG0vrUaoUl7rYNtFtI71ESSVh5LpCTiWb53MOKOYgdYrrZYaGTqt4cRkH2UViWD%2FQA8SgEy6Osdb2dU%2F1hQnkOYjAAXdOt6Wyrhh2j8ZzCpGetlznlRUqoCKWFgfl8kg1wgGLJpYFeVbre%2BWev6OwcbgkzowhqQbYPOBEuuVXLRVpCP8xGk7onNgdzEs%2FizXjPiQeWOIY20PCM65n6J6XE%2B36abL5PlzJQUtWygc3Rhkxy%2Fvno0455fAWDLiJV57erZRANJ5sAX2sAKmkg%2F4Bs6T0Xkv249C8PMGg%3D%3D&return_url=https%3A%2F%2Fgaga.plus&notify_url=http%3A%2F%2Feason.nat300.top%2Fapi%2Fv1%2Falipay%2Falipay_notify_url&version=1.0&app_id=9021000143682740&sign_type=RSA2&timestamp=2025-03-14+19%3A51%3A46&alipay_sdk=alipay-sdk-java-4.38.157.ALL&format=json\">\n<input type=\"hidden\" name=\"biz_content\" value=\"{&quot;out_trade_no&quot;:&quot;807691592906&quot;,&quot;total_amount&quot;:&quot;100.00&quot;,&quot;subject&quot;:&quot;《手写MyBatis：渐进式源码实践》&quot;,&quot;product_code&quot;:&quot;FAST_INSTANT_TRADE_PAY&quot;}\">\n<input type=\"submit\" value=\"立即支付\" style=\"display:none\" >\n</form>\n<script>document.forms[0].submit();</script>","userId":"Eason4"}
25-03-14.19:51:46.456 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-03-14.19:51:46.971 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-03-14.19:51:46.977 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-1 - Shutdown initiated...
25-03-14.19:51:46.985 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-1 - Shutdown completed.
25-03-14.19:56:12.347 [main            ] INFO  OrderServiceTest       - Starting OrderServiceTest using Java 17.0.13 with PID 128860 (started by Eason in D:\Code\codes\s-pay-mall-ddd-eason\s-pay-mall-ddd-eason-app)
25-03-14.19:56:12.348 [main            ] INFO  OrderServiceTest       - The following 1 profile is active: "dev"
25-03-14.19:56:14.181 [main            ] INFO  OptionalValidatorFactoryBean - Failed to set up a Bean Validation provider: jakarta.validation.NoProviderFoundException: Unable to create a Configuration, because no Jakarta Bean Validation provider could be found. Add a provider like Hibernate Validator (RI) to your classpath.
25-03-14.19:56:14.624 [main            ] INFO  CachingConnectionFactory - Attempting to connect to: [192.168.226.128:5672]
25-03-14.19:56:14.699 [main            ] INFO  CachingConnectionFactory - Created new connection: rabbitConnectionFactory#4538856f:0/SimpleConnection@7df4709e [delegate=amqp://s-pay-mall@192.168.226.128:5672//s-pay-mall, localPort=63175]
25-03-14.19:56:14.786 [main            ] INFO  OrderServiceTest       - Started OrderServiceTest in 2.829 seconds (process running for 3.623)
25-03-14.19:56:15.541 [main            ] INFO  HikariDataSource       - HikariPool-1 - Starting...
25-03-14.19:56:15.696 [main            ] INFO  HikariPool             - HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@7978550b
25-03-14.19:56:15.699 [main            ] INFO  HikariDataSource       - HikariPool-1 - Start completed.
25-03-14.19:56:25.827 [main            ] ERROR PayPort                - 营销锁单失败 userId: Eason4, orderItemId: 551186041670
java.net.SocketTimeoutException: timeout
	at okio.Okio$4.newTimeoutException(Okio.java:232)
	at okio.AsyncTimeout.exit(AsyncTimeout.java:286)
	at okio.AsyncTimeout$2.read(AsyncTimeout.java:241)
	at okio.RealBufferedSource.indexOf(RealBufferedSource.java:358)
	at okio.RealBufferedSource.readUtf8LineStrict(RealBufferedSource.java:230)
	at okhttp3.internal.http1.Http1ExchangeCodec.readHeaderLine(Http1ExchangeCodec.java:242)
	at okhttp3.internal.http1.Http1ExchangeCodec.readResponseHeaders(Http1ExchangeCodec.java:213)
	at okhttp3.internal.connection.Exchange.readResponseHeaders(Exchange.java:115)
	at okhttp3.internal.http.CallServerInterceptor.intercept(CallServerInterceptor.java:94)
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.java:142)
	at okhttp3.internal.connection.ConnectInterceptor.intercept(ConnectInterceptor.java:43)
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.java:142)
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.java:117)
	at okhttp3.internal.cache.CacheInterceptor.intercept(CacheInterceptor.java:94)
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.java:142)
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.java:117)
	at okhttp3.internal.http.BridgeInterceptor.intercept(BridgeInterceptor.java:93)
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.java:142)
	at okhttp3.internal.http.RetryAndFollowUpInterceptor.intercept(RetryAndFollowUpInterceptor.java:88)
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.java:142)
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.java:117)
	at okhttp3.RealCall.getResponseWithInterceptorChain(RealCall.java:229)
	at okhttp3.RealCall.execute(RealCall.java:81)
	at retrofit2.OkHttpCall.execute(OkHttpCall.java:204)
	at xin.eason.infrastructure.adapter.port.PayPort.lockMarketOrder(PayPort.java:118)
	at xin.eason.domain.order.service.OrderService.lockMarketOrder(OrderService.java:70)
	at xin.eason.domain.order.service.AbstractOrderService.createOrder(AbstractOrderService.java:89)
	at xin.eason.test.OrderServiceTest.test_createOrder(OrderServiceTest.java:32)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.springframework.test.context.junit4.statements.RunBeforeTestExecutionCallbacks.evaluate(RunBeforeTestExecutionCallbacks.java:76)
	at org.springframework.test.context.junit4.statements.RunAfterTestExecutionCallbacks.evaluate(RunAfterTestExecutionCallbacks.java:84)
	at org.springframework.test.context.junit4.statements.RunBeforeTestMethodCallbacks.evaluate(RunBeforeTestMethodCallbacks.java:75)
	at org.springframework.test.context.junit4.statements.RunAfterTestMethodCallbacks.evaluate(RunAfterTestMethodCallbacks.java:86)
	at org.springframework.test.context.junit4.statements.SpringRepeat.evaluate(SpringRepeat.java:84)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:252)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:97)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.springframework.test.context.junit4.statements.RunBeforeTestClassCallbacks.evaluate(RunBeforeTestClassCallbacks.java:61)
	at org.springframework.test.context.junit4.statements.RunAfterTestClassCallbacks.evaluate(RunAfterTestClassCallbacks.java:70)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.run(SpringJUnit4ClassRunner.java:191)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at com.intellij.junit4.JUnit4IdeaTestRunner.startRunnerWithArgs(JUnit4IdeaTestRunner.java:69)
	at com.intellij.rt.junit.IdeaTestRunner$Repeater$1.execute(IdeaTestRunner.java:38)
	at com.intellij.rt.execution.junit.TestsRepeater.repeat(TestsRepeater.java:11)
	at com.intellij.rt.junit.IdeaTestRunner$Repeater.startRunnerWithArgs(IdeaTestRunner.java:35)
	at com.intellij.rt.junit.JUnitStarter.prepareStreamsAndStart(JUnitStarter.java:232)
	at com.intellij.rt.junit.JUnitStarter.main(JUnitStarter.java:55)
Caused by: java.net.SocketException: Socket closed
	at java.base/sun.nio.ch.NioSocketImpl.endRead(NioSocketImpl.java:253)
	at java.base/sun.nio.ch.NioSocketImpl.implRead(NioSocketImpl.java:332)
	at java.base/sun.nio.ch.NioSocketImpl.read(NioSocketImpl.java:355)
	at java.base/sun.nio.ch.NioSocketImpl$1.read(NioSocketImpl.java:808)
	at java.base/java.net.Socket$SocketInputStream.read(Socket.java:966)
	at okio.Okio$2.read(Okio.java:140)
	at okio.AsyncTimeout$2.read(AsyncTimeout.java:237)
	... 58 common frames omitted
25-03-14.19:56:25.932 [main            ] INFO  OrderService           - 创建支付订单成功, payOrder: PayOrderEntity{userId='null', orderId='551186041670', payUrl='<form name="punchout_form" method="post" action="https://openapi-sandbox.dl.alipaydev.com/gateway.do?charset=utf-8&method=alipay.trade.page.pay&sign=UCA%2BEImNNLaQHtp9J7Z6QInfqE8bIGkR3qayQLVcDR18A1j62%2BhXMgOE1XiBgGp39Ejmj8FyRWYb%2B0NAG8H4skRtXhiGDjm7HF97loc8AWn8uIGQPYGeOkhY5W9dGz9%2Fp66%2BCkUXQpHtIWkp3uZTK9OOs0yzMbSLMdGdnk3FzX1DEyQnQ6mSqtxwvkfsg0QZe1Nl8WRX17v%2FsXr3%2F2x1QpU7gX7mXxhjERyHZ0Z83jrd%2Bm3JRhFSpoQmakzCWiiKSJfnmv1MaGtJSYh9u0yMO046a%2F4ub3YH59g%2Fb937wRilXlzTgCQBMFbeiNcqRIF%2FDCe5hjk9%2BX5B4A9BPSKT6A%3D%3D&return_url=https%3A%2F%2Fgaga.plus&notify_url=http%3A%2F%2Feason.nat300.top%2Fapi%2Fv1%2Falipay%2Falipay_notify_url&version=1.0&app_id=9021000143682740&sign_type=RSA2&timestamp=2025-03-14+19%3A56%3A25&alipay_sdk=alipay-sdk-java-4.38.157.ALL&format=json">
<input type="hidden" name="biz_content" value="{&quot;out_trade_no&quot;:&quot;551186041670&quot;,&quot;total_amount&quot;:&quot;100.00&quot;,&quot;subject&quot;:&quot;《手写MyBatis：渐进式源码实践》&quot;,&quot;product_code&quot;:&quot;FAST_INSTANT_TRADE_PAY&quot;}">
<input type="submit" value="立即支付" style="display:none" >
</form>
<script>document.forms[0].submit();</script>', orderStatus=PAY_WAITE}
25-03-14.19:56:25.957 [main            ] INFO  OrderService           - 支付 URL: 
<form name="punchout_form" method="post" action="https://openapi-sandbox.dl.alipaydev.com/gateway.do?charset=utf-8&method=alipay.trade.page.pay&sign=UCA%2BEImNNLaQHtp9J7Z6QInfqE8bIGkR3qayQLVcDR18A1j62%2BhXMgOE1XiBgGp39Ejmj8FyRWYb%2B0NAG8H4skRtXhiGDjm7HF97loc8AWn8uIGQPYGeOkhY5W9dGz9%2Fp66%2BCkUXQpHtIWkp3uZTK9OOs0yzMbSLMdGdnk3FzX1DEyQnQ6mSqtxwvkfsg0QZe1Nl8WRX17v%2FsXr3%2F2x1QpU7gX7mXxhjERyHZ0Z83jrd%2Bm3JRhFSpoQmakzCWiiKSJfnmv1MaGtJSYh9u0yMO046a%2F4ub3YH59g%2Fb937wRilXlzTgCQBMFbeiNcqRIF%2FDCe5hjk9%2BX5B4A9BPSKT6A%3D%3D&return_url=https%3A%2F%2Fgaga.plus&notify_url=http%3A%2F%2Feason.nat300.top%2Fapi%2Fv1%2Falipay%2Falipay_notify_url&version=1.0&app_id=9021000143682740&sign_type=RSA2&timestamp=2025-03-14+19%3A56%3A25&alipay_sdk=alipay-sdk-java-4.38.157.ALL&format=json">
<input type="hidden" name="biz_content" value="{&quot;out_trade_no&quot;:&quot;551186041670&quot;,&quot;total_amount&quot;:&quot;100.00&quot;,&quot;subject&quot;:&quot;《手写MyBatis：渐进式源码实践》&quot;,&quot;product_code&quot;:&quot;FAST_INSTANT_TRADE_PAY&quot;}">
<input type="submit" value="立即支付" style="display:none" >
</form>
<script>document.forms[0].submit();</script>
25-03-14.19:56:25.957 [main            ] INFO  AbstractOrderService   - 创建订单-完成，生成支付单。userId: Eason4 orderId: 551186041670 payUrl: <form name="punchout_form" method="post" action="https://openapi-sandbox.dl.alipaydev.com/gateway.do?charset=utf-8&method=alipay.trade.page.pay&sign=UCA%2BEImNNLaQHtp9J7Z6QInfqE8bIGkR3qayQLVcDR18A1j62%2BhXMgOE1XiBgGp39Ejmj8FyRWYb%2B0NAG8H4skRtXhiGDjm7HF97loc8AWn8uIGQPYGeOkhY5W9dGz9%2Fp66%2BCkUXQpHtIWkp3uZTK9OOs0yzMbSLMdGdnk3FzX1DEyQnQ6mSqtxwvkfsg0QZe1Nl8WRX17v%2FsXr3%2F2x1QpU7gX7mXxhjERyHZ0Z83jrd%2Bm3JRhFSpoQmakzCWiiKSJfnmv1MaGtJSYh9u0yMO046a%2F4ub3YH59g%2Fb937wRilXlzTgCQBMFbeiNcqRIF%2FDCe5hjk9%2BX5B4A9BPSKT6A%3D%3D&return_url=https%3A%2F%2Fgaga.plus&notify_url=http%3A%2F%2Feason.nat300.top%2Fapi%2Fv1%2Falipay%2Falipay_notify_url&version=1.0&app_id=9021000143682740&sign_type=RSA2&timestamp=2025-03-14+19%3A56%3A25&alipay_sdk=alipay-sdk-java-4.38.157.ALL&format=json">
<input type="hidden" name="biz_content" value="{&quot;out_trade_no&quot;:&quot;551186041670&quot;,&quot;total_amount&quot;:&quot;100.00&quot;,&quot;subject&quot;:&quot;《手写MyBatis：渐进式源码实践》&quot;,&quot;product_code&quot;:&quot;FAST_INSTANT_TRADE_PAY&quot;}">
<input type="submit" value="立即支付" style="display:none" >
</form>
<script>document.forms[0].submit();</script> discount: null
25-03-14.19:56:25.968 [main            ] INFO  OrderServiceTest       - 请求参数:{"activityId":100123,"marketType":"拼团营销","productId":"9890001","userId":"Eason4"}
25-03-14.19:56:25.971 [main            ] INFO  OrderServiceTest       - 测试结果:{"deductionAmount":0,"marketType":"无营销","orderId":"551186041670","orderStatus":"等待支付－订单创建完成后，创建支付单","payAmount":100.00,"payUrl":"<form name=\"punchout_form\" method=\"post\" action=\"https://openapi-sandbox.dl.alipaydev.com/gateway.do?charset=utf-8&method=alipay.trade.page.pay&sign=UCA%2BEImNNLaQHtp9J7Z6QInfqE8bIGkR3qayQLVcDR18A1j62%2BhXMgOE1XiBgGp39Ejmj8FyRWYb%2B0NAG8H4skRtXhiGDjm7HF97loc8AWn8uIGQPYGeOkhY5W9dGz9%2Fp66%2BCkUXQpHtIWkp3uZTK9OOs0yzMbSLMdGdnk3FzX1DEyQnQ6mSqtxwvkfsg0QZe1Nl8WRX17v%2FsXr3%2F2x1QpU7gX7mXxhjERyHZ0Z83jrd%2Bm3JRhFSpoQmakzCWiiKSJfnmv1MaGtJSYh9u0yMO046a%2F4ub3YH59g%2Fb937wRilXlzTgCQBMFbeiNcqRIF%2FDCe5hjk9%2BX5B4A9BPSKT6A%3D%3D&return_url=https%3A%2F%2Fgaga.plus&notify_url=http%3A%2F%2Feason.nat300.top%2Fapi%2Fv1%2Falipay%2Falipay_notify_url&version=1.0&app_id=9021000143682740&sign_type=RSA2&timestamp=2025-03-14+19%3A56%3A25&alipay_sdk=alipay-sdk-java-4.38.157.ALL&format=json\">\n<input type=\"hidden\" name=\"biz_content\" value=\"{&quot;out_trade_no&quot;:&quot;551186041670&quot;,&quot;total_amount&quot;:&quot;100.00&quot;,&quot;subject&quot;:&quot;《手写MyBatis：渐进式源码实践》&quot;,&quot;product_code&quot;:&quot;FAST_INSTANT_TRADE_PAY&quot;}\">\n<input type=\"submit\" value=\"立即支付\" style=\"display:none\" >\n</form>\n<script>document.forms[0].submit();</script>","userId":"Eason4"}
25-03-14.19:56:25.983 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-03-14.19:56:26.893 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-03-14.19:56:26.898 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-1 - Shutdown initiated...
25-03-14.19:56:26.910 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-1 - Shutdown completed.
25-03-14.19:57:38.041 [main            ] INFO  OrderServiceTest       - Starting OrderServiceTest using Java 17.0.13 with PID 167016 (started by Eason in D:\Code\codes\s-pay-mall-ddd-eason\s-pay-mall-ddd-eason-app)
25-03-14.19:57:38.042 [main            ] INFO  OrderServiceTest       - The following 1 profile is active: "dev"
25-03-14.19:57:39.792 [main            ] INFO  OptionalValidatorFactoryBean - Failed to set up a Bean Validation provider: jakarta.validation.NoProviderFoundException: Unable to create a Configuration, because no Jakarta Bean Validation provider could be found. Add a provider like Hibernate Validator (RI) to your classpath.
25-03-14.19:57:40.246 [main            ] INFO  CachingConnectionFactory - Attempting to connect to: [192.168.226.128:5672]
25-03-14.19:57:40.319 [main            ] INFO  CachingConnectionFactory - Created new connection: rabbitConnectionFactory#49433c98:0/SimpleConnection@3739f3c9 [delegate=amqp://s-pay-mall@192.168.226.128:5672//s-pay-mall, localPort=59313]
25-03-14.19:57:40.401 [main            ] INFO  OrderServiceTest       - Started OrderServiceTest in 2.744 seconds (process running for 3.507)
25-03-14.19:57:41.130 [main            ] INFO  HikariDataSource       - HikariPool-1 - Starting...
25-03-14.19:57:41.307 [main            ] INFO  HikariPool             - HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@1d6a22dd
25-03-14.19:57:41.309 [main            ] INFO  HikariDataSource       - HikariPool-1 - Start completed.
25-03-14.19:57:51.442 [main            ] ERROR PayPort                - 营销锁单失败 userId: Eason4, orderItemId: 641606360021
java.net.SocketTimeoutException: timeout
	at okio.Okio$4.newTimeoutException(Okio.java:232)
	at okio.AsyncTimeout.exit(AsyncTimeout.java:286)
	at okio.AsyncTimeout$2.read(AsyncTimeout.java:241)
	at okio.RealBufferedSource.indexOf(RealBufferedSource.java:358)
	at okio.RealBufferedSource.readUtf8LineStrict(RealBufferedSource.java:230)
	at okhttp3.internal.http1.Http1ExchangeCodec.readHeaderLine(Http1ExchangeCodec.java:242)
	at okhttp3.internal.http1.Http1ExchangeCodec.readResponseHeaders(Http1ExchangeCodec.java:213)
	at okhttp3.internal.connection.Exchange.readResponseHeaders(Exchange.java:115)
	at okhttp3.internal.http.CallServerInterceptor.intercept(CallServerInterceptor.java:94)
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.java:142)
	at okhttp3.internal.connection.ConnectInterceptor.intercept(ConnectInterceptor.java:43)
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.java:142)
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.java:117)
	at okhttp3.internal.cache.CacheInterceptor.intercept(CacheInterceptor.java:94)
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.java:142)
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.java:117)
	at okhttp3.internal.http.BridgeInterceptor.intercept(BridgeInterceptor.java:93)
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.java:142)
	at okhttp3.internal.http.RetryAndFollowUpInterceptor.intercept(RetryAndFollowUpInterceptor.java:88)
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.java:142)
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.java:117)
	at okhttp3.RealCall.getResponseWithInterceptorChain(RealCall.java:229)
	at okhttp3.RealCall.execute(RealCall.java:81)
	at retrofit2.OkHttpCall.execute(OkHttpCall.java:204)
	at xin.eason.infrastructure.adapter.port.PayPort.lockMarketOrder(PayPort.java:118)
	at xin.eason.domain.order.service.OrderService.lockMarketOrder(OrderService.java:70)
	at xin.eason.domain.order.service.AbstractOrderService.createOrder(AbstractOrderService.java:89)
	at xin.eason.test.OrderServiceTest.test_createOrder(OrderServiceTest.java:32)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.springframework.test.context.junit4.statements.RunBeforeTestExecutionCallbacks.evaluate(RunBeforeTestExecutionCallbacks.java:76)
	at org.springframework.test.context.junit4.statements.RunAfterTestExecutionCallbacks.evaluate(RunAfterTestExecutionCallbacks.java:84)
	at org.springframework.test.context.junit4.statements.RunBeforeTestMethodCallbacks.evaluate(RunBeforeTestMethodCallbacks.java:75)
	at org.springframework.test.context.junit4.statements.RunAfterTestMethodCallbacks.evaluate(RunAfterTestMethodCallbacks.java:86)
	at org.springframework.test.context.junit4.statements.SpringRepeat.evaluate(SpringRepeat.java:84)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:252)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:97)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.springframework.test.context.junit4.statements.RunBeforeTestClassCallbacks.evaluate(RunBeforeTestClassCallbacks.java:61)
	at org.springframework.test.context.junit4.statements.RunAfterTestClassCallbacks.evaluate(RunAfterTestClassCallbacks.java:70)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.run(SpringJUnit4ClassRunner.java:191)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at com.intellij.junit4.JUnit4IdeaTestRunner.startRunnerWithArgs(JUnit4IdeaTestRunner.java:69)
	at com.intellij.rt.junit.IdeaTestRunner$Repeater$1.execute(IdeaTestRunner.java:38)
	at com.intellij.rt.execution.junit.TestsRepeater.repeat(TestsRepeater.java:11)
	at com.intellij.rt.junit.IdeaTestRunner$Repeater.startRunnerWithArgs(IdeaTestRunner.java:35)
	at com.intellij.rt.junit.JUnitStarter.prepareStreamsAndStart(JUnitStarter.java:232)
	at com.intellij.rt.junit.JUnitStarter.main(JUnitStarter.java:55)
Caused by: java.net.SocketException: Socket closed
	at java.base/sun.nio.ch.NioSocketImpl.endRead(NioSocketImpl.java:253)
	at java.base/sun.nio.ch.NioSocketImpl.implRead(NioSocketImpl.java:332)
	at java.base/sun.nio.ch.NioSocketImpl.read(NioSocketImpl.java:355)
	at java.base/sun.nio.ch.NioSocketImpl$1.read(NioSocketImpl.java:808)
	at java.base/java.net.Socket$SocketInputStream.read(Socket.java:966)
	at okio.Okio$2.read(Okio.java:140)
	at okio.AsyncTimeout$2.read(AsyncTimeout.java:237)
	... 58 common frames omitted
25-03-14.19:57:51.549 [main            ] INFO  OrderService           - 创建支付订单成功, payOrder: PayOrderEntity{userId='null', orderId='641606360021', payUrl='<form name="punchout_form" method="post" action="https://openapi-sandbox.dl.alipaydev.com/gateway.do?charset=utf-8&method=alipay.trade.page.pay&sign=enLGzu7FRigeTTUxBw46Cz8cjTe42D0Gkxd2nky4voVrKXy6b%2FbUQcQl%2BuoQuf7lSThdETNBckcQ7IUfTzn247F4pYb0tI274cg3ZRXp5%2BOgs6SuOuklHrpB7AD7NSA5nZ2cP6wTgsh%2BI5M2CwSKgQk5YrG8TCgWhVCkDSTeOu0LfXLq1Rouw%2FRdm%2FFnYqxwwifTwKr0f6t6z5zRRmoXnCOqKvjXoqUii93w2qdXvBgKWDXaabt%2F%2F2wRpX%2BrVp5HRGbers3%2BM4kFyB9dg6CMI%2BstuTIhCkDGl68aD%2B30al8O%2F3PZmq0ntbbk7OI1on9J2o5jl0UOlOxeh9rnksBuAg%3D%3D&return_url=https%3A%2F%2Fgaga.plus&notify_url=http%3A%2F%2Feason.nat300.top%2Fapi%2Fv1%2Falipay%2Falipay_notify_url&version=1.0&app_id=9021000143682740&sign_type=RSA2&timestamp=2025-03-14+19%3A57%3A51&alipay_sdk=alipay-sdk-java-4.38.157.ALL&format=json">
<input type="hidden" name="biz_content" value="{&quot;out_trade_no&quot;:&quot;641606360021&quot;,&quot;total_amount&quot;:&quot;100.00&quot;,&quot;subject&quot;:&quot;《手写MyBatis：渐进式源码实践》&quot;,&quot;product_code&quot;:&quot;FAST_INSTANT_TRADE_PAY&quot;}">
<input type="submit" value="立即支付" style="display:none" >
</form>
<script>document.forms[0].submit();</script>', orderStatus=PAY_WAITE}
25-03-14.19:57:51.568 [main            ] INFO  OrderService           - 支付 URL: 
<form name="punchout_form" method="post" action="https://openapi-sandbox.dl.alipaydev.com/gateway.do?charset=utf-8&method=alipay.trade.page.pay&sign=enLGzu7FRigeTTUxBw46Cz8cjTe42D0Gkxd2nky4voVrKXy6b%2FbUQcQl%2BuoQuf7lSThdETNBckcQ7IUfTzn247F4pYb0tI274cg3ZRXp5%2BOgs6SuOuklHrpB7AD7NSA5nZ2cP6wTgsh%2BI5M2CwSKgQk5YrG8TCgWhVCkDSTeOu0LfXLq1Rouw%2FRdm%2FFnYqxwwifTwKr0f6t6z5zRRmoXnCOqKvjXoqUii93w2qdXvBgKWDXaabt%2F%2F2wRpX%2BrVp5HRGbers3%2BM4kFyB9dg6CMI%2BstuTIhCkDGl68aD%2B30al8O%2F3PZmq0ntbbk7OI1on9J2o5jl0UOlOxeh9rnksBuAg%3D%3D&return_url=https%3A%2F%2Fgaga.plus&notify_url=http%3A%2F%2Feason.nat300.top%2Fapi%2Fv1%2Falipay%2Falipay_notify_url&version=1.0&app_id=9021000143682740&sign_type=RSA2&timestamp=2025-03-14+19%3A57%3A51&alipay_sdk=alipay-sdk-java-4.38.157.ALL&format=json">
<input type="hidden" name="biz_content" value="{&quot;out_trade_no&quot;:&quot;641606360021&quot;,&quot;total_amount&quot;:&quot;100.00&quot;,&quot;subject&quot;:&quot;《手写MyBatis：渐进式源码实践》&quot;,&quot;product_code&quot;:&quot;FAST_INSTANT_TRADE_PAY&quot;}">
<input type="submit" value="立即支付" style="display:none" >
</form>
<script>document.forms[0].submit();</script>
25-03-14.19:57:51.569 [main            ] INFO  AbstractOrderService   - 创建订单-完成，生成支付单。userId: Eason4 orderId: 641606360021 payUrl: <form name="punchout_form" method="post" action="https://openapi-sandbox.dl.alipaydev.com/gateway.do?charset=utf-8&method=alipay.trade.page.pay&sign=enLGzu7FRigeTTUxBw46Cz8cjTe42D0Gkxd2nky4voVrKXy6b%2FbUQcQl%2BuoQuf7lSThdETNBckcQ7IUfTzn247F4pYb0tI274cg3ZRXp5%2BOgs6SuOuklHrpB7AD7NSA5nZ2cP6wTgsh%2BI5M2CwSKgQk5YrG8TCgWhVCkDSTeOu0LfXLq1Rouw%2FRdm%2FFnYqxwwifTwKr0f6t6z5zRRmoXnCOqKvjXoqUii93w2qdXvBgKWDXaabt%2F%2F2wRpX%2BrVp5HRGbers3%2BM4kFyB9dg6CMI%2BstuTIhCkDGl68aD%2B30al8O%2F3PZmq0ntbbk7OI1on9J2o5jl0UOlOxeh9rnksBuAg%3D%3D&return_url=https%3A%2F%2Fgaga.plus&notify_url=http%3A%2F%2Feason.nat300.top%2Fapi%2Fv1%2Falipay%2Falipay_notify_url&version=1.0&app_id=9021000143682740&sign_type=RSA2&timestamp=2025-03-14+19%3A57%3A51&alipay_sdk=alipay-sdk-java-4.38.157.ALL&format=json">
<input type="hidden" name="biz_content" value="{&quot;out_trade_no&quot;:&quot;641606360021&quot;,&quot;total_amount&quot;:&quot;100.00&quot;,&quot;subject&quot;:&quot;《手写MyBatis：渐进式源码实践》&quot;,&quot;product_code&quot;:&quot;FAST_INSTANT_TRADE_PAY&quot;}">
<input type="submit" value="立即支付" style="display:none" >
</form>
<script>document.forms[0].submit();</script> discount: null
25-03-14.19:57:51.583 [main            ] INFO  OrderServiceTest       - 请求参数:{"activityId":100123,"marketType":"拼团营销","productId":"9890001","userId":"Eason4"}
25-03-14.19:57:51.585 [main            ] INFO  OrderServiceTest       - 测试结果:{"deductionAmount":0,"marketType":"无营销","orderId":"641606360021","orderStatus":"等待支付－订单创建完成后，创建支付单","payAmount":100.00,"payUrl":"<form name=\"punchout_form\" method=\"post\" action=\"https://openapi-sandbox.dl.alipaydev.com/gateway.do?charset=utf-8&method=alipay.trade.page.pay&sign=enLGzu7FRigeTTUxBw46Cz8cjTe42D0Gkxd2nky4voVrKXy6b%2FbUQcQl%2BuoQuf7lSThdETNBckcQ7IUfTzn247F4pYb0tI274cg3ZRXp5%2BOgs6SuOuklHrpB7AD7NSA5nZ2cP6wTgsh%2BI5M2CwSKgQk5YrG8TCgWhVCkDSTeOu0LfXLq1Rouw%2FRdm%2FFnYqxwwifTwKr0f6t6z5zRRmoXnCOqKvjXoqUii93w2qdXvBgKWDXaabt%2F%2F2wRpX%2BrVp5HRGbers3%2BM4kFyB9dg6CMI%2BstuTIhCkDGl68aD%2B30al8O%2F3PZmq0ntbbk7OI1on9J2o5jl0UOlOxeh9rnksBuAg%3D%3D&return_url=https%3A%2F%2Fgaga.plus&notify_url=http%3A%2F%2Feason.nat300.top%2Fapi%2Fv1%2Falipay%2Falipay_notify_url&version=1.0&app_id=9021000143682740&sign_type=RSA2&timestamp=2025-03-14+19%3A57%3A51&alipay_sdk=alipay-sdk-java-4.38.157.ALL&format=json\">\n<input type=\"hidden\" name=\"biz_content\" value=\"{&quot;out_trade_no&quot;:&quot;641606360021&quot;,&quot;total_amount&quot;:&quot;100.00&quot;,&quot;subject&quot;:&quot;《手写MyBatis：渐进式源码实践》&quot;,&quot;product_code&quot;:&quot;FAST_INSTANT_TRADE_PAY&quot;}\">\n<input type=\"submit\" value=\"立即支付\" style=\"display:none\" >\n</form>\n<script>document.forms[0].submit();</script>","userId":"Eason4"}
25-03-14.19:57:51.600 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-03-14.19:57:52.476 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-03-14.19:57:52.482 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-1 - Shutdown initiated...
25-03-14.19:57:52.492 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-1 - Shutdown completed.
25-03-14.19:58:31.211 [main            ] INFO  OrderServiceTest       - Starting OrderServiceTest using Java 17.0.13 with PID 159028 (started by Eason in D:\Code\codes\s-pay-mall-ddd-eason\s-pay-mall-ddd-eason-app)
25-03-14.19:58:31.212 [main            ] INFO  OrderServiceTest       - The following 1 profile is active: "dev"
25-03-14.19:58:33.045 [main            ] INFO  OptionalValidatorFactoryBean - Failed to set up a Bean Validation provider: jakarta.validation.NoProviderFoundException: Unable to create a Configuration, because no Jakarta Bean Validation provider could be found. Add a provider like Hibernate Validator (RI) to your classpath.
25-03-14.19:58:33.418 [main            ] INFO  CachingConnectionFactory - Attempting to connect to: [192.168.226.128:5672]
25-03-14.19:58:33.491 [main            ] INFO  CachingConnectionFactory - Created new connection: rabbitConnectionFactory#536b71b4:0/SimpleConnection@7eae55 [delegate=amqp://s-pay-mall@192.168.226.128:5672//s-pay-mall, localPort=59437]
25-03-14.19:58:33.555 [main            ] INFO  OrderServiceTest       - Started OrderServiceTest in 2.756 seconds (process running for 3.543)
25-03-14.19:58:34.279 [main            ] INFO  HikariDataSource       - HikariPool-1 - Starting...
25-03-14.19:58:34.462 [main            ] INFO  HikariPool             - HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@2f2dc407
25-03-14.19:58:34.463 [main            ] INFO  HikariDataSource       - HikariPool-1 - Start completed.
25-03-14.19:58:44.601 [main            ] ERROR PayPort                - 营销锁单失败 userId: Eason4, orderItemId: 600117841017
java.net.SocketTimeoutException: timeout
	at okio.Okio$4.newTimeoutException(Okio.java:232)
	at okio.AsyncTimeout.exit(AsyncTimeout.java:286)
	at okio.AsyncTimeout$2.read(AsyncTimeout.java:241)
	at okio.RealBufferedSource.indexOf(RealBufferedSource.java:358)
	at okio.RealBufferedSource.readUtf8LineStrict(RealBufferedSource.java:230)
	at okhttp3.internal.http1.Http1ExchangeCodec.readHeaderLine(Http1ExchangeCodec.java:242)
	at okhttp3.internal.http1.Http1ExchangeCodec.readResponseHeaders(Http1ExchangeCodec.java:213)
	at okhttp3.internal.connection.Exchange.readResponseHeaders(Exchange.java:115)
	at okhttp3.internal.http.CallServerInterceptor.intercept(CallServerInterceptor.java:94)
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.java:142)
	at okhttp3.internal.connection.ConnectInterceptor.intercept(ConnectInterceptor.java:43)
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.java:142)
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.java:117)
	at okhttp3.internal.cache.CacheInterceptor.intercept(CacheInterceptor.java:94)
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.java:142)
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.java:117)
	at okhttp3.internal.http.BridgeInterceptor.intercept(BridgeInterceptor.java:93)
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.java:142)
	at okhttp3.internal.http.RetryAndFollowUpInterceptor.intercept(RetryAndFollowUpInterceptor.java:88)
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.java:142)
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.java:117)
	at okhttp3.RealCall.getResponseWithInterceptorChain(RealCall.java:229)
	at okhttp3.RealCall.execute(RealCall.java:81)
	at retrofit2.OkHttpCall.execute(OkHttpCall.java:204)
	at xin.eason.infrastructure.adapter.port.PayPort.lockMarketOrder(PayPort.java:118)
	at xin.eason.domain.order.service.OrderService.lockMarketOrder(OrderService.java:70)
	at xin.eason.domain.order.service.AbstractOrderService.createOrder(AbstractOrderService.java:89)
	at xin.eason.test.OrderServiceTest.test_createOrder(OrderServiceTest.java:32)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.springframework.test.context.junit4.statements.RunBeforeTestExecutionCallbacks.evaluate(RunBeforeTestExecutionCallbacks.java:76)
	at org.springframework.test.context.junit4.statements.RunAfterTestExecutionCallbacks.evaluate(RunAfterTestExecutionCallbacks.java:84)
	at org.springframework.test.context.junit4.statements.RunBeforeTestMethodCallbacks.evaluate(RunBeforeTestMethodCallbacks.java:75)
	at org.springframework.test.context.junit4.statements.RunAfterTestMethodCallbacks.evaluate(RunAfterTestMethodCallbacks.java:86)
	at org.springframework.test.context.junit4.statements.SpringRepeat.evaluate(SpringRepeat.java:84)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:252)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:97)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.springframework.test.context.junit4.statements.RunBeforeTestClassCallbacks.evaluate(RunBeforeTestClassCallbacks.java:61)
	at org.springframework.test.context.junit4.statements.RunAfterTestClassCallbacks.evaluate(RunAfterTestClassCallbacks.java:70)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.run(SpringJUnit4ClassRunner.java:191)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at com.intellij.junit4.JUnit4IdeaTestRunner.startRunnerWithArgs(JUnit4IdeaTestRunner.java:69)
	at com.intellij.rt.junit.IdeaTestRunner$Repeater$1.execute(IdeaTestRunner.java:38)
	at com.intellij.rt.execution.junit.TestsRepeater.repeat(TestsRepeater.java:11)
	at com.intellij.rt.junit.IdeaTestRunner$Repeater.startRunnerWithArgs(IdeaTestRunner.java:35)
	at com.intellij.rt.junit.JUnitStarter.prepareStreamsAndStart(JUnitStarter.java:232)
	at com.intellij.rt.junit.JUnitStarter.main(JUnitStarter.java:55)
Caused by: java.net.SocketException: Socket closed
	at java.base/sun.nio.ch.NioSocketImpl.endRead(NioSocketImpl.java:253)
	at java.base/sun.nio.ch.NioSocketImpl.implRead(NioSocketImpl.java:332)
	at java.base/sun.nio.ch.NioSocketImpl.read(NioSocketImpl.java:355)
	at java.base/sun.nio.ch.NioSocketImpl$1.read(NioSocketImpl.java:808)
	at java.base/java.net.Socket$SocketInputStream.read(Socket.java:966)
	at okio.Okio$2.read(Okio.java:140)
	at okio.AsyncTimeout$2.read(AsyncTimeout.java:237)
	... 58 common frames omitted
25-03-14.19:58:44.701 [main            ] INFO  OrderService           - 创建支付订单成功, payOrder: PayOrderEntity{userId='null', orderId='600117841017', payUrl='<form name="punchout_form" method="post" action="https://openapi-sandbox.dl.alipaydev.com/gateway.do?charset=utf-8&method=alipay.trade.page.pay&sign=OcZPt0GOmwSbNcBUICcvgctoAmUPncMO%2BUGe6xDk6KoozalBh1uE6r5AynttjiCwSgc0rmu0tDo9E8uFfLSuef0pk7Z7wysFeq6MRIzMSWBY7sfGeGSwhrHlxeULghiEclAFzpztDBFxmRrx417CRRH3kXkeBShvKJ%2B3xh8f3CVmWnmw8veaOP6OQ34o1K3z6470zV3vpvGspgRRrfdc9mnO%2BnEDZ4%2F24RwxpEqMDpHuO4OAMV7IjahsbiEcFvgmN0cQlERULxFcSQgO3cQ42sNOQpXtS%2BpsTOR3uRJjmSYVxYx2d4QLbf2xeM6LYz3Hp9tknl%2BZBCvihvC%2FMmDWQw%3D%3D&return_url=https%3A%2F%2Fgaga.plus&notify_url=http%3A%2F%2Feason.nat300.top%2Fapi%2Fv1%2Falipay%2Falipay_notify_url&version=1.0&app_id=9021000143682740&sign_type=RSA2&timestamp=2025-03-14+19%3A58%3A44&alipay_sdk=alipay-sdk-java-4.38.157.ALL&format=json">
<input type="hidden" name="biz_content" value="{&quot;out_trade_no&quot;:&quot;600117841017&quot;,&quot;total_amount&quot;:&quot;100.00&quot;,&quot;subject&quot;:&quot;《手写MyBatis：渐进式源码实践》&quot;,&quot;product_code&quot;:&quot;FAST_INSTANT_TRADE_PAY&quot;}">
<input type="submit" value="立即支付" style="display:none" >
</form>
<script>document.forms[0].submit();</script>', orderStatus=PAY_WAITE}
25-03-14.19:58:44.721 [main            ] INFO  OrderService           - 支付 URL: 
<form name="punchout_form" method="post" action="https://openapi-sandbox.dl.alipaydev.com/gateway.do?charset=utf-8&method=alipay.trade.page.pay&sign=OcZPt0GOmwSbNcBUICcvgctoAmUPncMO%2BUGe6xDk6KoozalBh1uE6r5AynttjiCwSgc0rmu0tDo9E8uFfLSuef0pk7Z7wysFeq6MRIzMSWBY7sfGeGSwhrHlxeULghiEclAFzpztDBFxmRrx417CRRH3kXkeBShvKJ%2B3xh8f3CVmWnmw8veaOP6OQ34o1K3z6470zV3vpvGspgRRrfdc9mnO%2BnEDZ4%2F24RwxpEqMDpHuO4OAMV7IjahsbiEcFvgmN0cQlERULxFcSQgO3cQ42sNOQpXtS%2BpsTOR3uRJjmSYVxYx2d4QLbf2xeM6LYz3Hp9tknl%2BZBCvihvC%2FMmDWQw%3D%3D&return_url=https%3A%2F%2Fgaga.plus&notify_url=http%3A%2F%2Feason.nat300.top%2Fapi%2Fv1%2Falipay%2Falipay_notify_url&version=1.0&app_id=9021000143682740&sign_type=RSA2&timestamp=2025-03-14+19%3A58%3A44&alipay_sdk=alipay-sdk-java-4.38.157.ALL&format=json">
<input type="hidden" name="biz_content" value="{&quot;out_trade_no&quot;:&quot;600117841017&quot;,&quot;total_amount&quot;:&quot;100.00&quot;,&quot;subject&quot;:&quot;《手写MyBatis：渐进式源码实践》&quot;,&quot;product_code&quot;:&quot;FAST_INSTANT_TRADE_PAY&quot;}">
<input type="submit" value="立即支付" style="display:none" >
</form>
<script>document.forms[0].submit();</script>
25-03-14.19:58:44.721 [main            ] INFO  AbstractOrderService   - 创建订单-完成，生成支付单。userId: Eason4 orderId: 600117841017 payUrl: <form name="punchout_form" method="post" action="https://openapi-sandbox.dl.alipaydev.com/gateway.do?charset=utf-8&method=alipay.trade.page.pay&sign=OcZPt0GOmwSbNcBUICcvgctoAmUPncMO%2BUGe6xDk6KoozalBh1uE6r5AynttjiCwSgc0rmu0tDo9E8uFfLSuef0pk7Z7wysFeq6MRIzMSWBY7sfGeGSwhrHlxeULghiEclAFzpztDBFxmRrx417CRRH3kXkeBShvKJ%2B3xh8f3CVmWnmw8veaOP6OQ34o1K3z6470zV3vpvGspgRRrfdc9mnO%2BnEDZ4%2F24RwxpEqMDpHuO4OAMV7IjahsbiEcFvgmN0cQlERULxFcSQgO3cQ42sNOQpXtS%2BpsTOR3uRJjmSYVxYx2d4QLbf2xeM6LYz3Hp9tknl%2BZBCvihvC%2FMmDWQw%3D%3D&return_url=https%3A%2F%2Fgaga.plus&notify_url=http%3A%2F%2Feason.nat300.top%2Fapi%2Fv1%2Falipay%2Falipay_notify_url&version=1.0&app_id=9021000143682740&sign_type=RSA2&timestamp=2025-03-14+19%3A58%3A44&alipay_sdk=alipay-sdk-java-4.38.157.ALL&format=json">
<input type="hidden" name="biz_content" value="{&quot;out_trade_no&quot;:&quot;600117841017&quot;,&quot;total_amount&quot;:&quot;100.00&quot;,&quot;subject&quot;:&quot;《手写MyBatis：渐进式源码实践》&quot;,&quot;product_code&quot;:&quot;FAST_INSTANT_TRADE_PAY&quot;}">
<input type="submit" value="立即支付" style="display:none" >
</form>
<script>document.forms[0].submit();</script> discount: null
25-03-14.19:58:44.733 [main            ] INFO  OrderServiceTest       - 请求参数:{"activityId":100123,"marketType":"拼团营销","productId":"9890001","userId":"Eason4"}
25-03-14.19:58:44.737 [main            ] INFO  OrderServiceTest       - 测试结果:{"deductionAmount":0,"marketType":"无营销","orderId":"600117841017","orderStatus":"等待支付－订单创建完成后，创建支付单","payAmount":100.00,"payUrl":"<form name=\"punchout_form\" method=\"post\" action=\"https://openapi-sandbox.dl.alipaydev.com/gateway.do?charset=utf-8&method=alipay.trade.page.pay&sign=OcZPt0GOmwSbNcBUICcvgctoAmUPncMO%2BUGe6xDk6KoozalBh1uE6r5AynttjiCwSgc0rmu0tDo9E8uFfLSuef0pk7Z7wysFeq6MRIzMSWBY7sfGeGSwhrHlxeULghiEclAFzpztDBFxmRrx417CRRH3kXkeBShvKJ%2B3xh8f3CVmWnmw8veaOP6OQ34o1K3z6470zV3vpvGspgRRrfdc9mnO%2BnEDZ4%2F24RwxpEqMDpHuO4OAMV7IjahsbiEcFvgmN0cQlERULxFcSQgO3cQ42sNOQpXtS%2BpsTOR3uRJjmSYVxYx2d4QLbf2xeM6LYz3Hp9tknl%2BZBCvihvC%2FMmDWQw%3D%3D&return_url=https%3A%2F%2Fgaga.plus&notify_url=http%3A%2F%2Feason.nat300.top%2Fapi%2Fv1%2Falipay%2Falipay_notify_url&version=1.0&app_id=9021000143682740&sign_type=RSA2&timestamp=2025-03-14+19%3A58%3A44&alipay_sdk=alipay-sdk-java-4.38.157.ALL&format=json\">\n<input type=\"hidden\" name=\"biz_content\" value=\"{&quot;out_trade_no&quot;:&quot;600117841017&quot;,&quot;total_amount&quot;:&quot;100.00&quot;,&quot;subject&quot;:&quot;《手写MyBatis：渐进式源码实践》&quot;,&quot;product_code&quot;:&quot;FAST_INSTANT_TRADE_PAY&quot;}\">\n<input type=\"submit\" value=\"立即支付\" style=\"display:none\" >\n</form>\n<script>document.forms[0].submit();</script>","userId":"Eason4"}
25-03-14.19:58:44.747 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-03-14.19:58:45.601 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-03-14.19:58:45.609 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-1 - Shutdown initiated...
25-03-14.19:58:45.620 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-1 - Shutdown completed.
25-03-14.19:59:07.297 [main            ] INFO  OrderServiceTest       - Starting OrderServiceTest using Java 17.0.13 with PID 150092 (started by Eason in D:\Code\codes\s-pay-mall-ddd-eason\s-pay-mall-ddd-eason-app)
25-03-14.19:59:07.299 [main            ] INFO  OrderServiceTest       - The following 1 profile is active: "dev"
25-03-14.19:59:09.015 [main            ] INFO  OptionalValidatorFactoryBean - Failed to set up a Bean Validation provider: jakarta.validation.NoProviderFoundException: Unable to create a Configuration, because no Jakarta Bean Validation provider could be found. Add a provider like Hibernate Validator (RI) to your classpath.
25-03-14.19:59:09.420 [main            ] INFO  CachingConnectionFactory - Attempting to connect to: [192.168.226.128:5672]
25-03-14.19:59:09.503 [main            ] INFO  CachingConnectionFactory - Created new connection: rabbitConnectionFactory#49433c98:0/SimpleConnection@3739f3c9 [delegate=amqp://s-pay-mall@192.168.226.128:5672//s-pay-mall, localPort=59484]
25-03-14.19:59:09.592 [main            ] INFO  OrderServiceTest       - Started OrderServiceTest in 2.681 seconds (process running for 3.429)
25-03-14.19:59:10.285 [main            ] INFO  HikariDataSource       - HikariPool-1 - Starting...
25-03-14.19:59:10.454 [main            ] INFO  HikariPool             - HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@1d6a22dd
25-03-14.19:59:10.455 [main            ] INFO  HikariDataSource       - HikariPool-1 - Start completed.
25-03-14.19:59:10.486 [main            ] INFO  AbstractOrderService   - 创建订单-存在，已存在未支付订单。userId:Eason4 productId:9890001 orderId:600117841017
25-03-14.19:59:10.584 [main            ] INFO  OrderServiceTest       - 请求参数:{"activityId":100123,"marketType":"拼团营销","productId":"9890001","userId":"Eason4"}
25-03-14.19:59:10.588 [main            ] INFO  OrderServiceTest       - 测试结果:{"orderId":"600117841017","orderStatus":"等待支付－订单创建完成后，创建支付单","payUrl":"<form name=\"punchout_form\" method=\"post\" action=\"https://openapi-sandbox.dl.alipaydev.com/gateway.do?charset=utf-8&method=alipay.trade.page.pay&sign=OcZPt0GOmwSbNcBUICcvgctoAmUPncMO%2BUGe6xDk6KoozalBh1uE6r5AynttjiCwSgc0rmu0tDo9E8uFfLSuef0pk7Z7wysFeq6MRIzMSWBY7sfGeGSwhrHlxeULghiEclAFzpztDBFxmRrx417CRRH3kXkeBShvKJ%2B3xh8f3CVmWnmw8veaOP6OQ34o1K3z6470zV3vpvGspgRRrfdc9mnO%2BnEDZ4%2F24RwxpEqMDpHuO4OAMV7IjahsbiEcFvgmN0cQlERULxFcSQgO3cQ42sNOQpXtS%2BpsTOR3uRJjmSYVxYx2d4QLbf2xeM6LYz3Hp9tknl%2BZBCvihvC%2FMmDWQw%3D%3D&return_url=https%3A%2F%2Fgaga.plus&notify_url=http%3A%2F%2Feason.nat300.top%2Fapi%2Fv1%2Falipay%2Falipay_notify_url&version=1.0&app_id=9021000143682740&sign_type=RSA2&timestamp=2025-03-14+19%3A58%3A44&alipay_sdk=alipay-sdk-java-4.38.157.ALL&format=json\">\n<input type=\"hidden\" name=\"biz_content\" value=\"{&quot;out_trade_no&quot;:&quot;600117841017&quot;,&quot;total_amount&quot;:&quot;100.00&quot;,&quot;subject&quot;:&quot;《手写MyBatis：渐进式源码实践》&quot;,&quot;product_code&quot;:&quot;FAST_INSTANT_TRADE_PAY&quot;}\">\n<input type=\"submit\" value=\"立即支付\" style=\"display:none\" >\n</form>\n<script>document.forms[0].submit();</script>","userId":"Eason4"}
25-03-14.19:59:10.598 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-03-14.19:59:10.599 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-03-14.19:59:10.604 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-1 - Shutdown initiated...
25-03-14.19:59:10.627 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-1 - Shutdown completed.
25-03-14.19:59:31.364 [main            ] INFO  OrderServiceTest       - Starting OrderServiceTest using Java 17.0.13 with PID 96340 (started by Eason in D:\Code\codes\s-pay-mall-ddd-eason\s-pay-mall-ddd-eason-app)
25-03-14.19:59:31.366 [main            ] INFO  OrderServiceTest       - The following 1 profile is active: "dev"
25-03-14.19:59:33.017 [main            ] INFO  OptionalValidatorFactoryBean - Failed to set up a Bean Validation provider: jakarta.validation.NoProviderFoundException: Unable to create a Configuration, because no Jakarta Bean Validation provider could be found. Add a provider like Hibernate Validator (RI) to your classpath.
25-03-14.19:59:33.345 [main            ] INFO  CachingConnectionFactory - Attempting to connect to: [192.168.226.128:5672]
25-03-14.19:59:33.410 [main            ] INFO  CachingConnectionFactory - Created new connection: rabbitConnectionFactory#7f13811b:0/SimpleConnection@5aa6da2 [delegate=amqp://s-pay-mall@192.168.226.128:5672//s-pay-mall, localPort=59505]
25-03-14.19:59:33.476 [main            ] INFO  OrderServiceTest       - Started OrderServiceTest in 2.524 seconds (process running for 3.288)
25-03-14.19:59:34.092 [main            ] INFO  HikariDataSource       - HikariPool-1 - Starting...
25-03-14.19:59:34.261 [main            ] INFO  HikariPool             - HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@75784062
25-03-14.19:59:34.261 [main            ] INFO  HikariDataSource       - HikariPool-1 - Start completed.
25-03-14.19:59:44.386 [main            ] ERROR PayPort                - 营销锁单失败 userId: Eason4, orderItemId: 875149116691
java.net.SocketTimeoutException: timeout
	at okio.Okio$4.newTimeoutException(Okio.java:232)
	at okio.AsyncTimeout.exit(AsyncTimeout.java:286)
	at okio.AsyncTimeout$2.read(AsyncTimeout.java:241)
	at okio.RealBufferedSource.indexOf(RealBufferedSource.java:358)
	at okio.RealBufferedSource.readUtf8LineStrict(RealBufferedSource.java:230)
	at okhttp3.internal.http1.Http1ExchangeCodec.readHeaderLine(Http1ExchangeCodec.java:242)
	at okhttp3.internal.http1.Http1ExchangeCodec.readResponseHeaders(Http1ExchangeCodec.java:213)
	at okhttp3.internal.connection.Exchange.readResponseHeaders(Exchange.java:115)
	at okhttp3.internal.http.CallServerInterceptor.intercept(CallServerInterceptor.java:94)
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.java:142)
	at okhttp3.internal.connection.ConnectInterceptor.intercept(ConnectInterceptor.java:43)
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.java:142)
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.java:117)
	at okhttp3.internal.cache.CacheInterceptor.intercept(CacheInterceptor.java:94)
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.java:142)
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.java:117)
	at okhttp3.internal.http.BridgeInterceptor.intercept(BridgeInterceptor.java:93)
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.java:142)
	at okhttp3.internal.http.RetryAndFollowUpInterceptor.intercept(RetryAndFollowUpInterceptor.java:88)
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.java:142)
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.java:117)
	at okhttp3.RealCall.getResponseWithInterceptorChain(RealCall.java:229)
	at okhttp3.RealCall.execute(RealCall.java:81)
	at retrofit2.OkHttpCall.execute(OkHttpCall.java:204)
	at xin.eason.infrastructure.adapter.port.PayPort.lockMarketOrder(PayPort.java:118)
	at xin.eason.domain.order.service.OrderService.lockMarketOrder(OrderService.java:70)
	at xin.eason.domain.order.service.AbstractOrderService.createOrder(AbstractOrderService.java:89)
	at xin.eason.test.OrderServiceTest.test_createOrder(OrderServiceTest.java:32)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.springframework.test.context.junit4.statements.RunBeforeTestExecutionCallbacks.evaluate(RunBeforeTestExecutionCallbacks.java:76)
	at org.springframework.test.context.junit4.statements.RunAfterTestExecutionCallbacks.evaluate(RunAfterTestExecutionCallbacks.java:84)
	at org.springframework.test.context.junit4.statements.RunBeforeTestMethodCallbacks.evaluate(RunBeforeTestMethodCallbacks.java:75)
	at org.springframework.test.context.junit4.statements.RunAfterTestMethodCallbacks.evaluate(RunAfterTestMethodCallbacks.java:86)
	at org.springframework.test.context.junit4.statements.SpringRepeat.evaluate(SpringRepeat.java:84)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:252)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:97)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.springframework.test.context.junit4.statements.RunBeforeTestClassCallbacks.evaluate(RunBeforeTestClassCallbacks.java:61)
	at org.springframework.test.context.junit4.statements.RunAfterTestClassCallbacks.evaluate(RunAfterTestClassCallbacks.java:70)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.run(SpringJUnit4ClassRunner.java:191)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at com.intellij.junit4.JUnit4IdeaTestRunner.startRunnerWithArgs(JUnit4IdeaTestRunner.java:69)
	at com.intellij.rt.junit.IdeaTestRunner$Repeater$1.execute(IdeaTestRunner.java:38)
	at com.intellij.rt.execution.junit.TestsRepeater.repeat(TestsRepeater.java:11)
	at com.intellij.rt.junit.IdeaTestRunner$Repeater.startRunnerWithArgs(IdeaTestRunner.java:35)
	at com.intellij.rt.junit.JUnitStarter.prepareStreamsAndStart(JUnitStarter.java:232)
	at com.intellij.rt.junit.JUnitStarter.main(JUnitStarter.java:55)
Caused by: java.net.SocketException: Socket closed
	at java.base/sun.nio.ch.NioSocketImpl.endRead(NioSocketImpl.java:253)
	at java.base/sun.nio.ch.NioSocketImpl.implRead(NioSocketImpl.java:332)
	at java.base/sun.nio.ch.NioSocketImpl.read(NioSocketImpl.java:355)
	at java.base/sun.nio.ch.NioSocketImpl$1.read(NioSocketImpl.java:808)
	at java.base/java.net.Socket$SocketInputStream.read(Socket.java:966)
	at okio.Okio$2.read(Okio.java:140)
	at okio.AsyncTimeout$2.read(AsyncTimeout.java:237)
	... 58 common frames omitted
25-03-14.19:59:44.484 [main            ] INFO  OrderService           - 创建支付订单成功, payOrder: PayOrderEntity{userId='null', orderId='875149116691', payUrl='<form name="punchout_form" method="post" action="https://openapi-sandbox.dl.alipaydev.com/gateway.do?charset=utf-8&method=alipay.trade.page.pay&sign=LoEc1pf2AqRnfpAeMaGSbTEvEeOyPM1ccJeWpbpz2qte7qhR79Y5bOndmfrJUQVSS21treJtpy8xmKZ8sV78dRcgXPQcBkr15DakVQaR2L8z6XCEIiiWvSraoDQHeu82PQuzAmvp8D7sFItApQJl%2BjhxZQ7x7gyRcttNCB9X92hDDQHKiVaqychpEJ6eCQHAVssO4b9rGVNizfgFd79umGbnIDegt5KBDqHrCwFGktOxDhQwGfLUK5KChYLnb6QRWPOFo47RriL%2BTj1XPqMheFA5l6VcI7M%2FtM2LTQgf%2FlUwR8TrI%2Fr20TRmXXK%2FFwopsDk%2FGtYrdVlKWcZnrX2%2FRQ%3D%3D&return_url=https%3A%2F%2Fgaga.plus&notify_url=http%3A%2F%2Feason.nat300.top%2Fapi%2Fv1%2Falipay%2Falipay_notify_url&version=1.0&app_id=9021000143682740&sign_type=RSA2&timestamp=2025-03-14+19%3A59%3A44&alipay_sdk=alipay-sdk-java-4.38.157.ALL&format=json">
<input type="hidden" name="biz_content" value="{&quot;out_trade_no&quot;:&quot;875149116691&quot;,&quot;total_amount&quot;:&quot;100.00&quot;,&quot;subject&quot;:&quot;《手写MyBatis：渐进式源码实践》&quot;,&quot;product_code&quot;:&quot;FAST_INSTANT_TRADE_PAY&quot;}">
<input type="submit" value="立即支付" style="display:none" >
</form>
<script>document.forms[0].submit();</script>', orderStatus=PAY_WAITE}
25-03-14.19:59:44.504 [main            ] INFO  OrderService           - 支付 URL: 
<form name="punchout_form" method="post" action="https://openapi-sandbox.dl.alipaydev.com/gateway.do?charset=utf-8&method=alipay.trade.page.pay&sign=LoEc1pf2AqRnfpAeMaGSbTEvEeOyPM1ccJeWpbpz2qte7qhR79Y5bOndmfrJUQVSS21treJtpy8xmKZ8sV78dRcgXPQcBkr15DakVQaR2L8z6XCEIiiWvSraoDQHeu82PQuzAmvp8D7sFItApQJl%2BjhxZQ7x7gyRcttNCB9X92hDDQHKiVaqychpEJ6eCQHAVssO4b9rGVNizfgFd79umGbnIDegt5KBDqHrCwFGktOxDhQwGfLUK5KChYLnb6QRWPOFo47RriL%2BTj1XPqMheFA5l6VcI7M%2FtM2LTQgf%2FlUwR8TrI%2Fr20TRmXXK%2FFwopsDk%2FGtYrdVlKWcZnrX2%2FRQ%3D%3D&return_url=https%3A%2F%2Fgaga.plus&notify_url=http%3A%2F%2Feason.nat300.top%2Fapi%2Fv1%2Falipay%2Falipay_notify_url&version=1.0&app_id=9021000143682740&sign_type=RSA2&timestamp=2025-03-14+19%3A59%3A44&alipay_sdk=alipay-sdk-java-4.38.157.ALL&format=json">
<input type="hidden" name="biz_content" value="{&quot;out_trade_no&quot;:&quot;875149116691&quot;,&quot;total_amount&quot;:&quot;100.00&quot;,&quot;subject&quot;:&quot;《手写MyBatis：渐进式源码实践》&quot;,&quot;product_code&quot;:&quot;FAST_INSTANT_TRADE_PAY&quot;}">
<input type="submit" value="立即支付" style="display:none" >
</form>
<script>document.forms[0].submit();</script>
25-03-14.19:59:44.504 [main            ] INFO  AbstractOrderService   - 创建订单-完成，生成支付单。userId: Eason4 orderId: 875149116691 payUrl: <form name="punchout_form" method="post" action="https://openapi-sandbox.dl.alipaydev.com/gateway.do?charset=utf-8&method=alipay.trade.page.pay&sign=LoEc1pf2AqRnfpAeMaGSbTEvEeOyPM1ccJeWpbpz2qte7qhR79Y5bOndmfrJUQVSS21treJtpy8xmKZ8sV78dRcgXPQcBkr15DakVQaR2L8z6XCEIiiWvSraoDQHeu82PQuzAmvp8D7sFItApQJl%2BjhxZQ7x7gyRcttNCB9X92hDDQHKiVaqychpEJ6eCQHAVssO4b9rGVNizfgFd79umGbnIDegt5KBDqHrCwFGktOxDhQwGfLUK5KChYLnb6QRWPOFo47RriL%2BTj1XPqMheFA5l6VcI7M%2FtM2LTQgf%2FlUwR8TrI%2Fr20TRmXXK%2FFwopsDk%2FGtYrdVlKWcZnrX2%2FRQ%3D%3D&return_url=https%3A%2F%2Fgaga.plus&notify_url=http%3A%2F%2Feason.nat300.top%2Fapi%2Fv1%2Falipay%2Falipay_notify_url&version=1.0&app_id=9021000143682740&sign_type=RSA2&timestamp=2025-03-14+19%3A59%3A44&alipay_sdk=alipay-sdk-java-4.38.157.ALL&format=json">
<input type="hidden" name="biz_content" value="{&quot;out_trade_no&quot;:&quot;875149116691&quot;,&quot;total_amount&quot;:&quot;100.00&quot;,&quot;subject&quot;:&quot;《手写MyBatis：渐进式源码实践》&quot;,&quot;product_code&quot;:&quot;FAST_INSTANT_TRADE_PAY&quot;}">
<input type="submit" value="立即支付" style="display:none" >
</form>
<script>document.forms[0].submit();</script> discount: null
25-03-14.19:59:44.516 [main            ] INFO  OrderServiceTest       - 请求参数:{"activityId":100123,"marketType":"拼团营销","productId":"9890001","userId":"Eason4"}
25-03-14.19:59:44.519 [main            ] INFO  OrderServiceTest       - 测试结果:{"deductionAmount":0,"marketType":"无营销","orderId":"875149116691","orderStatus":"等待支付－订单创建完成后，创建支付单","payAmount":100.00,"payUrl":"<form name=\"punchout_form\" method=\"post\" action=\"https://openapi-sandbox.dl.alipaydev.com/gateway.do?charset=utf-8&method=alipay.trade.page.pay&sign=LoEc1pf2AqRnfpAeMaGSbTEvEeOyPM1ccJeWpbpz2qte7qhR79Y5bOndmfrJUQVSS21treJtpy8xmKZ8sV78dRcgXPQcBkr15DakVQaR2L8z6XCEIiiWvSraoDQHeu82PQuzAmvp8D7sFItApQJl%2BjhxZQ7x7gyRcttNCB9X92hDDQHKiVaqychpEJ6eCQHAVssO4b9rGVNizfgFd79umGbnIDegt5KBDqHrCwFGktOxDhQwGfLUK5KChYLnb6QRWPOFo47RriL%2BTj1XPqMheFA5l6VcI7M%2FtM2LTQgf%2FlUwR8TrI%2Fr20TRmXXK%2FFwopsDk%2FGtYrdVlKWcZnrX2%2FRQ%3D%3D&return_url=https%3A%2F%2Fgaga.plus&notify_url=http%3A%2F%2Feason.nat300.top%2Fapi%2Fv1%2Falipay%2Falipay_notify_url&version=1.0&app_id=9021000143682740&sign_type=RSA2&timestamp=2025-03-14+19%3A59%3A44&alipay_sdk=alipay-sdk-java-4.38.157.ALL&format=json\">\n<input type=\"hidden\" name=\"biz_content\" value=\"{&quot;out_trade_no&quot;:&quot;875149116691&quot;,&quot;total_amount&quot;:&quot;100.00&quot;,&quot;subject&quot;:&quot;《手写MyBatis：渐进式源码实践》&quot;,&quot;product_code&quot;:&quot;FAST_INSTANT_TRADE_PAY&quot;}\">\n<input type=\"submit\" value=\"立即支付\" style=\"display:none\" >\n</form>\n<script>document.forms[0].submit();</script>","userId":"Eason4"}
25-03-14.19:59:44.529 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-03-14.19:59:44.553 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-03-14.19:59:44.558 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-1 - Shutdown initiated...
25-03-14.19:59:44.569 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-1 - Shutdown completed.
25-03-14.20:01:03.274 [main            ] INFO  OrderServiceTest       - Starting OrderServiceTest using Java 17.0.13 with PID 164104 (started by Eason in D:\Code\codes\s-pay-mall-ddd-eason\s-pay-mall-ddd-eason-app)
25-03-14.20:01:03.275 [main            ] INFO  OrderServiceTest       - The following 1 profile is active: "dev"
25-03-14.20:01:04.975 [main            ] INFO  OptionalValidatorFactoryBean - Failed to set up a Bean Validation provider: jakarta.validation.NoProviderFoundException: Unable to create a Configuration, because no Jakarta Bean Validation provider could be found. Add a provider like Hibernate Validator (RI) to your classpath.
25-03-14.20:01:05.401 [main            ] INFO  CachingConnectionFactory - Attempting to connect to: [192.168.226.128:5672]
25-03-14.20:01:05.471 [main            ] INFO  CachingConnectionFactory - Created new connection: rabbitConnectionFactory#49433c98:0/SimpleConnection@3739f3c9 [delegate=amqp://s-pay-mall@192.168.226.128:5672//s-pay-mall, localPort=59627]
25-03-14.20:01:05.565 [main            ] INFO  OrderServiceTest       - Started OrderServiceTest in 2.658 seconds (process running for 3.388)
25-03-14.20:01:06.253 [main            ] INFO  HikariDataSource       - HikariPool-1 - Starting...
25-03-14.20:01:06.436 [main            ] INFO  HikariPool             - HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@1d6a22dd
25-03-14.20:01:06.438 [main            ] INFO  HikariDataSource       - HikariPool-1 - Start completed.
25-03-14.20:01:06.781 [main            ] INFO  PayPort                - 拼团订单锁定, userId: Eason4, request: LockMarketPayOrderRequestDTO(userId=Eason4, teamId=null, activityId=100123, goodsId=9890001, source=s01, channel=c01, outerOrderId=436057880155, notifyUrl=http://127.0.0.1:8081/api/v1/alipay/group_buy_notify), response: Result(msg=用户 ID:Eason4 已经参加过 1 次活动, 活动 ID: 100123, 不可继续参加!, code=0, data=null)
25-03-14.20:01:06.802 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-03-14.20:01:07.566 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-03-14.20:01:07.571 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-1 - Shutdown initiated...
25-03-14.20:01:07.582 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-1 - Shutdown completed.
25-03-14.20:01:59.929 [main            ] INFO  OrderServiceTest       - Starting OrderServiceTest using Java 17.0.13 with PID 160044 (started by Eason in D:\Code\codes\s-pay-mall-ddd-eason\s-pay-mall-ddd-eason-app)
25-03-14.20:01:59.930 [main            ] INFO  OrderServiceTest       - The following 1 profile is active: "dev"
25-03-14.20:02:01.698 [main            ] INFO  OptionalValidatorFactoryBean - Failed to set up a Bean Validation provider: jakarta.validation.NoProviderFoundException: Unable to create a Configuration, because no Jakarta Bean Validation provider could be found. Add a provider like Hibernate Validator (RI) to your classpath.
25-03-14.20:02:02.065 [main            ] INFO  CachingConnectionFactory - Attempting to connect to: [192.168.226.128:5672]
25-03-14.20:02:02.127 [main            ] INFO  CachingConnectionFactory - Created new connection: rabbitConnectionFactory#2921199d:0/SimpleConnection@1410d645 [delegate=amqp://s-pay-mall@192.168.226.128:5672//s-pay-mall, localPort=55546]
25-03-14.20:02:02.194 [main            ] INFO  OrderServiceTest       - Started OrderServiceTest in 2.657 seconds (process running for 3.428)
25-03-14.20:02:02.792 [main            ] INFO  HikariDataSource       - HikariPool-1 - Starting...
25-03-14.20:02:02.948 [main            ] INFO  HikariPool             - HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@2ec156fb
25-03-14.20:02:02.950 [main            ] INFO  HikariDataSource       - HikariPool-1 - Start completed.
25-03-14.20:02:03.147 [main            ] INFO  PayPort                - 拼团订单锁定, userId: Eason4, request: LockMarketPayOrderRequestDTO(userId=Eason4, teamId=null, activityId=100123, goodsId=9890001, source=s01, channel=c01, outerOrderId=568824941595, notifyUrl=http://127.0.0.1:8081/api/v1/alipay/group_buy_notify), response: Result(msg=success, code=1, data=LockMarketPayOrderResponseDTO(orderId=950068294877, teamId=70632613, originalPrice=null, discountPrice=10.00, payPrice=90.00, tradeOrderStatus=0))
25-03-14.20:02:03.270 [main            ] INFO  OrderService           - 创建支付订单成功, payOrder: PayOrderEntity{userId='null', orderId='568824941595', payUrl='<form name="punchout_form" method="post" action="https://openapi-sandbox.dl.alipaydev.com/gateway.do?charset=utf-8&method=alipay.trade.page.pay&sign=CXr384Dxr85wbCSEcs8NHRMOuyLpuTgAw29Vpi1ViAkKPbVW2SNGJ81%2Bab5BYla1VVGHeOChDvGqOfP1VYdovxlJqcC7lOBgV33sC6qRtJk4eavBEK5%2BeoQFw%2BUqYShEfoPrvTF8U9hOnbaO7am96MKJjea2pMz35Hx17sp3ULVkQqg2twY7now1YRDHp7KRoOjkXpWaxDKyrPlnrr%2BLmYaJ4vZHPzjamBq2AC8SnrW8bIECwDgEmiSYNRThMT%2FheV1aR8vuhpcQEvB2Inl5HMdLe2YZtfb3ibIp0iawmpM2TL%2B7oIQisxAXA2gxewKk0%2Br%2FBrduWtDkLrAQcGm4Rw%3D%3D&return_url=https%3A%2F%2Fgaga.plus&notify_url=http%3A%2F%2Feason.nat300.top%2Fapi%2Fv1%2Falipay%2Falipay_notify_url&version=1.0&app_id=9021000143682740&sign_type=RSA2&timestamp=2025-03-14+20%3A02%3A03&alipay_sdk=alipay-sdk-java-4.38.157.ALL&format=json">
<input type="hidden" name="biz_content" value="{&quot;out_trade_no&quot;:&quot;568824941595&quot;,&quot;total_amount&quot;:&quot;100.00&quot;,&quot;subject&quot;:&quot;《手写MyBatis：渐进式源码实践》&quot;,&quot;product_code&quot;:&quot;FAST_INSTANT_TRADE_PAY&quot;}">
<input type="submit" value="立即支付" style="display:none" >
</form>
<script>document.forms[0].submit();</script>', orderStatus=PAY_WAITE}
25-03-14.20:02:03.295 [main            ] INFO  OrderService           - 支付 URL: 
<form name="punchout_form" method="post" action="https://openapi-sandbox.dl.alipaydev.com/gateway.do?charset=utf-8&method=alipay.trade.page.pay&sign=CXr384Dxr85wbCSEcs8NHRMOuyLpuTgAw29Vpi1ViAkKPbVW2SNGJ81%2Bab5BYla1VVGHeOChDvGqOfP1VYdovxlJqcC7lOBgV33sC6qRtJk4eavBEK5%2BeoQFw%2BUqYShEfoPrvTF8U9hOnbaO7am96MKJjea2pMz35Hx17sp3ULVkQqg2twY7now1YRDHp7KRoOjkXpWaxDKyrPlnrr%2BLmYaJ4vZHPzjamBq2AC8SnrW8bIECwDgEmiSYNRThMT%2FheV1aR8vuhpcQEvB2Inl5HMdLe2YZtfb3ibIp0iawmpM2TL%2B7oIQisxAXA2gxewKk0%2Br%2FBrduWtDkLrAQcGm4Rw%3D%3D&return_url=https%3A%2F%2Fgaga.plus&notify_url=http%3A%2F%2Feason.nat300.top%2Fapi%2Fv1%2Falipay%2Falipay_notify_url&version=1.0&app_id=9021000143682740&sign_type=RSA2&timestamp=2025-03-14+20%3A02%3A03&alipay_sdk=alipay-sdk-java-4.38.157.ALL&format=json">
<input type="hidden" name="biz_content" value="{&quot;out_trade_no&quot;:&quot;568824941595&quot;,&quot;total_amount&quot;:&quot;100.00&quot;,&quot;subject&quot;:&quot;《手写MyBatis：渐进式源码实践》&quot;,&quot;product_code&quot;:&quot;FAST_INSTANT_TRADE_PAY&quot;}">
<input type="submit" value="立即支付" style="display:none" >
</form>
<script>document.forms[0].submit();</script>
25-03-14.20:02:03.295 [main            ] INFO  AbstractOrderService   - 创建订单-完成，生成支付单。userId: Eason4 orderId: 568824941595 payUrl: <form name="punchout_form" method="post" action="https://openapi-sandbox.dl.alipaydev.com/gateway.do?charset=utf-8&method=alipay.trade.page.pay&sign=CXr384Dxr85wbCSEcs8NHRMOuyLpuTgAw29Vpi1ViAkKPbVW2SNGJ81%2Bab5BYla1VVGHeOChDvGqOfP1VYdovxlJqcC7lOBgV33sC6qRtJk4eavBEK5%2BeoQFw%2BUqYShEfoPrvTF8U9hOnbaO7am96MKJjea2pMz35Hx17sp3ULVkQqg2twY7now1YRDHp7KRoOjkXpWaxDKyrPlnrr%2BLmYaJ4vZHPzjamBq2AC8SnrW8bIECwDgEmiSYNRThMT%2FheV1aR8vuhpcQEvB2Inl5HMdLe2YZtfb3ibIp0iawmpM2TL%2B7oIQisxAXA2gxewKk0%2Br%2FBrduWtDkLrAQcGm4Rw%3D%3D&return_url=https%3A%2F%2Fgaga.plus&notify_url=http%3A%2F%2Feason.nat300.top%2Fapi%2Fv1%2Falipay%2Falipay_notify_url&version=1.0&app_id=9021000143682740&sign_type=RSA2&timestamp=2025-03-14+20%3A02%3A03&alipay_sdk=alipay-sdk-java-4.38.157.ALL&format=json">
<input type="hidden" name="biz_content" value="{&quot;out_trade_no&quot;:&quot;568824941595&quot;,&quot;total_amount&quot;:&quot;100.00&quot;,&quot;subject&quot;:&quot;《手写MyBatis：渐进式源码实践》&quot;,&quot;product_code&quot;:&quot;FAST_INSTANT_TRADE_PAY&quot;}">
<input type="submit" value="立即支付" style="display:none" >
</form>
<script>document.forms[0].submit();</script> discount: MarketPayDiscountEntity(originalAmount=null, deductionAmount=10.00, payAmount=90.00)
25-03-14.20:02:03.310 [main            ] INFO  OrderServiceTest       - 请求参数:{"activityId":100123,"marketType":"拼团营销","productId":"9890001","userId":"Eason4"}
25-03-14.20:02:03.313 [main            ] INFO  OrderServiceTest       - 测试结果:{"deductionAmount":10.00,"marketType":"拼团营销","orderId":"568824941595","orderStatus":"等待支付－订单创建完成后，创建支付单","payAmount":90.00,"payUrl":"<form name=\"punchout_form\" method=\"post\" action=\"https://openapi-sandbox.dl.alipaydev.com/gateway.do?charset=utf-8&method=alipay.trade.page.pay&sign=CXr384Dxr85wbCSEcs8NHRMOuyLpuTgAw29Vpi1ViAkKPbVW2SNGJ81%2Bab5BYla1VVGHeOChDvGqOfP1VYdovxlJqcC7lOBgV33sC6qRtJk4eavBEK5%2BeoQFw%2BUqYShEfoPrvTF8U9hOnbaO7am96MKJjea2pMz35Hx17sp3ULVkQqg2twY7now1YRDHp7KRoOjkXpWaxDKyrPlnrr%2BLmYaJ4vZHPzjamBq2AC8SnrW8bIECwDgEmiSYNRThMT%2FheV1aR8vuhpcQEvB2Inl5HMdLe2YZtfb3ibIp0iawmpM2TL%2B7oIQisxAXA2gxewKk0%2Br%2FBrduWtDkLrAQcGm4Rw%3D%3D&return_url=https%3A%2F%2Fgaga.plus&notify_url=http%3A%2F%2Feason.nat300.top%2Fapi%2Fv1%2Falipay%2Falipay_notify_url&version=1.0&app_id=9021000143682740&sign_type=RSA2&timestamp=2025-03-14+20%3A02%3A03&alipay_sdk=alipay-sdk-java-4.38.157.ALL&format=json\">\n<input type=\"hidden\" name=\"biz_content\" value=\"{&quot;out_trade_no&quot;:&quot;568824941595&quot;,&quot;total_amount&quot;:&quot;100.00&quot;,&quot;subject&quot;:&quot;《手写MyBatis：渐进式源码实践》&quot;,&quot;product_code&quot;:&quot;FAST_INSTANT_TRADE_PAY&quot;}\">\n<input type=\"submit\" value=\"立即支付\" style=\"display:none\" >\n</form>\n<script>document.forms[0].submit();</script>","userId":"Eason4"}
25-03-14.20:02:03.329 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-03-14.20:02:04.196 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-03-14.20:02:04.201 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-1 - Shutdown initiated...
25-03-14.20:02:04.211 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-1 - Shutdown completed.
25-03-14.20:06:30.515 [main            ] INFO  OrderServiceTest       - Starting OrderServiceTest using Java 17.0.13 with PID 117788 (started by Eason in D:\Code\codes\s-pay-mall-ddd-eason\s-pay-mall-ddd-eason-app)
25-03-14.20:06:30.517 [main            ] INFO  OrderServiceTest       - The following 1 profile is active: "dev"
25-03-14.20:06:32.254 [main            ] INFO  OptionalValidatorFactoryBean - Failed to set up a Bean Validation provider: jakarta.validation.NoProviderFoundException: Unable to create a Configuration, because no Jakarta Bean Validation provider could be found. Add a provider like Hibernate Validator (RI) to your classpath.
25-03-14.20:06:32.628 [main            ] INFO  CachingConnectionFactory - Attempting to connect to: [192.168.226.128:5672]
25-03-14.20:06:32.697 [main            ] INFO  CachingConnectionFactory - Created new connection: rabbitConnectionFactory#4538856f:0/SimpleConnection@7df4709e [delegate=amqp://s-pay-mall@192.168.226.128:5672//s-pay-mall, localPort=52664]
25-03-14.20:06:32.787 [main            ] INFO  OrderServiceTest       - Started OrderServiceTest in 2.668 seconds (process running for 3.398)
25-03-14.20:06:33.473 [main            ] INFO  HikariDataSource       - HikariPool-1 - Starting...
25-03-14.20:06:33.661 [main            ] INFO  HikariPool             - HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@7978550b
25-03-14.20:06:33.663 [main            ] INFO  HikariDataSource       - HikariPool-1 - Start completed.
25-03-14.20:06:43.811 [main            ] ERROR PayPort                - 营销锁单失败 userId: Eason4, orderItemId: 291965078214
java.net.SocketTimeoutException: timeout
	at okio.Okio$4.newTimeoutException(Okio.java:232)
	at okio.AsyncTimeout.exit(AsyncTimeout.java:286)
	at okio.AsyncTimeout$2.read(AsyncTimeout.java:241)
	at okio.RealBufferedSource.indexOf(RealBufferedSource.java:358)
	at okio.RealBufferedSource.readUtf8LineStrict(RealBufferedSource.java:230)
	at okhttp3.internal.http1.Http1ExchangeCodec.readHeaderLine(Http1ExchangeCodec.java:242)
	at okhttp3.internal.http1.Http1ExchangeCodec.readResponseHeaders(Http1ExchangeCodec.java:213)
	at okhttp3.internal.connection.Exchange.readResponseHeaders(Exchange.java:115)
	at okhttp3.internal.http.CallServerInterceptor.intercept(CallServerInterceptor.java:94)
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.java:142)
	at okhttp3.internal.connection.ConnectInterceptor.intercept(ConnectInterceptor.java:43)
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.java:142)
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.java:117)
	at okhttp3.internal.cache.CacheInterceptor.intercept(CacheInterceptor.java:94)
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.java:142)
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.java:117)
	at okhttp3.internal.http.BridgeInterceptor.intercept(BridgeInterceptor.java:93)
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.java:142)
	at okhttp3.internal.http.RetryAndFollowUpInterceptor.intercept(RetryAndFollowUpInterceptor.java:88)
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.java:142)
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.java:117)
	at okhttp3.RealCall.getResponseWithInterceptorChain(RealCall.java:229)
	at okhttp3.RealCall.execute(RealCall.java:81)
	at retrofit2.OkHttpCall.execute(OkHttpCall.java:204)
	at xin.eason.infrastructure.adapter.port.PayPort.lockMarketOrder(PayPort.java:118)
	at xin.eason.domain.order.service.OrderService.lockMarketOrder(OrderService.java:70)
	at xin.eason.domain.order.service.AbstractOrderService.createOrder(AbstractOrderService.java:89)
	at xin.eason.test.OrderServiceTest.test_createOrder(OrderServiceTest.java:32)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.springframework.test.context.junit4.statements.RunBeforeTestExecutionCallbacks.evaluate(RunBeforeTestExecutionCallbacks.java:76)
	at org.springframework.test.context.junit4.statements.RunAfterTestExecutionCallbacks.evaluate(RunAfterTestExecutionCallbacks.java:84)
	at org.springframework.test.context.junit4.statements.RunBeforeTestMethodCallbacks.evaluate(RunBeforeTestMethodCallbacks.java:75)
	at org.springframework.test.context.junit4.statements.RunAfterTestMethodCallbacks.evaluate(RunAfterTestMethodCallbacks.java:86)
	at org.springframework.test.context.junit4.statements.SpringRepeat.evaluate(SpringRepeat.java:84)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:252)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:97)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.springframework.test.context.junit4.statements.RunBeforeTestClassCallbacks.evaluate(RunBeforeTestClassCallbacks.java:61)
	at org.springframework.test.context.junit4.statements.RunAfterTestClassCallbacks.evaluate(RunAfterTestClassCallbacks.java:70)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.run(SpringJUnit4ClassRunner.java:191)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at com.intellij.junit4.JUnit4IdeaTestRunner.startRunnerWithArgs(JUnit4IdeaTestRunner.java:69)
	at com.intellij.rt.junit.IdeaTestRunner$Repeater$1.execute(IdeaTestRunner.java:38)
	at com.intellij.rt.execution.junit.TestsRepeater.repeat(TestsRepeater.java:11)
	at com.intellij.rt.junit.IdeaTestRunner$Repeater.startRunnerWithArgs(IdeaTestRunner.java:35)
	at com.intellij.rt.junit.JUnitStarter.prepareStreamsAndStart(JUnitStarter.java:232)
	at com.intellij.rt.junit.JUnitStarter.main(JUnitStarter.java:55)
Caused by: java.net.SocketTimeoutException: Read timed out
	at java.base/sun.nio.ch.NioSocketImpl.timedRead(NioSocketImpl.java:288)
	at java.base/sun.nio.ch.NioSocketImpl.implRead(NioSocketImpl.java:314)
	at java.base/sun.nio.ch.NioSocketImpl.read(NioSocketImpl.java:355)
	at java.base/sun.nio.ch.NioSocketImpl$1.read(NioSocketImpl.java:808)
	at java.base/java.net.Socket$SocketInputStream.read(Socket.java:966)
	at okio.Okio$2.read(Okio.java:140)
	at okio.AsyncTimeout$2.read(AsyncTimeout.java:237)
	... 58 common frames omitted
25-03-14.20:06:43.907 [main            ] INFO  OrderService           - 创建支付订单成功, payOrder: PayOrderEntity{userId='null', orderId='291965078214', payUrl='<form name="punchout_form" method="post" action="https://openapi-sandbox.dl.alipaydev.com/gateway.do?charset=utf-8&method=alipay.trade.page.pay&sign=WCcFLvLbfjMr0Azp8wtQ6lkC36w8NFrteYQUFdjbTR5TIhKoG5Xeevzs2cWVQUzylSNxGj6wXd6w2eG7yH1QQ8uhVqUs7p3MCYr02cWhpTYMnEZPhKPl42oUzVDBcevY5pGiRcX7yjBUk8YsnarOwsrA66uoDJDaIBRzz0PRRpLnuywXyICFEjpEUJE%2FfFY4ADUljrFrf%2B62ttrDclE0ITQ2tV%2FYRc0XUyLhfd2aPuhFYHurR2Is0zq3SD3rC4y6zh3W5qokP4HODZIokL%2BaWVq06tu4sVBFjiWb92xJCK0B8AfZq1VSYi1dHW35TUJnRWvBvp5EOS3p4EYo1LK7ow%3D%3D&return_url=https%3A%2F%2Fgaga.plus&notify_url=http%3A%2F%2Feason.nat300.top%2Fapi%2Fv1%2Falipay%2Falipay_notify_url&version=1.0&app_id=9021000143682740&sign_type=RSA2&timestamp=2025-03-14+20%3A06%3A43&alipay_sdk=alipay-sdk-java-4.38.157.ALL&format=json">
<input type="hidden" name="biz_content" value="{&quot;out_trade_no&quot;:&quot;291965078214&quot;,&quot;total_amount&quot;:&quot;100.00&quot;,&quot;subject&quot;:&quot;《手写MyBatis：渐进式源码实践》&quot;,&quot;product_code&quot;:&quot;FAST_INSTANT_TRADE_PAY&quot;}">
<input type="submit" value="立即支付" style="display:none" >
</form>
<script>document.forms[0].submit();</script>', orderStatus=PAY_WAITE}
25-03-14.20:06:43.928 [main            ] INFO  OrderService           - 支付 URL: 
<form name="punchout_form" method="post" action="https://openapi-sandbox.dl.alipaydev.com/gateway.do?charset=utf-8&method=alipay.trade.page.pay&sign=WCcFLvLbfjMr0Azp8wtQ6lkC36w8NFrteYQUFdjbTR5TIhKoG5Xeevzs2cWVQUzylSNxGj6wXd6w2eG7yH1QQ8uhVqUs7p3MCYr02cWhpTYMnEZPhKPl42oUzVDBcevY5pGiRcX7yjBUk8YsnarOwsrA66uoDJDaIBRzz0PRRpLnuywXyICFEjpEUJE%2FfFY4ADUljrFrf%2B62ttrDclE0ITQ2tV%2FYRc0XUyLhfd2aPuhFYHurR2Is0zq3SD3rC4y6zh3W5qokP4HODZIokL%2BaWVq06tu4sVBFjiWb92xJCK0B8AfZq1VSYi1dHW35TUJnRWvBvp5EOS3p4EYo1LK7ow%3D%3D&return_url=https%3A%2F%2Fgaga.plus&notify_url=http%3A%2F%2Feason.nat300.top%2Fapi%2Fv1%2Falipay%2Falipay_notify_url&version=1.0&app_id=9021000143682740&sign_type=RSA2&timestamp=2025-03-14+20%3A06%3A43&alipay_sdk=alipay-sdk-java-4.38.157.ALL&format=json">
<input type="hidden" name="biz_content" value="{&quot;out_trade_no&quot;:&quot;291965078214&quot;,&quot;total_amount&quot;:&quot;100.00&quot;,&quot;subject&quot;:&quot;《手写MyBatis：渐进式源码实践》&quot;,&quot;product_code&quot;:&quot;FAST_INSTANT_TRADE_PAY&quot;}">
<input type="submit" value="立即支付" style="display:none" >
</form>
<script>document.forms[0].submit();</script>
25-03-14.20:06:43.928 [main            ] INFO  AbstractOrderService   - 创建订单-完成，生成支付单。userId: Eason4 orderId: 291965078214 payUrl: <form name="punchout_form" method="post" action="https://openapi-sandbox.dl.alipaydev.com/gateway.do?charset=utf-8&method=alipay.trade.page.pay&sign=WCcFLvLbfjMr0Azp8wtQ6lkC36w8NFrteYQUFdjbTR5TIhKoG5Xeevzs2cWVQUzylSNxGj6wXd6w2eG7yH1QQ8uhVqUs7p3MCYr02cWhpTYMnEZPhKPl42oUzVDBcevY5pGiRcX7yjBUk8YsnarOwsrA66uoDJDaIBRzz0PRRpLnuywXyICFEjpEUJE%2FfFY4ADUljrFrf%2B62ttrDclE0ITQ2tV%2FYRc0XUyLhfd2aPuhFYHurR2Is0zq3SD3rC4y6zh3W5qokP4HODZIokL%2BaWVq06tu4sVBFjiWb92xJCK0B8AfZq1VSYi1dHW35TUJnRWvBvp5EOS3p4EYo1LK7ow%3D%3D&return_url=https%3A%2F%2Fgaga.plus&notify_url=http%3A%2F%2Feason.nat300.top%2Fapi%2Fv1%2Falipay%2Falipay_notify_url&version=1.0&app_id=9021000143682740&sign_type=RSA2&timestamp=2025-03-14+20%3A06%3A43&alipay_sdk=alipay-sdk-java-4.38.157.ALL&format=json">
<input type="hidden" name="biz_content" value="{&quot;out_trade_no&quot;:&quot;291965078214&quot;,&quot;total_amount&quot;:&quot;100.00&quot;,&quot;subject&quot;:&quot;《手写MyBatis：渐进式源码实践》&quot;,&quot;product_code&quot;:&quot;FAST_INSTANT_TRADE_PAY&quot;}">
<input type="submit" value="立即支付" style="display:none" >
</form>
<script>document.forms[0].submit();</script> discount: null
25-03-14.20:06:43.941 [main            ] INFO  OrderServiceTest       - 请求参数:{"activityId":100123,"marketType":"拼团营销","productId":"9890001","userId":"Eason4"}
25-03-14.20:06:43.943 [main            ] INFO  OrderServiceTest       - 测试结果:{"deductionAmount":0,"marketType":"无营销","orderId":"291965078214","orderStatus":"等待支付－订单创建完成后，创建支付单","payAmount":100.00,"payUrl":"<form name=\"punchout_form\" method=\"post\" action=\"https://openapi-sandbox.dl.alipaydev.com/gateway.do?charset=utf-8&method=alipay.trade.page.pay&sign=WCcFLvLbfjMr0Azp8wtQ6lkC36w8NFrteYQUFdjbTR5TIhKoG5Xeevzs2cWVQUzylSNxGj6wXd6w2eG7yH1QQ8uhVqUs7p3MCYr02cWhpTYMnEZPhKPl42oUzVDBcevY5pGiRcX7yjBUk8YsnarOwsrA66uoDJDaIBRzz0PRRpLnuywXyICFEjpEUJE%2FfFY4ADUljrFrf%2B62ttrDclE0ITQ2tV%2FYRc0XUyLhfd2aPuhFYHurR2Is0zq3SD3rC4y6zh3W5qokP4HODZIokL%2BaWVq06tu4sVBFjiWb92xJCK0B8AfZq1VSYi1dHW35TUJnRWvBvp5EOS3p4EYo1LK7ow%3D%3D&return_url=https%3A%2F%2Fgaga.plus&notify_url=http%3A%2F%2Feason.nat300.top%2Fapi%2Fv1%2Falipay%2Falipay_notify_url&version=1.0&app_id=9021000143682740&sign_type=RSA2&timestamp=2025-03-14+20%3A06%3A43&alipay_sdk=alipay-sdk-java-4.38.157.ALL&format=json\">\n<input type=\"hidden\" name=\"biz_content\" value=\"{&quot;out_trade_no&quot;:&quot;291965078214&quot;,&quot;total_amount&quot;:&quot;100.00&quot;,&quot;subject&quot;:&quot;《手写MyBatis：渐进式源码实践》&quot;,&quot;product_code&quot;:&quot;FAST_INSTANT_TRADE_PAY&quot;}\">\n<input type=\"submit\" value=\"立即支付\" style=\"display:none\" >\n</form>\n<script>document.forms[0].submit();</script>","userId":"Eason4"}
25-03-14.20:06:43.958 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-03-14.20:06:44.862 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-03-14.20:06:44.868 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-1 - Shutdown initiated...
25-03-14.20:06:44.882 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-1 - Shutdown completed.
25-03-14.20:07:42.236 [main            ] INFO  OrderServiceTest       - Starting OrderServiceTest using Java 17.0.13 with PID 130504 (started by Eason in D:\Code\codes\s-pay-mall-ddd-eason\s-pay-mall-ddd-eason-app)
25-03-14.20:07:42.237 [main            ] INFO  OrderServiceTest       - The following 1 profile is active: "dev"
25-03-14.20:07:43.894 [main            ] INFO  OptionalValidatorFactoryBean - Failed to set up a Bean Validation provider: jakarta.validation.NoProviderFoundException: Unable to create a Configuration, because no Jakarta Bean Validation provider could be found. Add a provider like Hibernate Validator (RI) to your classpath.
25-03-14.20:07:44.253 [main            ] INFO  CachingConnectionFactory - Attempting to connect to: [192.168.226.128:5672]
25-03-14.20:07:44.320 [main            ] INFO  CachingConnectionFactory - Created new connection: rabbitConnectionFactory#4538856f:0/SimpleConnection@7df4709e [delegate=amqp://s-pay-mall@192.168.226.128:5672//s-pay-mall, localPort=52877]
25-03-14.20:07:44.393 [main            ] INFO  OrderServiceTest       - Started OrderServiceTest in 2.544 seconds (process running for 3.29)
25-03-14.20:07:45.152 [main            ] INFO  HikariDataSource       - HikariPool-1 - Starting...
25-03-14.20:07:45.338 [main            ] INFO  HikariPool             - HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@7978550b
25-03-14.20:07:45.340 [main            ] INFO  HikariDataSource       - HikariPool-1 - Start completed.
25-03-14.20:07:55.462 [main            ] ERROR PayPort                - 营销锁单失败 userId: Eason4, orderItemId: 049855618183
java.net.SocketTimeoutException: timeout
	at okio.Okio$4.newTimeoutException(Okio.java:232)
	at okio.AsyncTimeout.exit(AsyncTimeout.java:286)
	at okio.AsyncTimeout$2.read(AsyncTimeout.java:241)
	at okio.RealBufferedSource.indexOf(RealBufferedSource.java:358)
	at okio.RealBufferedSource.readUtf8LineStrict(RealBufferedSource.java:230)
	at okhttp3.internal.http1.Http1ExchangeCodec.readHeaderLine(Http1ExchangeCodec.java:242)
	at okhttp3.internal.http1.Http1ExchangeCodec.readResponseHeaders(Http1ExchangeCodec.java:213)
	at okhttp3.internal.connection.Exchange.readResponseHeaders(Exchange.java:115)
	at okhttp3.internal.http.CallServerInterceptor.intercept(CallServerInterceptor.java:94)
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.java:142)
	at okhttp3.internal.connection.ConnectInterceptor.intercept(ConnectInterceptor.java:43)
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.java:142)
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.java:117)
	at okhttp3.internal.cache.CacheInterceptor.intercept(CacheInterceptor.java:94)
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.java:142)
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.java:117)
	at okhttp3.internal.http.BridgeInterceptor.intercept(BridgeInterceptor.java:93)
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.java:142)
	at okhttp3.internal.http.RetryAndFollowUpInterceptor.intercept(RetryAndFollowUpInterceptor.java:88)
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.java:142)
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.java:117)
	at okhttp3.RealCall.getResponseWithInterceptorChain(RealCall.java:229)
	at okhttp3.RealCall.execute(RealCall.java:81)
	at retrofit2.OkHttpCall.execute(OkHttpCall.java:204)
	at xin.eason.infrastructure.adapter.port.PayPort.lockMarketOrder(PayPort.java:118)
	at xin.eason.domain.order.service.OrderService.lockMarketOrder(OrderService.java:70)
	at xin.eason.domain.order.service.AbstractOrderService.createOrder(AbstractOrderService.java:89)
	at xin.eason.test.OrderServiceTest.test_createOrder(OrderServiceTest.java:32)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.springframework.test.context.junit4.statements.RunBeforeTestExecutionCallbacks.evaluate(RunBeforeTestExecutionCallbacks.java:76)
	at org.springframework.test.context.junit4.statements.RunAfterTestExecutionCallbacks.evaluate(RunAfterTestExecutionCallbacks.java:84)
	at org.springframework.test.context.junit4.statements.RunBeforeTestMethodCallbacks.evaluate(RunBeforeTestMethodCallbacks.java:75)
	at org.springframework.test.context.junit4.statements.RunAfterTestMethodCallbacks.evaluate(RunAfterTestMethodCallbacks.java:86)
	at org.springframework.test.context.junit4.statements.SpringRepeat.evaluate(SpringRepeat.java:84)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:252)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:97)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.springframework.test.context.junit4.statements.RunBeforeTestClassCallbacks.evaluate(RunBeforeTestClassCallbacks.java:61)
	at org.springframework.test.context.junit4.statements.RunAfterTestClassCallbacks.evaluate(RunAfterTestClassCallbacks.java:70)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.run(SpringJUnit4ClassRunner.java:191)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at com.intellij.junit4.JUnit4IdeaTestRunner.startRunnerWithArgs(JUnit4IdeaTestRunner.java:69)
	at com.intellij.rt.junit.IdeaTestRunner$Repeater$1.execute(IdeaTestRunner.java:38)
	at com.intellij.rt.execution.junit.TestsRepeater.repeat(TestsRepeater.java:11)
	at com.intellij.rt.junit.IdeaTestRunner$Repeater.startRunnerWithArgs(IdeaTestRunner.java:35)
	at com.intellij.rt.junit.JUnitStarter.prepareStreamsAndStart(JUnitStarter.java:232)
	at com.intellij.rt.junit.JUnitStarter.main(JUnitStarter.java:55)
Caused by: java.net.SocketException: Socket closed
	at java.base/sun.nio.ch.NioSocketImpl.endRead(NioSocketImpl.java:253)
	at java.base/sun.nio.ch.NioSocketImpl.implRead(NioSocketImpl.java:332)
	at java.base/sun.nio.ch.NioSocketImpl.read(NioSocketImpl.java:355)
	at java.base/sun.nio.ch.NioSocketImpl$1.read(NioSocketImpl.java:808)
	at java.base/java.net.Socket$SocketInputStream.read(Socket.java:966)
	at okio.Okio$2.read(Okio.java:140)
	at okio.AsyncTimeout$2.read(AsyncTimeout.java:237)
	... 58 common frames omitted
25-03-14.20:07:55.563 [main            ] INFO  OrderService           - 创建支付订单成功, payOrder: PayOrderEntity{userId='null', orderId='049855618183', payUrl='<form name="punchout_form" method="post" action="https://openapi-sandbox.dl.alipaydev.com/gateway.do?charset=utf-8&method=alipay.trade.page.pay&sign=aZMZcrlY6CiPT41Ab%2FhxhzqZrxI1V90wTSELQHBG%2BMXmQUGebuTuacdR4Vo2ym8YXs1vWFwGb1X8yYcZ%2FPaWy6Wm4rfZjuJKfU2u9LUpscu0pkCgnXdcpUtOio2gjwmlNu5kgq26XSF%2FxzlpqAj7KA2yk8ywGBOTDP6u2VBKuh0A4g8BnLV2zziD0o9%2FzZCJpD57HRQUaIqpAjKku8tP0tNMsjKF3ZB4F%2BMz%2FMV7kRUj1VbZnFyM7a3ctGGPCfG40kYv8mRlP5JCVWbpEP1ehYIimSBrtc6yGU%2Fvdbe8fu01IZv9fX1jkZz%2F9nKmTeP4coSq8CPOqJsP7u1dO%2BsgNA%3D%3D&return_url=https%3A%2F%2Fgaga.plus&notify_url=http%3A%2F%2Feason.nat300.top%2Fapi%2Fv1%2Falipay%2Falipay_notify_url&version=1.0&app_id=9021000143682740&sign_type=RSA2&timestamp=2025-03-14+20%3A07%3A55&alipay_sdk=alipay-sdk-java-4.38.157.ALL&format=json">
<input type="hidden" name="biz_content" value="{&quot;out_trade_no&quot;:&quot;049855618183&quot;,&quot;total_amount&quot;:&quot;100.00&quot;,&quot;subject&quot;:&quot;《手写MyBatis：渐进式源码实践》&quot;,&quot;product_code&quot;:&quot;FAST_INSTANT_TRADE_PAY&quot;}">
<input type="submit" value="立即支付" style="display:none" >
</form>
<script>document.forms[0].submit();</script>', orderStatus=PAY_WAITE}
25-03-14.20:07:55.581 [main            ] INFO  OrderService           - 支付 URL: 
<form name="punchout_form" method="post" action="https://openapi-sandbox.dl.alipaydev.com/gateway.do?charset=utf-8&method=alipay.trade.page.pay&sign=aZMZcrlY6CiPT41Ab%2FhxhzqZrxI1V90wTSELQHBG%2BMXmQUGebuTuacdR4Vo2ym8YXs1vWFwGb1X8yYcZ%2FPaWy6Wm4rfZjuJKfU2u9LUpscu0pkCgnXdcpUtOio2gjwmlNu5kgq26XSF%2FxzlpqAj7KA2yk8ywGBOTDP6u2VBKuh0A4g8BnLV2zziD0o9%2FzZCJpD57HRQUaIqpAjKku8tP0tNMsjKF3ZB4F%2BMz%2FMV7kRUj1VbZnFyM7a3ctGGPCfG40kYv8mRlP5JCVWbpEP1ehYIimSBrtc6yGU%2Fvdbe8fu01IZv9fX1jkZz%2F9nKmTeP4coSq8CPOqJsP7u1dO%2BsgNA%3D%3D&return_url=https%3A%2F%2Fgaga.plus&notify_url=http%3A%2F%2Feason.nat300.top%2Fapi%2Fv1%2Falipay%2Falipay_notify_url&version=1.0&app_id=9021000143682740&sign_type=RSA2&timestamp=2025-03-14+20%3A07%3A55&alipay_sdk=alipay-sdk-java-4.38.157.ALL&format=json">
<input type="hidden" name="biz_content" value="{&quot;out_trade_no&quot;:&quot;049855618183&quot;,&quot;total_amount&quot;:&quot;100.00&quot;,&quot;subject&quot;:&quot;《手写MyBatis：渐进式源码实践》&quot;,&quot;product_code&quot;:&quot;FAST_INSTANT_TRADE_PAY&quot;}">
<input type="submit" value="立即支付" style="display:none" >
</form>
<script>document.forms[0].submit();</script>
25-03-14.20:07:55.581 [main            ] INFO  AbstractOrderService   - 创建订单-完成，生成支付单。userId: Eason4 orderId: 049855618183 payUrl: <form name="punchout_form" method="post" action="https://openapi-sandbox.dl.alipaydev.com/gateway.do?charset=utf-8&method=alipay.trade.page.pay&sign=aZMZcrlY6CiPT41Ab%2FhxhzqZrxI1V90wTSELQHBG%2BMXmQUGebuTuacdR4Vo2ym8YXs1vWFwGb1X8yYcZ%2FPaWy6Wm4rfZjuJKfU2u9LUpscu0pkCgnXdcpUtOio2gjwmlNu5kgq26XSF%2FxzlpqAj7KA2yk8ywGBOTDP6u2VBKuh0A4g8BnLV2zziD0o9%2FzZCJpD57HRQUaIqpAjKku8tP0tNMsjKF3ZB4F%2BMz%2FMV7kRUj1VbZnFyM7a3ctGGPCfG40kYv8mRlP5JCVWbpEP1ehYIimSBrtc6yGU%2Fvdbe8fu01IZv9fX1jkZz%2F9nKmTeP4coSq8CPOqJsP7u1dO%2BsgNA%3D%3D&return_url=https%3A%2F%2Fgaga.plus&notify_url=http%3A%2F%2Feason.nat300.top%2Fapi%2Fv1%2Falipay%2Falipay_notify_url&version=1.0&app_id=9021000143682740&sign_type=RSA2&timestamp=2025-03-14+20%3A07%3A55&alipay_sdk=alipay-sdk-java-4.38.157.ALL&format=json">
<input type="hidden" name="biz_content" value="{&quot;out_trade_no&quot;:&quot;049855618183&quot;,&quot;total_amount&quot;:&quot;100.00&quot;,&quot;subject&quot;:&quot;《手写MyBatis：渐进式源码实践》&quot;,&quot;product_code&quot;:&quot;FAST_INSTANT_TRADE_PAY&quot;}">
<input type="submit" value="立即支付" style="display:none" >
</form>
<script>document.forms[0].submit();</script> discount: null
25-03-14.20:07:55.591 [main            ] INFO  OrderServiceTest       - 请求参数:{"activityId":100123,"marketType":"拼团营销","productId":"9890001","userId":"Eason4"}
25-03-14.20:07:55.594 [main            ] INFO  OrderServiceTest       - 测试结果:{"deductionAmount":0,"marketType":"无营销","orderId":"049855618183","orderStatus":"等待支付－订单创建完成后，创建支付单","payAmount":100.00,"payUrl":"<form name=\"punchout_form\" method=\"post\" action=\"https://openapi-sandbox.dl.alipaydev.com/gateway.do?charset=utf-8&method=alipay.trade.page.pay&sign=aZMZcrlY6CiPT41Ab%2FhxhzqZrxI1V90wTSELQHBG%2BMXmQUGebuTuacdR4Vo2ym8YXs1vWFwGb1X8yYcZ%2FPaWy6Wm4rfZjuJKfU2u9LUpscu0pkCgnXdcpUtOio2gjwmlNu5kgq26XSF%2FxzlpqAj7KA2yk8ywGBOTDP6u2VBKuh0A4g8BnLV2zziD0o9%2FzZCJpD57HRQUaIqpAjKku8tP0tNMsjKF3ZB4F%2BMz%2FMV7kRUj1VbZnFyM7a3ctGGPCfG40kYv8mRlP5JCVWbpEP1ehYIimSBrtc6yGU%2Fvdbe8fu01IZv9fX1jkZz%2F9nKmTeP4coSq8CPOqJsP7u1dO%2BsgNA%3D%3D&return_url=https%3A%2F%2Fgaga.plus&notify_url=http%3A%2F%2Feason.nat300.top%2Fapi%2Fv1%2Falipay%2Falipay_notify_url&version=1.0&app_id=9021000143682740&sign_type=RSA2&timestamp=2025-03-14+20%3A07%3A55&alipay_sdk=alipay-sdk-java-4.38.157.ALL&format=json\">\n<input type=\"hidden\" name=\"biz_content\" value=\"{&quot;out_trade_no&quot;:&quot;049855618183&quot;,&quot;total_amount&quot;:&quot;100.00&quot;,&quot;subject&quot;:&quot;《手写MyBatis：渐进式源码实践》&quot;,&quot;product_code&quot;:&quot;FAST_INSTANT_TRADE_PAY&quot;}\">\n<input type=\"submit\" value=\"立即支付\" style=\"display:none\" >\n</form>\n<script>document.forms[0].submit();</script>","userId":"Eason4"}
25-03-14.20:07:55.605 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-03-14.20:07:56.482 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-03-14.20:07:56.489 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-1 - Shutdown initiated...
25-03-14.20:07:56.496 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-1 - Shutdown completed.
25-03-14.20:08:59.677 [main            ] INFO  OrderServiceTest       - Starting OrderServiceTest using Java 17.0.13 with PID 114880 (started by Eason in D:\Code\codes\s-pay-mall-ddd-eason\s-pay-mall-ddd-eason-app)
25-03-14.20:08:59.679 [main            ] INFO  OrderServiceTest       - The following 1 profile is active: "dev"
25-03-14.20:09:01.405 [main            ] INFO  OptionalValidatorFactoryBean - Failed to set up a Bean Validation provider: jakarta.validation.NoProviderFoundException: Unable to create a Configuration, because no Jakarta Bean Validation provider could be found. Add a provider like Hibernate Validator (RI) to your classpath.
25-03-14.20:09:01.756 [main            ] INFO  CachingConnectionFactory - Attempting to connect to: [192.168.226.128:5672]
25-03-14.20:09:01.818 [main            ] INFO  CachingConnectionFactory - Created new connection: rabbitConnectionFactory#3d40a3b4:0/SimpleConnection@4ccdacf5 [delegate=amqp://s-pay-mall@192.168.226.128:5672//s-pay-mall, localPort=53014]
25-03-14.20:09:01.892 [main            ] INFO  OrderServiceTest       - Started OrderServiceTest in 2.621 seconds (process running for 3.387)
25-03-14.20:09:02.568 [main            ] INFO  HikariDataSource       - HikariPool-1 - Starting...
25-03-14.20:09:02.726 [main            ] INFO  HikariPool             - HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@56d742ad
25-03-14.20:09:02.728 [main            ] INFO  HikariDataSource       - HikariPool-1 - Start completed.
25-03-14.20:09:03.027 [main            ] INFO  PayPort                - 拼团订单锁定, userId: Eason4, request: LockMarketPayOrderRequestDTO(userId=Eason4, teamId=null, activityId=100123, goodsId=9890001, source=s01, channel=c01, outerOrderId=142635297018, notifyUrl=http://127.0.0.1:8081/api/v1/alipay/group_buy_notify), response: Result(msg=success, code=1, data=LockMarketPayOrderResponseDTO(orderId=163646257413, teamId=98541277, originalPrice=null, discountPrice=10.00, payPrice=90.00, tradeOrderStatus=0))
25-03-14.20:09:03.152 [main            ] INFO  OrderService           - 创建支付订单成功, payOrder: PayOrderEntity{userId='null', orderId='142635297018', payUrl='<form name="punchout_form" method="post" action="https://openapi-sandbox.dl.alipaydev.com/gateway.do?charset=utf-8&method=alipay.trade.page.pay&sign=S0tlwrDUvSnaoRdcggG3YPyyFDMF3aOLlXZ8mtWPWMMDVnOdZaGtxCySrEIH%2FdRonBhY1TkzPu3fwFtVEeA4gKBOWjthJLTRwsbca7HiBAjJEah1fPh57NdcT6JezIqGtxxMFOjD36rLJARNxjc5aOMq%2FPdTdljF1elJPgDiQZqcHQC%2FbPeoCmKHPNue%2BWqL7EXbpr7A11Qz6m5KwFblBp03I0UFOz43%2BK6yhJGny%2Bx%2B3pvIH7yMfK2VEJFIKwNFNdAIBc%2FtszlX8%2BiopX9r0%2Fuu6FtbAn1siA7EG3Lrn45V7V%2FKa1H9H14C6JZIHfO5o3Ea6Vaw4zIUGqa4%2FwxdPQ%3D%3D&return_url=https%3A%2F%2Fgaga.plus&notify_url=http%3A%2F%2Feason.nat300.top%2Fapi%2Fv1%2Falipay%2Falipay_notify_url&version=1.0&app_id=9021000143682740&sign_type=RSA2&timestamp=2025-03-14+20%3A09%3A03&alipay_sdk=alipay-sdk-java-4.38.157.ALL&format=json">
<input type="hidden" name="biz_content" value="{&quot;out_trade_no&quot;:&quot;142635297018&quot;,&quot;total_amount&quot;:&quot;100.00&quot;,&quot;subject&quot;:&quot;《手写MyBatis：渐进式源码实践》&quot;,&quot;product_code&quot;:&quot;FAST_INSTANT_TRADE_PAY&quot;}">
<input type="submit" value="立即支付" style="display:none" >
</form>
<script>document.forms[0].submit();</script>', orderStatus=PAY_WAITE}
25-03-14.20:09:03.178 [main            ] INFO  OrderService           - 支付 URL: 
<form name="punchout_form" method="post" action="https://openapi-sandbox.dl.alipaydev.com/gateway.do?charset=utf-8&method=alipay.trade.page.pay&sign=S0tlwrDUvSnaoRdcggG3YPyyFDMF3aOLlXZ8mtWPWMMDVnOdZaGtxCySrEIH%2FdRonBhY1TkzPu3fwFtVEeA4gKBOWjthJLTRwsbca7HiBAjJEah1fPh57NdcT6JezIqGtxxMFOjD36rLJARNxjc5aOMq%2FPdTdljF1elJPgDiQZqcHQC%2FbPeoCmKHPNue%2BWqL7EXbpr7A11Qz6m5KwFblBp03I0UFOz43%2BK6yhJGny%2Bx%2B3pvIH7yMfK2VEJFIKwNFNdAIBc%2FtszlX8%2BiopX9r0%2Fuu6FtbAn1siA7EG3Lrn45V7V%2FKa1H9H14C6JZIHfO5o3Ea6Vaw4zIUGqa4%2FwxdPQ%3D%3D&return_url=https%3A%2F%2Fgaga.plus&notify_url=http%3A%2F%2Feason.nat300.top%2Fapi%2Fv1%2Falipay%2Falipay_notify_url&version=1.0&app_id=9021000143682740&sign_type=RSA2&timestamp=2025-03-14+20%3A09%3A03&alipay_sdk=alipay-sdk-java-4.38.157.ALL&format=json">
<input type="hidden" name="biz_content" value="{&quot;out_trade_no&quot;:&quot;142635297018&quot;,&quot;total_amount&quot;:&quot;100.00&quot;,&quot;subject&quot;:&quot;《手写MyBatis：渐进式源码实践》&quot;,&quot;product_code&quot;:&quot;FAST_INSTANT_TRADE_PAY&quot;}">
<input type="submit" value="立即支付" style="display:none" >
</form>
<script>document.forms[0].submit();</script>
25-03-14.20:09:03.178 [main            ] INFO  AbstractOrderService   - 创建订单-完成，生成支付单。userId: Eason4 orderId: 142635297018 payUrl: <form name="punchout_form" method="post" action="https://openapi-sandbox.dl.alipaydev.com/gateway.do?charset=utf-8&method=alipay.trade.page.pay&sign=S0tlwrDUvSnaoRdcggG3YPyyFDMF3aOLlXZ8mtWPWMMDVnOdZaGtxCySrEIH%2FdRonBhY1TkzPu3fwFtVEeA4gKBOWjthJLTRwsbca7HiBAjJEah1fPh57NdcT6JezIqGtxxMFOjD36rLJARNxjc5aOMq%2FPdTdljF1elJPgDiQZqcHQC%2FbPeoCmKHPNue%2BWqL7EXbpr7A11Qz6m5KwFblBp03I0UFOz43%2BK6yhJGny%2Bx%2B3pvIH7yMfK2VEJFIKwNFNdAIBc%2FtszlX8%2BiopX9r0%2Fuu6FtbAn1siA7EG3Lrn45V7V%2FKa1H9H14C6JZIHfO5o3Ea6Vaw4zIUGqa4%2FwxdPQ%3D%3D&return_url=https%3A%2F%2Fgaga.plus&notify_url=http%3A%2F%2Feason.nat300.top%2Fapi%2Fv1%2Falipay%2Falipay_notify_url&version=1.0&app_id=9021000143682740&sign_type=RSA2&timestamp=2025-03-14+20%3A09%3A03&alipay_sdk=alipay-sdk-java-4.38.157.ALL&format=json">
<input type="hidden" name="biz_content" value="{&quot;out_trade_no&quot;:&quot;142635297018&quot;,&quot;total_amount&quot;:&quot;100.00&quot;,&quot;subject&quot;:&quot;《手写MyBatis：渐进式源码实践》&quot;,&quot;product_code&quot;:&quot;FAST_INSTANT_TRADE_PAY&quot;}">
<input type="submit" value="立即支付" style="display:none" >
</form>
<script>document.forms[0].submit();</script> discount: MarketPayDiscountEntity(originalAmount=null, deductionAmount=10.00, payAmount=90.00)
25-03-14.20:09:03.196 [main            ] INFO  OrderServiceTest       - 请求参数:{"activityId":100123,"marketType":"拼团营销","productId":"9890001","userId":"Eason4"}
25-03-14.20:09:03.200 [main            ] INFO  OrderServiceTest       - 测试结果:{"deductionAmount":10.00,"marketType":"拼团营销","orderId":"142635297018","orderStatus":"等待支付－订单创建完成后，创建支付单","payAmount":90.00,"payUrl":"<form name=\"punchout_form\" method=\"post\" action=\"https://openapi-sandbox.dl.alipaydev.com/gateway.do?charset=utf-8&method=alipay.trade.page.pay&sign=S0tlwrDUvSnaoRdcggG3YPyyFDMF3aOLlXZ8mtWPWMMDVnOdZaGtxCySrEIH%2FdRonBhY1TkzPu3fwFtVEeA4gKBOWjthJLTRwsbca7HiBAjJEah1fPh57NdcT6JezIqGtxxMFOjD36rLJARNxjc5aOMq%2FPdTdljF1elJPgDiQZqcHQC%2FbPeoCmKHPNue%2BWqL7EXbpr7A11Qz6m5KwFblBp03I0UFOz43%2BK6yhJGny%2Bx%2B3pvIH7yMfK2VEJFIKwNFNdAIBc%2FtszlX8%2BiopX9r0%2Fuu6FtbAn1siA7EG3Lrn45V7V%2FKa1H9H14C6JZIHfO5o3Ea6Vaw4zIUGqa4%2FwxdPQ%3D%3D&return_url=https%3A%2F%2Fgaga.plus&notify_url=http%3A%2F%2Feason.nat300.top%2Fapi%2Fv1%2Falipay%2Falipay_notify_url&version=1.0&app_id=9021000143682740&sign_type=RSA2&timestamp=2025-03-14+20%3A09%3A03&alipay_sdk=alipay-sdk-java-4.38.157.ALL&format=json\">\n<input type=\"hidden\" name=\"biz_content\" value=\"{&quot;out_trade_no&quot;:&quot;142635297018&quot;,&quot;total_amount&quot;:&quot;100.00&quot;,&quot;subject&quot;:&quot;《手写MyBatis：渐进式源码实践》&quot;,&quot;product_code&quot;:&quot;FAST_INSTANT_TRADE_PAY&quot;}\">\n<input type=\"submit\" value=\"立即支付\" style=\"display:none\" >\n</form>\n<script>document.forms[0].submit();</script>","userId":"Eason4"}
25-03-14.20:09:03.213 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-03-14.20:09:03.898 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-03-14.20:09:03.902 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-1 - Shutdown initiated...
25-03-14.20:09:03.912 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-1 - Shutdown completed.
25-03-14.20:11:07.184 [main            ] INFO  OrderServiceTest       - Starting OrderServiceTest using Java 17.0.13 with PID 82224 (started by Eason in D:\Code\codes\s-pay-mall-ddd-eason\s-pay-mall-ddd-eason-app)
25-03-14.20:11:07.185 [main            ] INFO  OrderServiceTest       - The following 1 profile is active: "dev"
25-03-14.20:11:08.963 [main            ] INFO  OptionalValidatorFactoryBean - Failed to set up a Bean Validation provider: jakarta.validation.NoProviderFoundException: Unable to create a Configuration, because no Jakarta Bean Validation provider could be found. Add a provider like Hibernate Validator (RI) to your classpath.
25-03-14.20:11:09.347 [main            ] INFO  CachingConnectionFactory - Attempting to connect to: [192.168.226.128:5672]
25-03-14.20:11:09.413 [main            ] INFO  CachingConnectionFactory - Created new connection: rabbitConnectionFactory#2921199d:0/SimpleConnection@1410d645 [delegate=amqp://s-pay-mall@192.168.226.128:5672//s-pay-mall, localPort=54111]
25-03-14.20:11:09.496 [main            ] INFO  OrderServiceTest       - Started OrderServiceTest in 2.691 seconds (process running for 3.488)
25-03-14.20:11:10.242 [main            ] INFO  HikariDataSource       - HikariPool-1 - Starting...
25-03-14.20:11:10.398 [main            ] INFO  HikariPool             - HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@2ec156fb
25-03-14.20:11:10.399 [main            ] INFO  HikariDataSource       - HikariPool-1 - Start completed.
25-03-14.20:11:10.572 [main            ] INFO  PayPort                - 拼团订单锁定, userId: Eason4, request: LockMarketPayOrderRequestDTO(userId=Eason4, teamId=null, activityId=100123, goodsId=9890001, source=s01, channel=c01, outerOrderId=540050756744, notifyUrl=http://127.0.0.1:8081/api/v1/alipay/group_buy_notify), response: Result(msg=success, code=1, data=LockMarketPayOrderResponseDTO(orderId=222884665365, teamId=97091888, originalPrice=null, discountPrice=10.00, payPrice=90.00, tradeOrderStatus=0))
25-03-14.20:11:10.689 [main            ] INFO  OrderService           - 创建支付订单成功, payOrder: PayOrderEntity{userId='null', orderId='540050756744', payUrl='<form name="punchout_form" method="post" action="https://openapi-sandbox.dl.alipaydev.com/gateway.do?charset=utf-8&method=alipay.trade.page.pay&sign=P156aT1mlfQoMpoDGdrTWBgJEIeupJGnCQu9aB1sOxBAZKBe%2FX0WyIwQCq5RazSuneIzusT8IniwaLq16idxTe%2FuvBaxEbG5eieADzwdT9EJWcv7Nla6r0yIWUTNaOg3K04t%2FCgvblbAABWtU7eI98CMHSbC5ZkKW6AtEfQ%2Bhg9kvuOg9HmDosSzLqDHrQ9LVhCmYYcTsNLh5%2B4knFyqOoJMqVD9xXcpnmuydPXIsdVphtn7%2BmZivwaRE2JA13sXJm58KzrRifbQj8a1qZ5e6hnxOOOPH2o3qBhkcF1OKrv%2Fr1XPuGHus2SWbmFmfDocISm%2BQ3OHMwIEvNH%2FuMk4ng%3D%3D&return_url=https%3A%2F%2Fgaga.plus&notify_url=http%3A%2F%2Feason.nat300.top%2Fapi%2Fv1%2Falipay%2Falipay_notify_url&version=1.0&app_id=9021000143682740&sign_type=RSA2&timestamp=2025-03-14+20%3A11%3A10&alipay_sdk=alipay-sdk-java-4.38.157.ALL&format=json">
<input type="hidden" name="biz_content" value="{&quot;out_trade_no&quot;:&quot;540050756744&quot;,&quot;total_amount&quot;:&quot;100.00&quot;,&quot;subject&quot;:&quot;<MyBatis>&quot;,&quot;product_code&quot;:&quot;FAST_INSTANT_TRADE_PAY&quot;}">
<input type="submit" value="立即支付" style="display:none" >
</form>
<script>document.forms[0].submit();</script>', orderStatus=PAY_WAITE}
25-03-14.20:11:10.710 [main            ] INFO  OrderService           - 支付 URL: 
<form name="punchout_form" method="post" action="https://openapi-sandbox.dl.alipaydev.com/gateway.do?charset=utf-8&method=alipay.trade.page.pay&sign=P156aT1mlfQoMpoDGdrTWBgJEIeupJGnCQu9aB1sOxBAZKBe%2FX0WyIwQCq5RazSuneIzusT8IniwaLq16idxTe%2FuvBaxEbG5eieADzwdT9EJWcv7Nla6r0yIWUTNaOg3K04t%2FCgvblbAABWtU7eI98CMHSbC5ZkKW6AtEfQ%2Bhg9kvuOg9HmDosSzLqDHrQ9LVhCmYYcTsNLh5%2B4knFyqOoJMqVD9xXcpnmuydPXIsdVphtn7%2BmZivwaRE2JA13sXJm58KzrRifbQj8a1qZ5e6hnxOOOPH2o3qBhkcF1OKrv%2Fr1XPuGHus2SWbmFmfDocISm%2BQ3OHMwIEvNH%2FuMk4ng%3D%3D&return_url=https%3A%2F%2Fgaga.plus&notify_url=http%3A%2F%2Feason.nat300.top%2Fapi%2Fv1%2Falipay%2Falipay_notify_url&version=1.0&app_id=9021000143682740&sign_type=RSA2&timestamp=2025-03-14+20%3A11%3A10&alipay_sdk=alipay-sdk-java-4.38.157.ALL&format=json">
<input type="hidden" name="biz_content" value="{&quot;out_trade_no&quot;:&quot;540050756744&quot;,&quot;total_amount&quot;:&quot;100.00&quot;,&quot;subject&quot;:&quot;<MyBatis>&quot;,&quot;product_code&quot;:&quot;FAST_INSTANT_TRADE_PAY&quot;}">
<input type="submit" value="立即支付" style="display:none" >
</form>
<script>document.forms[0].submit();</script>
25-03-14.20:11:10.710 [main            ] INFO  AbstractOrderService   - 创建订单-完成，生成支付单。userId: Eason4 orderId: 540050756744 payUrl: <form name="punchout_form" method="post" action="https://openapi-sandbox.dl.alipaydev.com/gateway.do?charset=utf-8&method=alipay.trade.page.pay&sign=P156aT1mlfQoMpoDGdrTWBgJEIeupJGnCQu9aB1sOxBAZKBe%2FX0WyIwQCq5RazSuneIzusT8IniwaLq16idxTe%2FuvBaxEbG5eieADzwdT9EJWcv7Nla6r0yIWUTNaOg3K04t%2FCgvblbAABWtU7eI98CMHSbC5ZkKW6AtEfQ%2Bhg9kvuOg9HmDosSzLqDHrQ9LVhCmYYcTsNLh5%2B4knFyqOoJMqVD9xXcpnmuydPXIsdVphtn7%2BmZivwaRE2JA13sXJm58KzrRifbQj8a1qZ5e6hnxOOOPH2o3qBhkcF1OKrv%2Fr1XPuGHus2SWbmFmfDocISm%2BQ3OHMwIEvNH%2FuMk4ng%3D%3D&return_url=https%3A%2F%2Fgaga.plus&notify_url=http%3A%2F%2Feason.nat300.top%2Fapi%2Fv1%2Falipay%2Falipay_notify_url&version=1.0&app_id=9021000143682740&sign_type=RSA2&timestamp=2025-03-14+20%3A11%3A10&alipay_sdk=alipay-sdk-java-4.38.157.ALL&format=json">
<input type="hidden" name="biz_content" value="{&quot;out_trade_no&quot;:&quot;540050756744&quot;,&quot;total_amount&quot;:&quot;100.00&quot;,&quot;subject&quot;:&quot;<MyBatis>&quot;,&quot;product_code&quot;:&quot;FAST_INSTANT_TRADE_PAY&quot;}">
<input type="submit" value="立即支付" style="display:none" >
</form>
<script>document.forms[0].submit();</script> discount: MarketPayDiscountEntity(originalAmount=null, deductionAmount=10.00, payAmount=90.00)
25-03-14.20:11:10.725 [main            ] INFO  OrderServiceTest       - 请求参数:{"activityId":100123,"marketType":"拼团营销","productId":"9890001","userId":"Eason4"}
25-03-14.20:11:10.728 [main            ] INFO  OrderServiceTest       - 测试结果:{"deductionAmount":10.00,"marketType":"拼团营销","orderId":"540050756744","orderStatus":"等待支付－订单创建完成后，创建支付单","payAmount":90.00,"payUrl":"<form name=\"punchout_form\" method=\"post\" action=\"https://openapi-sandbox.dl.alipaydev.com/gateway.do?charset=utf-8&method=alipay.trade.page.pay&sign=P156aT1mlfQoMpoDGdrTWBgJEIeupJGnCQu9aB1sOxBAZKBe%2FX0WyIwQCq5RazSuneIzusT8IniwaLq16idxTe%2FuvBaxEbG5eieADzwdT9EJWcv7Nla6r0yIWUTNaOg3K04t%2FCgvblbAABWtU7eI98CMHSbC5ZkKW6AtEfQ%2Bhg9kvuOg9HmDosSzLqDHrQ9LVhCmYYcTsNLh5%2B4knFyqOoJMqVD9xXcpnmuydPXIsdVphtn7%2BmZivwaRE2JA13sXJm58KzrRifbQj8a1qZ5e6hnxOOOPH2o3qBhkcF1OKrv%2Fr1XPuGHus2SWbmFmfDocISm%2BQ3OHMwIEvNH%2FuMk4ng%3D%3D&return_url=https%3A%2F%2Fgaga.plus&notify_url=http%3A%2F%2Feason.nat300.top%2Fapi%2Fv1%2Falipay%2Falipay_notify_url&version=1.0&app_id=9021000143682740&sign_type=RSA2&timestamp=2025-03-14+20%3A11%3A10&alipay_sdk=alipay-sdk-java-4.38.157.ALL&format=json\">\n<input type=\"hidden\" name=\"biz_content\" value=\"{&quot;out_trade_no&quot;:&quot;540050756744&quot;,&quot;total_amount&quot;:&quot;100.00&quot;,&quot;subject&quot;:&quot;<MyBatis>&quot;,&quot;product_code&quot;:&quot;FAST_INSTANT_TRADE_PAY&quot;}\">\n<input type=\"submit\" value=\"立即支付\" style=\"display:none\" >\n</form>\n<script>document.forms[0].submit();</script>","userId":"Eason4"}
25-03-14.20:11:10.743 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-03-14.20:11:11.504 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-03-14.20:11:11.510 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-1 - Shutdown initiated...
25-03-14.20:11:11.521 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-1 - Shutdown completed.
